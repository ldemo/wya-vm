(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"../build/vm.min.js":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var i,r=(i=n("../node_modules/vue/dist/vue.esm.js"))&&"object"==typeof i&&"default"in i?i.default:i;var a=function(){this.__data__=[],this.size=0};var o=function(t,e){return t===e||t!=t&&e!=e};var s=function(t,e){for(var n=t.length;n--;)if(o(t[n][0],e))return n;return-1},d=Array.prototype.splice;var l=function(t){var e=this.__data__,n=s(e,t);return!(n<0||(n==e.length-1?e.pop():d.call(e,n,1),--this.size,0))};var h=function(t){var e=this.__data__,n=s(e,t);return n<0?void 0:e[n][1]};var c=function(t){return s(this.__data__,t)>-1};var u=function(t,e){var n=this.__data__,i=s(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};function A(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}A.prototype.clear=a,A.prototype.delete=l,A.prototype.get=h,A.prototype.has=c,A.prototype.set=u;var p=A;var f=function(){this.__data__=new p,this.size=0};var v=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var m=function(t){return this.__data__.get(t)};var g=function(t){return this.__data__.has(t)},b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function _(t,e){return t(e={exports:{}},e.exports),e.exports}var y="object"==typeof b&&b&&b.Object===Object&&b,x="object"==typeof self&&self&&self.Object===Object&&self,w=y||x||Function("return this")(),C=w.Symbol,E=Object.prototype,D=E.hasOwnProperty,k=E.toString,$=C?C.toStringTag:void 0;var O=function(t){var e=D.call(t,$),n=t[$];try{t[$]=void 0;var i=!0}catch(t){}var r=k.call(t);return i&&(e?t[$]=n:delete t[$]),r},z=Object.prototype.toString;var S=function(t){return z.call(t)},j="[object Null]",B="[object Undefined]",M=C?C.toStringTag:void 0;var Y=function(t){return null==t?void 0===t?B:j:M&&M in Object(t)?O(t):S(t)};var N=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},X="[object AsyncFunction]",R="[object Function]",U="[object GeneratorFunction]",T="[object Proxy]";var W,I=function(t){if(!N(t))return!1;var e=Y(t);return e==R||e==U||e==X||e==T},P=w["__core-js_shared__"],F=(W=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+W:"";var L=function(t){return!!F&&F in t},H=Function.prototype.toString;var q=function(t){if(null!=t){try{return H.call(t)}catch(t){}try{return t+""}catch(t){}}return""},V=/^\[object .+?Constructor\]$/,G=Function.prototype,K=Object.prototype,J=G.toString,Q=K.hasOwnProperty,Z=RegExp("^"+J.call(Q).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var tt=function(t){return!(!N(t)||L(t))&&(I(t)?Z:V).test(q(t))};var et=function(t,e){return null==t?void 0:t[e]};var nt=function(t,e){var n=et(t,e);return tt(n)?n:void 0},it=nt(w,"Map"),rt=nt(Object,"create");var at=function(){this.__data__=rt?rt(null):{},this.size=0};var ot=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},st="__lodash_hash_undefined__",dt=Object.prototype.hasOwnProperty;var lt=function(t){var e=this.__data__;if(rt){var n=e[t];return n===st?void 0:n}return dt.call(e,t)?e[t]:void 0},ht=Object.prototype.hasOwnProperty;var ct=function(t){var e=this.__data__;return rt?void 0!==e[t]:ht.call(e,t)},ut="__lodash_hash_undefined__";var At=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=rt&&void 0===e?ut:e,this};function pt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}pt.prototype.clear=at,pt.prototype.delete=ot,pt.prototype.get=lt,pt.prototype.has=ct,pt.prototype.set=At;var ft=pt;var vt=function(){this.size=0,this.__data__={hash:new ft,map:new(it||p),string:new ft}};var mt=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var gt=function(t,e){var n=t.__data__;return mt(e)?n["string"==typeof e?"string":"hash"]:n.map};var bt=function(t){var e=gt(this,t).delete(t);return this.size-=e?1:0,e};var _t=function(t){return gt(this,t).get(t)};var yt=function(t){return gt(this,t).has(t)};var xt=function(t,e){var n=gt(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this};function wt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}wt.prototype.clear=vt,wt.prototype.delete=bt,wt.prototype.get=_t,wt.prototype.has=yt,wt.prototype.set=xt;var Ct=wt,Et=200;var Dt=function(t,e){var n=this.__data__;if(n instanceof p){var i=n.__data__;if(!it||i.length<Et-1)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ct(i)}return n.set(t,e),this.size=n.size,this};function kt(t){var e=this.__data__=new p(t);this.size=e.size}kt.prototype.clear=f,kt.prototype.delete=v,kt.prototype.get=m,kt.prototype.has=g,kt.prototype.set=Dt;var $t=kt;var Ot=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i&&!1!==e(t[n],n,t););return t},zt=function(){try{var t=nt(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var St=function(t,e,n){"__proto__"==e&&zt?zt(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},jt=Object.prototype.hasOwnProperty;var Bt=function(t,e,n){var i=t[e];jt.call(t,e)&&o(i,n)&&(void 0!==n||e in t)||St(t,e,n)};var Mt=function(t,e,n,i){var r=!n;n||(n={});for(var a=-1,o=e.length;++a<o;){var s=e[a],d=i?i(n[s],t[s],s,n,t):void 0;void 0===d&&(d=t[s]),r?St(n,s,d):Bt(n,s,d)}return n};var Yt=function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i};var Nt=function(t){return null!=t&&"object"==typeof t},Xt="[object Arguments]";var Rt=function(t){return Nt(t)&&Y(t)==Xt},Ut=Object.prototype,Tt=Ut.hasOwnProperty,Wt=Ut.propertyIsEnumerable,It=Rt(function(){return arguments}())?Rt:function(t){return Nt(t)&&Tt.call(t,"callee")&&!Wt.call(t,"callee")},Pt=Array.isArray;var Ft=function(){return!1},Lt=_(function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,r=i&&i.exports===n?w.Buffer:void 0,a=(r?r.isBuffer:void 0)||Ft;t.exports=a}),Ht=9007199254740991,qt=/^(?:0|[1-9]\d*)$/;var Vt=function(t,e){var n=typeof t;return!!(e=null==e?Ht:e)&&("number"==n||"symbol"!=n&&qt.test(t))&&t>-1&&t%1==0&&t<e},Gt=9007199254740991;var Kt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=Gt},Jt={};Jt["[object Float32Array]"]=Jt["[object Float64Array]"]=Jt["[object Int8Array]"]=Jt["[object Int16Array]"]=Jt["[object Int32Array]"]=Jt["[object Uint8Array]"]=Jt["[object Uint8ClampedArray]"]=Jt["[object Uint16Array]"]=Jt["[object Uint32Array]"]=!0,Jt["[object Arguments]"]=Jt["[object Array]"]=Jt["[object ArrayBuffer]"]=Jt["[object Boolean]"]=Jt["[object DataView]"]=Jt["[object Date]"]=Jt["[object Error]"]=Jt["[object Function]"]=Jt["[object Map]"]=Jt["[object Number]"]=Jt["[object Object]"]=Jt["[object RegExp]"]=Jt["[object Set]"]=Jt["[object String]"]=Jt["[object WeakMap]"]=!1;var Qt=function(t){return Nt(t)&&Kt(t.length)&&!!Jt[Y(t)]};var Zt=function(t){return function(e){return t(e)}},te=_(function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,r=i&&i.exports===n&&y.process,a=function(){try{var t=i&&i.require&&i.require("util").types;return t||r&&r.binding&&r.binding("util")}catch(t){}}();t.exports=a}),ee=te&&te.isTypedArray,ne=ee?Zt(ee):Qt,ie=Object.prototype.hasOwnProperty;var re=function(t,e){var n=Pt(t),i=!n&&It(t),r=!n&&!i&&Lt(t),a=!n&&!i&&!r&&ne(t),o=n||i||r||a,s=o?Yt(t.length,String):[],d=s.length;for(var l in t)!e&&!ie.call(t,l)||o&&("length"==l||r&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Vt(l,d))||s.push(l);return s},ae=Object.prototype;var oe=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ae)};var se=function(t,e){return function(n){return t(e(n))}},de=se(Object.keys,Object),le=Object.prototype.hasOwnProperty;var he=function(t){if(!oe(t))return de(t);var e=[];for(var n in Object(t))le.call(t,n)&&"constructor"!=n&&e.push(n);return e};var ce=function(t){return null!=t&&Kt(t.length)&&!I(t)};var ue=function(t){return ce(t)?re(t):he(t)};var Ae=function(t,e){return t&&Mt(e,ue(e),t)};var pe=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},fe=Object.prototype.hasOwnProperty;var ve=function(t){if(!N(t))return pe(t);var e=oe(t),n=[];for(var i in t)("constructor"!=i||!e&&fe.call(t,i))&&n.push(i);return n};var me=function(t){return ce(t)?re(t,!0):ve(t)};var ge=function(t,e){return t&&Mt(e,me(e),t)},be=_(function(t,e){var n=e&&!e.nodeType&&e,i=n&&t&&!t.nodeType&&t,r=i&&i.exports===n?w.Buffer:void 0,a=r?r.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,i=a?a(n):new t.constructor(n);return t.copy(i),i}});var _e=function(t,e){var n=-1,i=t.length;for(e||(e=Array(i));++n<i;)e[n]=t[n];return e};var ye=function(t,e){for(var n=-1,i=null==t?0:t.length,r=0,a=[];++n<i;){var o=t[n];e(o,n,t)&&(a[r++]=o)}return a};var xe=function(){return[]},we=Object.prototype.propertyIsEnumerable,Ce=Object.getOwnPropertySymbols,Ee=Ce?function(t){return null==t?[]:(t=Object(t),ye(Ce(t),function(e){return we.call(t,e)}))}:xe;var De=function(t,e){return Mt(t,Ee(t),e)};var ke=function(t,e){for(var n=-1,i=e.length,r=t.length;++n<i;)t[r+n]=e[n];return t},$e=se(Object.getPrototypeOf,Object),Oe=Object.getOwnPropertySymbols?function(t){for(var e=[];t;)ke(e,Ee(t)),t=$e(t);return e}:xe;var ze=function(t,e){return Mt(t,Oe(t),e)};var Se=function(t,e,n){var i=e(t);return Pt(t)?i:ke(i,n(t))};var je=function(t){return Se(t,ue,Ee)};var Be=function(t){return Se(t,me,Oe)},Me=nt(w,"DataView"),Ye=nt(w,"Promise"),Ne=nt(w,"Set"),Xe=nt(w,"WeakMap"),Re=q(Me),Ue=q(it),Te=q(Ye),We=q(Ne),Ie=q(Xe),Pe=Y;(Me&&"[object DataView]"!=Pe(new Me(new ArrayBuffer(1)))||it&&"[object Map]"!=Pe(new it)||Ye&&"[object Promise]"!=Pe(Ye.resolve())||Ne&&"[object Set]"!=Pe(new Ne)||Xe&&"[object WeakMap]"!=Pe(new Xe))&&(Pe=function(t){var e=Y(t),n="[object Object]"==e?t.constructor:void 0,i=n?q(n):"";if(i)switch(i){case Re:return"[object DataView]";case Ue:return"[object Map]";case Te:return"[object Promise]";case We:return"[object Set]";case Ie:return"[object WeakMap]"}return e});var Fe=Pe,Le=Object.prototype.hasOwnProperty;var He=function(t){var e=t.length,n=new t.constructor(e);return e&&"string"==typeof t[0]&&Le.call(t,"index")&&(n.index=t.index,n.input=t.input),n},qe=w.Uint8Array;var Ve=function(t){var e=new t.constructor(t.byteLength);return new qe(e).set(new qe(t)),e};var Ge=function(t,e){var n=e?Ve(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.byteLength)},Ke=/\w*$/;var Je=function(t){var e=new t.constructor(t.source,Ke.exec(t));return e.lastIndex=t.lastIndex,e},Qe=C?C.prototype:void 0,Ze=Qe?Qe.valueOf:void 0;var tn=function(t){return Ze?Object(Ze.call(t)):{}};var en=function(t,e){var n=e?Ve(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)},nn="[object Boolean]",rn="[object Date]",an="[object Map]",on="[object Number]",sn="[object RegExp]",dn="[object Set]",ln="[object String]",hn="[object Symbol]",cn="[object ArrayBuffer]",un="[object DataView]",An="[object Float32Array]",pn="[object Float64Array]",fn="[object Int8Array]",vn="[object Int16Array]",mn="[object Int32Array]",gn="[object Uint8Array]",bn="[object Uint8ClampedArray]",_n="[object Uint16Array]",yn="[object Uint32Array]";var xn=function(t,e,n){var i=t.constructor;switch(e){case cn:return Ve(t);case nn:case rn:return new i(+t);case un:return Ge(t,n);case An:case pn:case fn:case vn:case mn:case gn:case bn:case _n:case yn:return en(t,n);case an:return new i;case on:case ln:return new i(t);case sn:return Je(t);case dn:return new i;case hn:return tn(t)}},wn=Object.create,Cn=function(){function t(){}return function(e){if(!N(e))return{};if(wn)return wn(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var En=function(t){return"function"!=typeof t.constructor||oe(t)?{}:Cn($e(t))},Dn="[object Map]";var kn=function(t){return Nt(t)&&Fe(t)==Dn},$n=te&&te.isMap,On=$n?Zt($n):kn,zn="[object Set]";var Sn=function(t){return Nt(t)&&Fe(t)==zn},jn=te&&te.isSet,Bn=jn?Zt(jn):Sn,Mn=1,Yn=2,Nn=4,Xn="[object Arguments]",Rn="[object Function]",Un="[object GeneratorFunction]",Tn="[object Object]",Wn={};Wn[Xn]=Wn["[object Array]"]=Wn["[object ArrayBuffer]"]=Wn["[object DataView]"]=Wn["[object Boolean]"]=Wn["[object Date]"]=Wn["[object Float32Array]"]=Wn["[object Float64Array]"]=Wn["[object Int8Array]"]=Wn["[object Int16Array]"]=Wn["[object Int32Array]"]=Wn["[object Map]"]=Wn["[object Number]"]=Wn[Tn]=Wn["[object RegExp]"]=Wn["[object Set]"]=Wn["[object String]"]=Wn["[object Symbol]"]=Wn["[object Uint8Array]"]=Wn["[object Uint8ClampedArray]"]=Wn["[object Uint16Array]"]=Wn["[object Uint32Array]"]=!0,Wn["[object Error]"]=Wn[Rn]=Wn["[object WeakMap]"]=!1;var In=function t(e,n,i,r,a,o){var s,d=n&Mn,l=n&Yn,h=n&Nn;if(i&&(s=a?i(e,r,a,o):i(e)),void 0!==s)return s;if(!N(e))return e;var c=Pt(e);if(c){if(s=He(e),!d)return _e(e,s)}else{var u=Fe(e),A=u==Rn||u==Un;if(Lt(e))return be(e,d);if(u==Tn||u==Xn||A&&!a){if(s=l||A?{}:En(e),!d)return l?ze(e,ge(s,e)):De(e,Ae(s,e))}else{if(!Wn[u])return a?e:{};s=xn(e,u,d)}}o||(o=new $t);var p=o.get(e);if(p)return p;if(o.set(e,s),Bn(e))return e.forEach(function(r){s.add(t(r,n,i,r,e,o))}),s;if(On(e))return e.forEach(function(r,a){s.set(a,t(r,n,i,a,e,o))}),s;var f=h?l?Be:je:l?keysIn:ue,v=c?void 0:f(e);return Ot(v||e,function(r,a){v&&(r=e[a=r]),Bt(s,a,t(r,n,i,a,e,o))}),s},Pn=1,Fn=4;var Ln=function(t){return In(t,Pn|Fn)},Hn="__lodash_hash_undefined__";var qn=function(t){return this.__data__.set(t,Hn),this};var Vn=function(t){return this.__data__.has(t)};function Gn(t){var e=-1,n=null==t?0:t.length;for(this.__data__=new Ct;++e<n;)this.add(t[e])}Gn.prototype.add=Gn.prototype.push=qn,Gn.prototype.has=Vn;var Kn=Gn;var Jn=function(t,e){for(var n=-1,i=null==t?0:t.length;++n<i;)if(e(t[n],n,t))return!0;return!1};var Qn=function(t,e){return t.has(e)},Zn=1,ti=2;var ei=function(t,e,n,i,r,a){var o=n&Zn,s=t.length,d=e.length;if(s!=d&&!(o&&d>s))return!1;var l=a.get(t);if(l&&a.get(e))return l==e;var h=-1,c=!0,u=n&ti?new Kn:void 0;for(a.set(t,e),a.set(e,t);++h<s;){var A=t[h],p=e[h];if(i)var f=o?i(p,A,h,e,t,a):i(A,p,h,t,e,a);if(void 0!==f){if(f)continue;c=!1;break}if(u){if(!Jn(e,function(t,e){if(!Qn(u,e)&&(A===t||r(A,t,n,i,a)))return u.push(e)})){c=!1;break}}else if(A!==p&&!r(A,p,n,i,a)){c=!1;break}}return a.delete(t),a.delete(e),c};var ni=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t,i){n[++e]=[i,t]}),n};var ii=function(t){var e=-1,n=Array(t.size);return t.forEach(function(t){n[++e]=t}),n},ri=1,ai=2,oi="[object Boolean]",si="[object Date]",di="[object Error]",li="[object Map]",hi="[object Number]",ci="[object RegExp]",ui="[object Set]",Ai="[object String]",pi="[object Symbol]",fi="[object ArrayBuffer]",vi="[object DataView]",mi=C?C.prototype:void 0,gi=mi?mi.valueOf:void 0;var bi=function(t,e,n,i,r,a,s){switch(n){case vi:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case fi:return!(t.byteLength!=e.byteLength||!a(new qe(t),new qe(e)));case oi:case si:case hi:return o(+t,+e);case di:return t.name==e.name&&t.message==e.message;case ci:case Ai:return t==e+"";case li:var d=ni;case ui:var l=i&ri;if(d||(d=ii),t.size!=e.size&&!l)return!1;var h=s.get(t);if(h)return h==e;i|=ai,s.set(t,e);var c=ei(d(t),d(e),i,r,a,s);return s.delete(t),c;case pi:if(gi)return gi.call(t)==gi.call(e)}return!1},_i=1,yi=Object.prototype.hasOwnProperty;var xi=function(t,e,n,i,r,a){var o=n&_i,s=je(t),d=s.length;if(d!=je(e).length&&!o)return!1;for(var l=d;l--;){var h=s[l];if(!(o?h in e:yi.call(e,h)))return!1}var c=a.get(t);if(c&&a.get(e))return c==e;var u=!0;a.set(t,e),a.set(e,t);for(var A=o;++l<d;){var p=t[h=s[l]],f=e[h];if(i)var v=o?i(f,p,h,e,t,a):i(p,f,h,t,e,a);if(!(void 0===v?p===f||r(p,f,n,i,a):v)){u=!1;break}A||(A="constructor"==h)}if(u&&!A){var m=t.constructor,g=e.constructor;m!=g&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof g&&g instanceof g)&&(u=!1)}return a.delete(t),a.delete(e),u},wi=1,Ci="[object Arguments]",Ei="[object Array]",Di="[object Object]",ki=Object.prototype.hasOwnProperty;var $i=function(t,e,n,i,r,a){var o=Pt(t),s=Pt(e),d=o?Ei:Fe(t),l=s?Ei:Fe(e),h=(d=d==Ci?Di:d)==Di,c=(l=l==Ci?Di:l)==Di,u=d==l;if(u&&Lt(t)){if(!Lt(e))return!1;o=!0,h=!1}if(u&&!h)return a||(a=new $t),o||ne(t)?ei(t,e,n,i,r,a):bi(t,e,d,n,i,r,a);if(!(n&wi)){var A=h&&ki.call(t,"__wrapped__"),p=c&&ki.call(e,"__wrapped__");if(A||p){var f=A?t.value():t,v=p?e.value():e;return a||(a=new $t),r(f,v,n,i,a)}}return!!u&&(a||(a=new $t),xi(t,e,n,i,r,a))};var Oi=function t(e,n,i,r,a){return e===n||(null==e||null==n||!Nt(e)&&!Nt(n)?e!=e&&n!=n:$i(e,n,i,r,t,a))};var zi=function(t,e,n){var i=(n="function"==typeof n?n:void 0)?n(t,e):void 0;return void 0===i?Oi(t,e,void 0,n):!!i},Si=function(){var t=!1;try{var e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,e)}catch(t){console.log(t)}return t}(),ji=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Bi=+new Date,Mi=0,Yi=function(){return"vm-".concat(Bi,"-").concat(++Mi)},Ni=function(t,e){for(var n in e)if(e[n].test(t[n]))return!0;return!1},Xi=document.documentElement,Ri=[0,45,90,135,180,225,270,315,360],Ui={replace:!0,name:"vm-draggable",props:{disabled:{type:Boolean,default:!1},handles:{type:Array,default:function(){return["top","right","bottom","left","top-left","top-right","bottom-right","bottom-left","rotate"]}},w:{type:Number,default:0,validator:function(t){return t>=0}},h:{type:Number,default:0,validator:function(t){return t>=0}},r:{type:Number,default:0},minw:{type:Number,default:36,validator:function(t){return t>0}},minh:{type:Number,default:36,validator:function(t){return t>0}},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:Number,default:1},zoom:{type:Number,default:1},grid:{type:Array,default:function(){return[1,1]}},restrain:{type:Number,default:0},parent:{type:Boolean,default:!1},editorRegExp:{type:Object,default:function(){return{className:/vm-hack-editor/}}},prevent:{type:Boolean,default:!0},preventRegExp:{type:Object,default:function(){return{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|OPTION)$/,className:/vm-hack-pevent/}}},clearable:{type:Boolean,default:!1}},data:function(){return{resizable:!1,draggable:!1,rotatable:!1,changing:!1,active:!1}},computed:{coord:function(){return{left:this.x+"px",top:this.y+"px",zIndex:this.z}},style:function(){return{width:0===this.w?"auto":"".concat(this.w,"px"),height:0===this.h?"auto":"".concat(this.h,"px"),transform:"rotate(".concat(this.r,"deg)")}},width:function(){var t=Math.floor(1.15*Math.sqrt(this.w*this.w+this.h*this.h));return"".concat(t,"px")}},watch:{},beforeCreate:function(){this.parentX=0,this.parentY=0,this.parentW=9999,this.parentH=9999,this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.mouseOffX=0,this.mouseOffY=0,this.handle=null,this.eventOpts=!Si||{capture:!0,passive:!0},this.beforeStatus=null},mounted:function(){this.w&&this.minw>this.w&&this.sync({w:this.minw}),this.h&&this.minh>this.h&&this.sync({h:this.minh});var t=this.$el.parentNode.getBoundingClientRect(),e=t.x,n=t.y;this.parentX=e,this.parentY=n,this.parent&&this.calculation(),this.$emit("resizing")},destroyed:function(){this.operateDOMEvents("remove")},methods:{calculation:function(){var t=this.$el.parentNode.getBoundingClientRect(),e=t.width,n=t.height;this.parentW=e,this.parentH=n,this.w>this.parentW&&this.sync({w:this.parentW}),this.h>this.parentH&&this.sync({h:this.parentH}),this.x+this.w>this.parentW&&this.sync({x:this.parentW-this.w}),this.y+this.h>this.parentH&&this.sync({y:this.parentH-this.h})},sync:function(t){for(var e in t)this[e]!=t[e]&&(!this.beforeStatus&&(this.beforeStatus={x:this.x,y:this.y,z:this.z,w:this.w,r:this.r}),this.$emit("update:".concat(e),t[e]))},operateDOMEvents:function(t){var e="add"===t?Xi.addEventListener:Xi.removeEventListener;e("mousedown",this.handleDeselect,this.eventOpts),e("mousemove",this.handleMove,this.eventOpts),e("mouseup",this.handleUp,this.eventOpts)},setActived:function(){this.handleContainerDown(),this.handleUp()},handleContainerDown:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.prevent&&t.preventDefault&&!Ni(t.target,this.preventRegExp)&&t.preventDefault(),!this.disabled){var e=t.target||t.srcElement;e&&!this.$el.contains(e)||(this.active||(this.lastMouseX=t.pageX||t.clientX+Xi.scrollLeft,this.lastMouseY=t.pageY||t.clientY+Xi.scrollTop,this.operateDOMEvents("add"),this.active=!0,this.$emit("activated")),this.draggable=!0)}},handleDeselect:function(t){var e=this;this.mouseX=t.pageX||t.clientX+Xi.scrollLeft,this.mouseY=t.pageY||t.clientY+Xi.scrollTop,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var n=t.target||t.srcElement,i=t.path||t.composedPath&&t.composedPath()||[];this.$el.contains(n)||Ni(n,{className:/is-([(top|right|-|bottom|left)]{2})/})||i.some(function(t){return Ni(t,e.editorRegExp)})||this.active&&(this.operateDOMEvents("remove"),this.active=!1,this.$emit("deactivated"))},handleDown:function(t,e){this.prevent&&t.preventDefault&&!Ni(t.target,this.preventRegExp)&&t.preventDefault(),this.handle=e,"rotate"===e?this.rotatable=!0:this.resizable=!0,this.preMouseX=t.pageX||t.clientX+Xi.scrollLeft,this.preMouseY=t.pageY||t.clientY+Xi.scrollTop},handleMove:function(t){this.mouseX=t.pageX||t.clientX+Xi.scrollLeft,this.mouseY=t.pageY||t.clientY+Xi.scrollTop;var e=parseInt(this.x,10),n=parseInt(this.y,10),i=parseInt(this.w,10),r=parseInt(this.h,10),a=(this.mouseX-this.lastMouseX+this.mouseOffX)/this.zoom,o=(this.mouseY-this.lastMouseY+this.mouseOffY)/this.zoom;if(this.mouseOffX=0,this.mouseOffY=0,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.resizable)this.handle.includes("top")&&(r-o<this.minh?this.mouseOffY=o-(o=r-this.minh):this.parent&&n+o<0&&(this.mouseOffY=o-(o=-n)),n+=o,r-=o),this.handle.includes("bottom")&&(r+o<this.minh?this.mouseOffY=o-(o=this.minh-r):n+r+o>this.parentH&&(this.mouseOffY=o-(o=this.parentH-n-r)),r+=o),this.handle.includes("left")&&(i-a<this.minw?this.mouseOffX=a-(a=i-this.minw):this.parent&&e+a<0&&(this.mouseOffX=a-(a=-e)),e+=a,i-=a),this.handle.includes("right")&&(i+a<this.minw?this.mouseOffX=a-(a=this.minw-i):e+i+a>this.parentW&&(this.mouseOffX=a-(a=this.parentW-e-i)),i+=a),!this.disabled&&this.sync({x:Math.round(e/this.grid[0])*this.grid[0],y:Math.round(n/this.grid[1])*this.grid[1],w:Math.round(i/this.grid[0])*this.grid[0],h:Math.round(r/this.grid[1])*this.grid[1]}),this.$emit("resizing");else if(this.rotatable){var s=this.getAngle([this.parentX+this.x+this.w/2,-(this.parentY+this.y+this.h/2)],[this.lastMouseX,-this.lastMouseY]),d=Ri.find(function(t){return Math.abs(t-s)<3});s="number"==typeof d?d:s,!this.disabled&&this.sync({r:360===s?0:s}),this.$emit("rotating")}else this.draggable&&(this.parent&&(e+a<0?this.mouseOffX=a*this.zoom-(a=-e):e+i+a>this.parentW&&(this.mouseOffX=a*this.zoom-(a=this.parentW-e-i)),n+o<0?this.mouseOffY=o*this.zoom-(o=-n):n+r+o>this.parentH&&(this.mouseOffY=o*this.zoom-(o=this.parentH-n-r))),e+=a,n+=o,!this.disabled&&this.sync({x:Math.round(e/this.grid[0])*this.grid[0],y:Math.round(n/this.grid[1])*this.grid[1]}),this.$emit("dragging"));!this.changing&&(this.rotatable||this.draggable||this.resizable)&&(this.changing=!0)},getAngle:function(t,e){var n=e[0]-t[0],i=e[1]-t[1],r=360*Math.atan2(i,n)/(2*Math.PI);return r=r>90?450-r:90-r,Math.floor(r)},getRestrain:function(t){var e=this.restrain;return(t/e).toFixed(0)*e},handleUp:function(t){this.changing=!1,this.handle=null;var e=this.restrain;e&&e>0&&this.sync({x:this.getRestrain(this.x),y:this.getRestrain(this.y),w:this.getRestrain(this.w),h:this.getRestrain(this.h)}),this.rotatable&&(this.rotatable=!1,this.$emit("rotate-end")),this.resizable&&(this.resizable=!1,this.$emit("resize-end")),this.draggable&&(this.draggable=!1,this.$emit("drag-end")),this.beforeStatus&&(this.$emit("end",this.beforeStatus),this.beforeStatus=null)}}};var Ti=function(t,e,n,i,r,a,o,s,d,l){"boolean"!=typeof o&&(d=s,s=o,o=!1);var h,c="function"==typeof n?n.options:n;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),i&&(c._scopeId=i),a?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,d(t)),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=h):e&&(h=o?function(){e.call(this,l(this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),h)if(c.functional){var u=c.render;c.render=function(t,e){return h.call(e),u(t,e)}}else{var A=c.beforeCreate;c.beforeCreate=A?[].concat(A,h):[h]}return n},Wi="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var Ii=document.head||document.getElementsByTagName("head")[0],Pi={};var Fi=function(t){return function(t,e){return function(t,e){var n=Wi?e.media||"default":t,i=Pi[n]||(Pi[n]={ids:new Set,styles:[]});if(!i.ids.has(t)){i.ids.add(t);var r=e.source;if(e.map&&(r+="\n/*# sourceURL="+e.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",e.media&&i.element.setAttribute("media",e.media),Ii.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(r),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{var a=i.ids.size-1,o=document.createTextNode(r),s=i.element.childNodes;s[a]&&i.element.removeChild(s[a]),s.length?i.element.insertBefore(o,s[a]):i.element.appendChild(o)}}}(t,e)}},Li=Ui,Hi=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-draggable",style:t.coord,on:{mousedown:function(e){return e.stopPropagation(),t.handleContainerDown(e)}}},[n("div",{class:{"is-events-none":t.changing},style:t.style},[t._t("default")],2),t._v(" "),t.active&&t.handles&&0!==t.handles.length?n("div",{class:{"is-disabled":t.disabled,"is-active":t.active},style:t.style},[t._l(t.handles,function(e){return[t.disabled?t._e():n("div",{key:e,staticClass:"vm-draggable__handle",class:"is-"+e,on:{mousedown:function(n){return!n.type.indexOf("key")&&t._k(n.keyCode,"left",37,n.key,["Left","ArrowLeft"])?null:"button"in n&&0!==n.button?null:(n.stopPropagation(),t.handleDown(n,e))}}})]}),t._v(" "),t.rotatable?n("div",{staticClass:"vm-draggable__rotate",style:{width:t.width}}):t._e()],2):t._e(),t._v(" "),t.rotatable?[n("div",{staticClass:"is-deg-0",style:{width:t.width}}),t._v(" "),n("div",{staticClass:"is-deg-45",style:{width:t.width}}),t._v(" "),n("div",{staticClass:"is-deg-90",style:{width:t.width}}),t._v(" "),n("div",{staticClass:"is-deg-135",style:{width:t.width}}),t._v(" "),n("div",{staticClass:"is-deg-tip"},[t._v(t._s(t.r)+" °")])]:t._e(),t._v(" "),t.clearable&&t.active?n("p",{staticClass:"vm-draggable__delete",on:{click:function(e){return t.$emit("delete")}}},[t._v("✕")]):t._e()],2)};Hi._withStripped=!0;var qi=Ti({render:Hi,staticRenderFns:[]},function(t){t&&t("data-v-19f14218_0",{source:'@charset "UTF-8";\n.vm-draggable {\n  padding: 0;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.vm-draggable:hover {\n  cursor: move;\n}\n.vm-draggable .is-events-none {\n  pointer-events: none;\n}\n.vm-draggable .is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #108ee9;\n}\n.vm-draggable .is-active .vm-draggable__handle {\n  display: block;\n}\n.vm-draggable .is-disabled {\n  border: 1px dotted #e96101;\n}\n.vm-draggable .is-disabled .handle-rotate:after {\n  background: #e96101;\n}\n.vm-draggable .is-disabled .handle-rotate:before {\n  color: #e96101;\n}\n.vm-draggable .is-delete {\n  background: #108ee9;\n  position: absolute;\n  right: 0;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n}\n.vm-draggable__handle {\n  display: none;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  z-index: 999;\n}\n.vm-draggable__handle.is-left {\n  top: 0;\n  left: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-left:hover {\n  background: -webkit-gradient(linear, left top, right top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-right {\n  top: 0;\n  right: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-right:hover {\n  background: -webkit-gradient(linear, right top, left top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  top: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-top:hover {\n  background: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-bottom {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  bottom: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-bottom:hover {\n  background: -webkit-gradient(linear, left bottom, left top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top-left {\n  top: 0;\n  left: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle .is-bottom-left {\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-top-right {\n  top: 0;\n  right: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-bottom-right {\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-rotate {\n  top: 0;\n  left: 50%;\n  -webkit-transform: translate(-50%, -100%);\n          transform: translate(-50%, -100%);\n  cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" style="font-size: 20px;"><text y="15">↻</text></svg>\') 10 10, default;\n  display: -webkit-box !important;\n  display: -ms-flexbox !important;\n  display: flex !important;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.vm-draggable__handle.is-rotate:after {\n  content: " ";\n  height: 10px;\n  width: 1px;\n  background: #108ee9;\n}\n.vm-draggable__handle.is-rotate:before {\n  content: "☐";\n  -webkit-transform: translateY(26%);\n          transform: translateY(26%);\n  color: #108ee9;\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  z-index: 2;\n  width: 500px;\n  border: 1px solid #1fb6ff;\n  background-color: #1fb6ff;\n  -webkit-transform: translate(-50%, -50%) rotate(90deg);\n          transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate .is-deg-0 {\n  -webkit-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n.vm-draggable__rotate .is-deg-45 {\n  -webkit-transform: translate(-50%, -50%) rotate(45deg);\n          transform: translate(-50%, -50%) rotate(45deg);\n}\n.vm-draggable__rotate .is-deg-90 {\n  -webkit-transform: translate(-50%, -50%) rotate(90deg);\n          transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate .is-deg-135 {\n  -webkit-transform: translate(-50%, -50%) rotate(135deg);\n          transform: translate(-50%, -50%) rotate(135deg);\n}\n.vm-draggable__rotate .is-deg-tip {\n  position: absolute;\n  top: -50px;\n  left: 60%;\n  width: 40px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: 1px solid #262626;\n  border-radius: 8px;\n  background-color: #fff;\n}\n.vm-draggable__rotate div[class^=is-deg-] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  z-index: 2;\n  width: 500px;\n  border-top: 1px dashed #fff;\n  border-bottom: 1px dashed #262626;\n  opacity: 0.4;\n}\n.vm-draggable__delete {\n  background: #108ee9;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=draggable.vue.map */',map:{version:3,sources:["draggable.vue","/Users/deot/Desktop/wya/github/wya-vm/src/core/draggable.vue"],names:[],mappings:"AAAA,gBAAgB;AC4fhB;EACA,UAAA;EACA,kBAAA;EACA,8BAAA;UAAA,sBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;AD1fA;AC2fA;EACA,YAAA;ADzfA;AC2fA;EACA,oBAAA;ADzfA;AC2fA;EACA,UAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,UAAA;EACA,0BAAA;ADzfA;AC2fA;EACA,cAAA;ADzfA;AC4fA;EACA,0BAAA;AD1fA;AC4fA;EACA,mBAAA;AD1fA;AC4fA;EACA,cAAA;AD1fA;AC8fA;EACA,mBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;AD5fA;ACggBA;EACA,aAAA;EACA,kBAAA;EACA,8BAAA;UAAA,sBAAA;EACA,YAAA;AD7fA;AC8fA;EACA,MAAA;EACA,UAAA;EACA,iBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;AD5fA;AC6fA;EACA,oGAAA;EAAA,sEAAA;AD3fA;AC8fA;EACA,MAAA;EACA,WAAA;EACA,iBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;AD5fA;AC6fA;EACA,oGAAA;EAAA,qEAAA;AD3fA;AC+fA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;EACA,SAAA;EACA,OAAA;EACA,iBAAA;AD7fA;AC8fA;EACA,sGAAA;EAAA,uEAAA;AD5fA;AC+fA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;EACA,YAAA;EACA,OAAA;EACA,iBAAA;AD7fA;AC8fA;EACA,sGAAA;EAAA,oEAAA;AD5fA;AC+fA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,YAAA;AD7fA;AC+fA;EACA,SAAA;EACA,OAAA;EACA,mBAAA;EACA,YAAA;AD7fA;AC+fA;EACA,MAAA;EACA,QAAA;EACA,mBAAA;EACA,YAAA;AD7fA;AC+fA;EACA,SAAA;EACA,QAAA;EACA,mBAAA;EACA,YAAA;AD7fA;AC+fA;EACA,MAAA;EACA,SAAA;EACA,yCAAA;UAAA,iCAAA;EACA,yKAAA;EACA,+BAAA;EAAA,+BAAA;EAAA,wBAAA;EACA,4BAAA;EAAA,6BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,yBAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;MAAA,qBAAA;UAAA,uBAAA;AD7fA;AC8fA;EACA,YAAA;EACA,YAAA;EACA,UAAA;EACA,mBAAA;AD5fA;AC8fA;EACA,YAAA;EACA,kCAAA;UAAA,0BAAA;EACA,cAAA;AD5fA;;ACigBA;;EAAA;AAGA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,UAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,sDAAA;UAAA,8CAAA;AD9fA;AC+fA;EACA,wCAAA;UAAA,gCAAA;AD7fA;AC+fA;EACA,sDAAA;UAAA,8CAAA;AD7fA;AC+fA;EACA,sDAAA;UAAA,8CAAA;AD7fA;AC+fA;EACA,uDAAA;UAAA,+CAAA;AD7fA;AC+fA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,WAAA;EACA,YAAA;EACA,iBAAA;EACA,kBAAA;EACA,yBAAA;EACA,kBAAA;EACA,sBAAA;AD7fA;AC+fA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,2BAAA;EACA,iCAAA;EACA,YAAA;AD7fA;ACigBA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,UAAA;EACA,eAAA;AD9fA;;AAEA,wCAAwC",file:"draggable.vue",sourcesContent:['@charset "UTF-8";\n.vm-draggable {\n  padding: 0;\n  position: absolute;\n  box-sizing: border-box;\n  user-select: none;\n}\n.vm-draggable:hover {\n  cursor: move;\n}\n.vm-draggable .is-events-none {\n  pointer-events: none;\n}\n.vm-draggable .is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #108ee9;\n}\n.vm-draggable .is-active .vm-draggable__handle {\n  display: block;\n}\n.vm-draggable .is-disabled {\n  border: 1px dotted #e96101;\n}\n.vm-draggable .is-disabled .handle-rotate:after {\n  background: #e96101;\n}\n.vm-draggable .is-disabled .handle-rotate:before {\n  color: #e96101;\n}\n.vm-draggable .is-delete {\n  background: #108ee9;\n  position: absolute;\n  right: 0;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n}\n\n.vm-draggable__handle {\n  display: none;\n  position: absolute;\n  box-sizing: border-box;\n  z-index: 999;\n}\n.vm-draggable__handle.is-left {\n  top: 0;\n  left: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-left:hover {\n  background: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-right {\n  top: 0;\n  right: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-right:hover {\n  background: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  top: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-top:hover {\n  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-bottom {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  bottom: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-bottom:hover {\n  background: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top-left {\n  top: 0;\n  left: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle .is-bottom-left {\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-top-right {\n  top: 0;\n  right: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-bottom-right {\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-rotate {\n  top: 0;\n  left: 50%;\n  transform: translate(-50%, -100%);\n  cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" style="font-size: 20px;"><text y="15">↻</text></svg>\') 10 10, default;\n  display: flex !important;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.vm-draggable__handle.is-rotate:after {\n  content: " ";\n  height: 10px;\n  width: 1px;\n  background: #108ee9;\n}\n.vm-draggable__handle.is-rotate:before {\n  content: "☐";\n  transform: translateY(26%);\n  color: #108ee9;\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  z-index: 2;\n  width: 500px;\n  border: 1px solid #1fb6ff;\n  background-color: #1fb6ff;\n  transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate .is-deg-0 {\n  transform: translate(-50%, -50%);\n}\n.vm-draggable__rotate .is-deg-45 {\n  transform: translate(-50%, -50%) rotate(45deg);\n}\n.vm-draggable__rotate .is-deg-90 {\n  transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate .is-deg-135 {\n  transform: translate(-50%, -50%) rotate(135deg);\n}\n.vm-draggable__rotate .is-deg-tip {\n  position: absolute;\n  top: -50px;\n  left: 60%;\n  width: 40px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: 1px solid #262626;\n  border-radius: 8px;\n  background-color: #fff;\n}\n.vm-draggable__rotate div[class^=is-deg-] {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  z-index: 2;\n  width: 500px;\n  border-top: 1px dashed #fff;\n  border-bottom: 1px dashed #262626;\n  opacity: 0.4;\n}\n\n.vm-draggable__delete {\n  background: #108ee9;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=draggable.vue.map */',"<template>\n\t<div :style=\"coord\" class=\"vm-draggable\" @mousedown.stop=\"handleContainerDown\">\n\t\t<div :style=\"style\" :class=\"{ 'is-events-none': changing }\" >\n\t\t\t<slot :style=\"style\"/>\n\t\t</div>\n\t\t\x3c!-- handle --\x3e\n\t\t<div \n\t\t\tv-if=\"active && handles && handles.length !== 0\" \n\t\t\t:class=\"{ 'is-disabled': disabled, 'is-active': active }\" \n\t\t\t:style=\"style\"\n\t\t>\n\t\t\t<template v-for=\"item in handles\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!disabled\"\n\t\t\t\t\t:key=\"item\"\n\t\t\t\t\t:class=\"`is-${item}`\"\n\t\t\t\t\tclass=\"vm-draggable__handle\"\n\t\t\t\t\t@mousedown.left.stop=\"handleDown($event, item)\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div v-if=\"rotatable\" :style=\"{ width }\" class=\"vm-draggable__rotate\"/>\n\t\t</div>\n\t\t\x3c!-- grid for rotate --\x3e\n\t\t<template v-if=\"rotatable\">\n\t\t\t<div :style=\"{ width }\" class=\"is-deg-0\" />\n\t\t\t<div :style=\"{ width }\" class=\"is-deg-45\" />\n\t\t\t<div :style=\"{ width }\" class=\"is-deg-90\" />\n\t\t\t<div :style=\"{ width }\" class=\"is-deg-135\" />\n\t\t\t<div class=\"is-deg-tip\">{{ r }} °</div>\n\t\t</template>\n\n\t\t\x3c!-- delete --\x3e\n\t\t<p \n\t\t\tv-if=\"clearable && active\" \n\t\t\tclass=\"vm-draggable__delete\" \n\t\t\t@click=\"$emit('delete')\"\n\t\t>✕</p>\n\t</div>\n</template>\n\n<script>\nimport { isPassiveSupported, eleInRegExp } from '../utils/helper';\n\nconst doc = document.documentElement;\nconst angleArr = [0, 45, 90, 135, 180, 225, 270, 315, 360];\n\nexport default {\n\treplace: true,\n\tname: 'vm-draggable',\n\tprops: {\n\t\tdisabled: {\n\t\t\ttype: Boolean, \n\t\t\tdefault: false\n\t\t},\n\t\thandles: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => (['top', 'right', 'bottom', 'left', 'top-left', 'top-right', 'bottom-right', 'bottom-left', 'rotate'])\n\t\t},\n\t\t// 宽度\n\t\tw: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t\tvalidator: val => val >= 0\n\t\t},\n\t\t// 高度\n\t\th: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t\tvalidator: val => val >= 0\n\t\t},\n\t\t// 选择角度\n\t\tr: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// 最小宽度\n\t\tminw: {\n\t\t\ttype: Number,\n\t\t\tdefault: 36,\n\t\t\tvalidator: val => val > 0\n\t\t},\n\t\t// 最小高度\n\t\tminh: {\n\t\t\ttype: Number,\n\t\t\tdefault: 36,\n\t\t\tvalidator: val => val > 0\n\t\t},\n\t\t// 距父元素左上角X轴偏移量\n\t\tx: { \n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// 距父元素左上角Y轴偏移量\n\t\ty: { \n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// zIndex\n\t\tz: { \n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tzoom: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tgrid: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => {\n\t\t\t\treturn [1, 1];\n\t\t\t}\n\t\t},\n\t\t// 约束组件大小\n\t\trestrain: {\n\t\t\ttype: Number, \n\t\t\tdefault: 0\n\t\t},\n\t\tparent: {\n\t\t\ttype: Boolean, \n\t\t\tdefault: false\n\t\t},\n\t\teditorRegExp: {\n\t\t\ttype: Object, \n\t\t\tdefault: () => ({\n\t\t\t\tclassName: /vm-hack-editor/\n\t\t\t})\n\t\t},\n\t\t/**\n\t\t * 是否屏蔽默认事件\n\t\t */\n\t\tprevent: {\n\t\t\ttype: Boolean, \n\t\t\tdefault: true\n\t\t},\n\t\tpreventRegExp: {\n\t\t\ttype: Object, \n\t\t\tdefault: () => ({\n\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|OPTION)$/,\n\t\t\t\tclassName: /vm-hack-pevent/\n\t\t\t})\n\t\t},\n\n\t\tclearable: {\n\t\t\ttype: Boolean, \n\t\t\tdefault: false\n\t\t}\n\t},\n\tdata() {\n\n\t\treturn {\n\t\t\tresizable: false,\n\t\t\tdraggable: false,\n\t\t\trotatable: false,\n\t\t\tchanging: false,\n\t\t\tactive: false\n\t\t};\n\t},\n\tcomputed: {\n\t\tcoord() {\n\t\t\treturn {\n\t\t\t\tleft: this.x + 'px',\n\t\t\t\ttop: this.y + 'px',\n\t\t\t\tzIndex: this.z\n\t\t\t};\n\t\t},\n\t\tstyle() {\n\t\t\tconst w = this.w === 0 ? 'auto' : `${this.w}px`;\n\t\t\tconst h = this.h === 0 ? 'auto' : `${this.h}px`;\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h,\n\t\t\t\ttransform: `rotate(${this.r}deg)`\n\t\t\t};\n\t\t},\n\t\twidth() {\n\t\t\tlet num = Math.floor(\n\t\t\t\tMath.sqrt(this.w * this.w + this.h * this.h) * 1.15\n\t\t\t);\n\t\t\treturn `${num}px`;\n\t\t}\n\t},\n\twatch: {},\n\tbeforeCreate() {\n\t\tthis.parentX = 0;\n\t\tthis.parentY = 0;\n\t\tthis.parentW = 9999;\n\t\tthis.parentH = 9999;\n\t\tthis.mouseX = 0;\n\t\tthis.mouseY = 0;\n\t\tthis.lastMouseX = 0;\n\t\tthis.lastMouseY = 0;\n\t\tthis.mouseOffX = 0;\n\t\tthis.mouseOffY = 0;\n\n\t\tthis.handle = null;\n\n\t\t// 组件捕获阶段执行\n\t\tthis.eventOpts = !isPassiveSupported || { capture: true, passive: true };\n\n\t\t// 改变前状态\n\t\tthis.beforeStatus = null;\n\t},\n\tmounted() {\n\t\t// 初始化控件宽高, todo: 宽高未零时，是否需要计算\n\t\tif (this.w && this.minw > this.w) {\n\t\t\tthis.sync({ w: this.minw });\n\t\t}\n\t\tif (this.h && this.minh > this.h) {\n\t\t\tthis.sync({ h: this.minh });\n\t\t}\n\t\tconst { x, y } = this.$el.parentNode.getBoundingClientRect();\n\t\tthis.parentX = x;\n\t\tthis.parentY = y;\n\n\t\t// 判断是否只能在父级元素中拖动\n\t\tthis.parent && this.calculation();\n\t\tthis.$emit('resizing');\n\t},\n\tdestroyed() {\n\t\tthis.operateDOMEvents('remove');\n\t},\n\tmethods: {\n\t\tcalculation() {\n\t\t\tconst { width, height } = this.$el.parentNode.getBoundingClientRect();\n\t\t\tthis.parentW = width;\n\t\t\tthis.parentH = height; // this.$el.parentNode.clientHeight\n\t\t\tif (this.w > this.parentW) {\n\t\t\t\tthis.sync({ w: this.parentW });\n\t\t\t}\n\t\t\tif (this.h > this.parentH) {\n\t\t\t\tthis.sync({ h: this.parentH });\n\t\t\t}\n\t\t\tif ((this.x + this.w) > this.parentW) {\n\t\t\t\tthis.sync({ x: this.parentW - this.w });\n\t\t\t}\n\t\t\tif ((this.y + this.h) > this.parentH) {\n\t\t\t\tthis.sync({ y: this.parentH - this.h });\n\t\t\t}\n\t\t},\n\t\tsync(opts) {\t\t\t\n\t\t\tfor (let key in opts) {\n\t\t\t\tif (this[key] != opts[key]) {\n\t\t\t\t\t!this.beforeStatus && (this.beforeStatus = {\n\t\t\t\t\t\tx: this.x,\n\t\t\t\t\t\ty: this.y,\n\t\t\t\t\t\tz: this.z,\n\t\t\t\t\t\tw: this.w,\n\t\t\t\t\t\tr: this.r\n\t\t\t\t\t});\n\t\t\t\t\tthis.$emit(`update:${key}`, opts[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === 'add' ? doc.addEventListener : doc.removeEventListener;\n\n\t\t\tfn('mousedown', this.handleDeselect, this.eventOpts);\n\t\t\tfn('mousemove', this.handleMove, this.eventOpts);\n\t\t\tfn('mouseup', this.handleUp, this.eventOpts);\n\t\t},\n\t\t/**\n\t\t * 模拟设置active状态\n\t\t */\n\t\tsetActived() {\n\t\t\tthis.handleContainerDown();\n\t\t\tthis.handleUp();\n\t\t},\n\t\t/**\n\t\t * 组件被按下事件\n\t\t */\n\t\thandleContainerDown(e = {}) {\n\t\t\t// 去除默认事件 todo: 匹配输入框\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault \n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 判断是否支持拖动\n\t\t\tif (this.disabled) return;\n\t\t\tconst target = e.target || e.srcElement;\n\t\t\t// 确保事件发生在组件内部\n\t\t\tif (!target || this.$el.contains(target)) {\n\t\t\t\tif (!this.active) {\n\t\t\t\t\tthis.lastMouseX = e.pageX || e.clientX + doc.scrollLeft;\n\t\t\t\t\tthis.lastMouseY = e.pageY || e.clientY + doc.scrollTop;\n\n\t\t\t\t\t// 绑定事件\n\t\t\t\t\tthis.operateDOMEvents('add');\n\n\t\t\t\t\tthis.active = true;\n\t\t\t\t\tthis.$emit('activated');\n\t\t\t\t}\n\t\t\t\tthis.draggable = true;\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 取消选择事件\n\t\t */\n\t\thandleDeselect(e) {\n\t\t\tthis.mouseX = e.pageX || e.clientX + doc.scrollLeft;\n\t\t\tthis.mouseY = e.pageY || e.clientY + doc.scrollTop;\n\t\t\tthis.lastMouseX = this.mouseX;\n\t\t\tthis.lastMouseY = this.mouseY;\n\t\t\tconst target = e.target || e.srcElement; // body不要带上class, 否则会存在问题\n\n\t\t\t// 内部管理\n\t\t\tconst regex = {\n\t\t\t\tclassName: /is-([(top|right|-|bottom|left)]{2})/\n\t\t\t};\n\n\t\t\tlet path = e.path || (e.composedPath && e.composedPath()) || [];\n\t\t\tif (\n\t\t\t\t!this.$el.contains(target) \n\t\t\t\t&& !eleInRegExp(target, regex)\n\t\t\t\t&& (!path.some(item => eleInRegExp(item, this.editorRegExp)))\n\t\t\t) {\n\t\t\t\tif (this.active) {\n\t\t\t\t\t// 解绑\n\t\t\t\t\tthis.operateDOMEvents('remove');\n\n\t\t\t\t\tthis.active = false;\n\t\t\t\t\tthis.$emit('deactivated');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 拖动点按下事件\n\t\t */\n\t\thandleDown(e, handle) {\n\t\t\t// 去除默认事件 todo: 匹配输入框\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault \n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 将handle设置为当前元素\n\t\t\tthis.handle = handle;\n\t\t\tif (handle === 'rotate') {\n\t\t\t\tthis.rotatable = true;\n\t\t\t} else {\n\t\t\t\tthis.resizable = true;\n\t\t\t}\n\n\t\t\tthis.preMouseX = e.pageX || e.clientX + doc.scrollLeft;\n\t\t\tthis.preMouseY = e.pageY || e.clientY + doc.scrollTop;\n\t\t},\n\t\t/**\n\t\t * 鼠标在页面上的坐标\n\t\t */\n\t\thandleMove(e) {\n\t\t\tthis.mouseX = e.pageX || e.clientX + doc.scrollLeft;\n\t\t\tthis.mouseY = e.pageY || e.clientY + doc.scrollTop;\n\n\t\t\t// x, y, w, h\n\t\t\tlet elmX = parseInt(this.x, 10);\n\t\t\tlet elmY = parseInt(this.y, 10);\n\t\t\tlet elmW = parseInt(this.w, 10);\n\t\t\tlet elmH = parseInt(this.h, 10);\n\n\t\t\t// diffX =  当前鼠标位置 - 上次鼠标位置 + ？？\n\t\t\tlet diffX = (this.mouseX - this.lastMouseX + this.mouseOffX) / this.zoom;\n\t\t\tlet diffY = (this.mouseY - this.lastMouseY + this.mouseOffY) / this.zoom;\n\t\t\tthis.mouseOffX = 0;\n\t\t\tthis.mouseOffY = 0;\n\t\t\tthis.lastMouseX = this.mouseX;\n\t\t\tthis.lastMouseY = this.mouseY;\n\t\t\tif (this.resizable) {\n\t\t\t\tif (this.handle.includes('top')) {\n\t\t\t\t\tif (elmH - diffY < this.minh) { // 向下移动\n\t\t\t\t\t\t// 变换后的高度小于最小高度，diffY -> 0 , this.mouseOffY为this.y -> 当前鼠标位置的距离（正数）\n\t\t\t\t\t\tthis.mouseOffY = (diffY - (diffY = elmH - this.minh));\n\t\t\t\t\t} else if (this.parent && elmY + diffY < 0) { // 向上移动 \n\t\t\t\t\t\t// 变换后this.y 超出父层顶部边界时， diffY -> 0, this.mouseOffY为this.y -> 当前鼠标位置的距离(负数)\n\t\t\t\t\t\tthis.mouseOffY = (diffY - (diffY = -elmY));\n\t\t\t\t\t}\n\t\t\t\t\telmY += diffY;\n\t\t\t\t\telmH -= diffY;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('bottom')) {\n\t\t\t\t\tif (elmH + diffY < this.minh) { // 向上移动\n\t\t\t\t\t\tthis.mouseOffY = (diffY - (diffY = this.minh - elmH));\n\t\t\t\t\t} else if (elmY + elmH + diffY > this.parentH) { // 向下移动\n\t\t\t\t\t\tthis.mouseOffY = (diffY - (diffY = this.parentH - elmY - elmH));\n\t\t\t\t\t}\n\t\t\t\t\telmH += diffY;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('left')) {\n\t\t\t\t\tif (elmW - diffX < this.minw) { // 向右移动\n\t\t\t\t\t\tthis.mouseOffX = (diffX - (diffX = elmW - this.minw));\n\t\t\t\t\t} else if (this.parent && elmX + diffX < 0) { // 向左移动\n\t\t\t\t\t\tthis.mouseOffX = (diffX - (diffX = -elmX));\n\t\t\t\t\t}\n\t\t\t\t\telmX += diffX;\n\t\t\t\t\telmW -= diffX;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('right')) {\n\t\t\t\t\tif (elmW + diffX < this.minw) { // 向左移动\n\t\t\t\t\t\tthis.mouseOffX = (diffX - (diffX = this.minw - elmW));\n\t\t\t\t\t} else if (elmX + elmW + diffX > this.parentW) { // 向右移动\n\t\t\t\t\t\tthis.mouseOffX = (diffX - (diffX = this.parentW - elmX - elmW));\n\t\t\t\t\t}\n\t\t\t\t\telmW += diffX;\n\t\t\t\t}\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tx: (Math.round(elmX / this.grid[0]) * this.grid[0]),\n\t\t\t\t\ty: (Math.round(elmY / this.grid[1]) * this.grid[1]),\n\t\t\t\t\tw: (Math.round(elmW / this.grid[0]) * this.grid[0]),\n\t\t\t\t\th: (Math.round(elmH / this.grid[1]) * this.grid[1]),\n\t\t\t\t});\n\t\t\t\tthis.$emit('resizing');\n\t\t\t} else if (this.rotatable) {\n\t\t\t\tlet angle = this.getAngle(\n\t\t\t\t\t[this.parentX + this.x + this.w / 2, -(this.parentY + this.y + this.h / 2)],\n\t\t\t\t\t[this.lastMouseX, -this.lastMouseY],\n\t\t\t\t);\n\n\t\t\t\tlet criticalAngle = angleArr.find(item => Math.abs(item - angle) < 3);\n\t\t\t\tangle = typeof criticalAngle === 'number' ? criticalAngle : angle;\n\n\t\t\t\t!this.disabled && this.sync({ \n\t\t\t\t\tr: angle === 360 ? 0 : angle\n\t\t\t\t});\n\t\t\t\tthis.$emit('rotating');\n\t\t\t} else if (this.draggable) {\n\t\t\t\tif (this.parent) {\n\t\t\t\t\tif (elmX + diffX < 0) {\n\t\t\t\t\t\tthis.mouseOffX = (diffX * this.zoom - (diffX = -elmX));\n\t\t\t\t\t} else if (elmX + elmW + diffX > this.parentW) {\n\t\t\t\t\t\tthis.mouseOffX = (diffX * this.zoom - (diffX = this.parentW - elmX - elmW));\n\t\t\t\t\t}\n\t\t\t\t\tif (elmY + diffY < 0) {\n\t\t\t\t\t\tthis.mouseOffY = (diffY * this.zoom - (diffY = -elmY));\n\t\t\t\t\t} else if (elmY + elmH + diffY > this.parentH) {\n\t\t\t\t\t\tthis.mouseOffY = (diffY * this.zoom - (diffY = this.parentH - elmY - elmH));\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\telmX += diffX;\n\t\t\t\telmY += diffY;\n\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tx: (Math.round(elmX / this.grid[0]) * this.grid[0]),\n\t\t\t\t\ty: (Math.round(elmY / this.grid[1]) * this.grid[1]),\n\t\t\t\t});\n\t\t\t\tthis.$emit('dragging');\n\t\t\t}\n\n\t\t\t// 正在改变\n\t\t\t!this.changing \n\t\t\t\t&& (this.rotatable || this.draggable || this.resizable)\n\t\t\t\t&& (this.changing = true);\n\t\t\t\t\n\t\t},\n\t\tgetAngle(center, last) {\n\t\t\tlet diffX = last[0] - center[0];\n\t\t\tlet diffY = last[1] - center[1];\n\t\t\t/**\n\t\t\t * https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math/atan2\n\t\t\t * -180 <= c < 180\n\t\t\t */\n\t\t\tlet c = 360 * Math.atan2(diffY, diffX) / (2 * Math.PI);\n\t\t\tc = c > 90 \n\t\t\t\t? (450 - c) // 第4\n\t\t\t\t: 90 - c; // 第1，2，3象限\n\t\t\treturn Math.floor(c);\n\t\t},\n\t\tgetRestrain(num) {\n\t\t\tconst restrain = this.restrain;\n\t\t\treturn (num / restrain).toFixed(0) * restrain;\n\t\t},\n\t\thandleUp(e) {\n\t\t\tthis.changing = false;\n\t\t\tthis.handle = null;\n\t\t\t// 约束\n\t\t\tconst restrain = this.restrain;\n\t\t\tif (restrain && restrain > 0) {\n\t\t\t\tthis.sync({\n\t\t\t\t\tx: this.getRestrain(this.x),\n\t\t\t\t\ty: this.getRestrain(this.y),\n\t\t\t\t\tw: this.getRestrain(this.w),\n\t\t\t\t\th: this.getRestrain(this.h),\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.rotatable) {\n\t\t\t\tthis.rotatable = false;\n\t\t\t\tthis.$emit('rotate-end');\n\t\t\t}\n\t\t\tif (this.resizable) {\n\t\t\t\tthis.resizable = false;\n\t\t\t\tthis.$emit('resize-end');\n\t\t\t}\n\t\t\tif (this.draggable) {\n\t\t\t\tthis.draggable = false;\n\t\t\t\tthis.$emit('drag-end');\n\t\t\t}\n\t\t\tif (this.beforeStatus) {\n\t\t\t\tthis.$emit('end', this.beforeStatus);\n\t\t\t\tthis.beforeStatus = null;\n\t\t\t}\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n\n$url: 'data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" style=\"font-size: 20px;\"><text y=\"15\">↻</text></svg>';\n\n.vm-draggable {\n\tpadding: 0;\n\tposition: absolute;\n\tbox-sizing: border-box;\n\tuser-select: none;\n\t&:hover {\n\t\tcursor: move;\n\t}\n\t.is-events-none {\n\t\tpointer-events: none;\n\t}\n\t.is-active {\n\t\tpadding: 0;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tborder: 1px dotted #108ee9;\n\t\t// cursor: move;\n\t\t.vm-draggable__handle {\n\t\t\tdisplay: block;\n\t\t}\n\t}\n\t.is-disabled {\n\t\tborder: 1px dotted #e96101;\n\t\t.handle-rotate {\n\t\t\t&:after {\n\t\t\t\tbackground: #e96101;\n\t\t\t}\n\t\t\t&:before {\n\t\t\t\tcolor: #e96101;\n\t\t\t}\n\t\t}\n\t}\n\t.is-delete {\n\t\tbackground: #108ee9;\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 20px;\n\t\tcolor: white;\n\t\ttext-align: center;\n\t\tz-index: 300\n\t}\n}\n\n.vm-draggable__handle {\n\tdisplay: none;\n\tposition: absolute;\n\tbox-sizing: border-box;\n\tz-index: 999;\n\t&.is-left {\n\t\ttop: 0;\n\t\tleft: -5px;\n\t\tcursor: ew-resize;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t\twidth: 5px;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-right {\n\t\ttop: 0;\n\t\tright: -5px;\n\t\tcursor: ew-resize;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t\twidth: 5px;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\n\t&.is-top {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 5px;\n\t\ttop: -5px;\n\t\tleft: 0;\n\t\tcursor: ns-resize;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-bottom {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 5px;\n\t\tbottom: -5px;\n\t\tleft: 0;\n\t\tcursor: ns-resize;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-top-left {\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tcursor: nwse-resize;\n\t\tpadding: 5px;\n\t}\n\t.is-bottom-left {\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tcursor: nesw-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-top-right {\n\t\ttop: 0;\n\t\tright: 0;\n\t\tcursor: nesw-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-bottom-right {\n\t\tbottom: 0;\n\t\tright: 0;\n\t\tcursor: nwse-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-rotate {\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, -100%);\n\t\tcursor: url($url) 10 10,default;\n\t\tdisplay: flex !important;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\t&:after {\n\t\t\tcontent: ' ';\n\t\t\theight: 10px;\n\t\t\twidth: 1px;\n\t\t\tbackground: #108ee9;\n\t\t}\n\t\t&:before {\n\t\t\tcontent: '☐';\n\t\t\ttransform: translateY(26%);\n\t\t\tcolor: #108ee9;\n\t\t}\n\t}\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tz-index: 2;\n\twidth: 500px;\n\tborder: 1px solid #1fb6ff;\n\tbackground-color: #1fb6ff;\n\ttransform: translate(-50%, -50%) rotate(90deg);\n\t.is-deg-0 {\n\t\ttransform: translate(-50%, -50%);\n\t}\n\t.is-deg-45 {\n\t\ttransform: translate(-50%, -50%) rotate(45deg);\n\t}\n\t.is-deg-90 {\n\t\ttransform: translate(-50%, -50%) rotate(90deg);\n\t}\n\t.is-deg-135 {\n\t\ttransform: translate(-50%, -50%) rotate(135deg);\n\t}\n\t.is-deg-tip {\n\t\tposition: absolute;\n\t\ttop: -50px;\n\t\tleft: 60%;\n\t\twidth: 40px;\n\t\theight: 16px;\n\t\tline-height: 16px;\n\t\ttext-align: center;\n\t\tborder: 1px solid #262626;\n\t\tborder-radius: 8px;\n\t\tbackground-color: #fff;\n\t}\n\tdiv[class^=is-deg-] {\n\t\tposition: absolute;\n\t\ttop: 50%;\n\t\tleft: 50%;\n\t\tz-index: 2;\n\t\twidth: 500px;\n\t\tborder-top: 1px dashed #fff;\n\t\tborder-bottom: 1px dashed #262626;\n\t\topacity: .4;\n\t}\n}\n\n.vm-draggable__delete {\n\tbackground: rgb(16, 142, 233); \n\tposition: absolute; \n\tright: 0px; \n\twidth: 20px; \n\tcolor: white; \n\ttext-align: center; \n\tz-index: 300;\n\ttop: 0;\n\tright: 0px;\n\tcursor: pointer;\n}\n\n</style>\n"]},media:void 0})},Li,void 0,!1,void 0,Fi,void 0),Vi=document.documentElement,Gi=null,Ki={replace:!0,name:"vm-srot-list-item",props:{index:{type:Number|String,required:!0},type:{type:String,default:"@wya/vm"},disabled:qi.props.disabled,editorRegExp:qi.props.editorRegExp,prevent:qi.props.prevent,preventRegExp:qi.props.preventRegExp,clearable:qi.props.clearable},data:function(){return{active:!1,isHover:!1,highlight:!1}},computed:{},watch:{},beforeCreate:function(){this.eventOpts=!Si||{capture:!0,passive:!0}},mounted:function(){},destroyed:function(){this.operateDOMEvents("remove")},methods:{operateDOMEvents:function(t){("add"===t?Vi.addEventListener:Vi.removeEventListener)("mousedown",this.handleDeselect,this.eventOpts)},setActived:function(){this.handleClick()},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.prevent&&t.preventDefault&&!Ni(t.target,this.preventRegExp)&&t.preventDefault(),!this.disabled){var e=t.target||t.srcElement;e&&!this.$el.contains(e)||this.active||(this.operateDOMEvents("add"),this.active=!0,this.$emit("activated"))}},handleDeselect:function(t){var e=this,n=t.target||t.srcElement,i=t.path||t.composedPath&&t.composedPath()||[];this.$el.contains(n)||i.some(function(t){return Ni(t,e.editorRegExp)})||this.active&&(this.operateDOMEvents("remove"),this.active=!1,this.$emit("deactivated"))},handleDragStart:function(t){t.dataTransfer.setData(this.type,this.index),t.dataTransfer.effectAllowed="move",(Gi=t.target).__START_INDEX__=this.index,Gi.__END_INDEX__=this.index,t.target.style.opacity=0},handleDragEnter:function(t){var e=this;if(Gi&&t.target!=Gi){if(this.index!=Gi.__END_INDEX__){if(this.timer)return;this.timer=setTimeout(function(){e.timer=null},500),this.$emit("sort",[Gi.__END_INDEX__,this.index]),Gi.__END_INDEX__=this.index}}else Gi||(this.highlight=!0,this.$emit("highlight-change",!0))},handleDragLeave:function(){this.highlight=!1,this.$emit("highlight-change",!1)},handleDragEnd:function(t){t.dataTransfer.clearData(this.type),t.target.style.opacity=1,Gi&&this.$emit("sort-end",[Gi.__START_INDEX__,Gi.__END_INDEX__]),Gi=null}}},Ji=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-sortable",attrs:{draggable:!t.disabled},on:{click:t.handleClick,dragstart:t.handleDragStart,dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,dragover:function(t){t.preventDefault()},dragend:t.handleDragEnd,mouseenter:function(e){t.isHover=!0},mouseleave:function(e){t.isHover=!1}}},[n("div",{staticStyle:{"pointer-events":"none"}},[t._t("default")],2),t._v(" "),t.active||t.isHover?n("div",{class:{"is-disabled":t.disabled,"is-active":!0}}):t._e(),t._v(" "),t.clearable&&(t.active||t.isHover)?n("p",{staticClass:"vm-sortable__delete",on:{click:function(e){return t.$emit("delete")}}},[t._v("✕")]):t._e(),t._v(" "),t.highlight?n("p",{staticClass:"vm-sortable__highlight"}):t._e()])};Ji._withStripped=!0;var Qi=Ti({render:Ji,staticRenderFns:[]},function(t){t&&t("data-v-788274f2_0",{source:".vm-sortable {\n  padding: 0;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  position: relative;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n}\n.vm-sortable:hover {\n  cursor: move;\n}\n.vm-sortable .is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #108ee9;\n  cursor: move;\n}\n.vm-sortable.is-disabled {\n  cursor: no-drop;\n}\n.vm-sortable__delete {\n  background: #108ee9;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n.vm-sortable__highlight {\n  height: 2px;\n  background: red;\n}\n\n/*# sourceMappingURL=sortable.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/core/sortable.vue","sortable.vue"],names:[],mappings:"AA4MA;EACA,UAAA;EACA,8BAAA;UAAA,sBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,kBAAA;EACA,gCAAA;EAAA,wBAAA;AC3MA;AD4MA;EACA,YAAA;AC1MA;AD4MA;EACA,UAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,UAAA;EACA,0BAAA;EACA,YAAA;AC1MA;AD4MA;EACA,eAAA;AC1MA;AD8MA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,UAAA;EACA,eAAA;AC3MA;AD8MA;EACA,WAAA;EACA,eAAA;AC3MA;;AAEA,uCAAuC",file:"sortable.vue",sourcesContent:['<template>\n\t<div \n\t\t:draggable="!disabled"\n\t\tclass="vm-sortable" \n\t\t@click="handleClick"\n\t\t@dragstart="handleDragStart"\n\t\t@dragenter="handleDragEnter"\n\t\t@dragleave="handleDragLeave"\n\t\t@dragover.prevent\n\t\t@dragend="handleDragEnd"\n\t\t@mouseenter="isHover = true"\n\t\t@mouseleave="isHover = false"\n\t>\n\t\t<div style="pointer-events: none;">\n\t\t\t<slot />\n\t\t</div>\n\t\t\x3c!-- handle --\x3e\n\t\t<div \n\t\t\tv-if="active || isHover" \n\t\t\t:class="{ \n\t\t\t\t\'is-disabled\': disabled, \n\t\t\t\t\'is-active\': true \n\t\t\t}" \n\t\t/>\n\t\t<p \n\t\t\tv-if="clearable && (active || isHover)" \n\t\t\tclass="vm-sortable__delete" \n\t\t\t@click="$emit(\'delete\')"\n\t\t>✕</p>\n\n\t\t<p v-if="highlight" class="vm-sortable__highlight" />\n\t</div>\n</template>\n\n<script>\nimport { isPassiveSupported, eleInRegExp } from \'../utils/helper\';\nimport Draggable from \'./draggable.vue\';\n\nconst doc = document.documentElement;\nlet eleDrag = null;\n\nexport default {\n\treplace: true,\n\tname: \'vm-srot-list-item\',\n\tprops: {\n\t\t// 当前排序数组的索引值，非order\n\t\tindex: {\n\t\t\ttype: Number | String,\n\t\t\trequired: true\n\t\t},\n\t\t// 用于getData/setData\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: \'@wya/vm\'\n\t\t},\n\t\tdisabled: Draggable.props.disabled,\n\t\teditorRegExp: Draggable.props.editorRegExp,\n\t\tprevent: Draggable.props.prevent,\n\t\tpreventRegExp: Draggable.props.preventRegExp,\n\t\tclearable: Draggable.props.clearable,\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tactive: false,\n\t\t\tisHover: false,\n\t\t\thighlight: false\n\t\t};\n\t},\n\tcomputed: {\n\t\t\n\t},\n\twatch: {},\n\tbeforeCreate() {\n\t\t// 组件捕获阶段执行\n\t\tthis.eventOpts = !isPassiveSupported || { capture: true, passive: true };\n\t},\n\tmounted() {\n\t\t\n\t},\n\tdestroyed() {\n\t\tthis.operateDOMEvents(\'remove\');\n\t},\n\tmethods: {\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === \'add\' ? doc.addEventListener : doc.removeEventListener;\n\n\t\t\tfn(\'mousedown\', this.handleDeselect, this.eventOpts);\n\t\t},\n\t\t/**\n\t\t * 模拟设置active状态\n\t\t */\n\t\tsetActived() {\n\t\t\tthis.handleClick();\n\t\t},\n\t\t/**\n\t\t * 组件被按下事件\n\t\t */\n\t\thandleClick(e = {}) {\n\t\t\t// 去除默认事件 todo: 匹配输入框\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault \n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 判断是否支持拖动\n\t\t\tif (this.disabled) return;\n\t\t\tconst target = e.target || e.srcElement;\n\t\t\t// 确保事件发生在组件内部\n\t\t\tif (!target || this.$el.contains(target)) {\n\t\t\t\tif (!this.active) {\n\t\t\t\t\t// 绑定事件\n\t\t\t\t\tthis.operateDOMEvents(\'add\');\n\n\t\t\t\t\tthis.active = true;\n\t\t\t\t\tthis.$emit(\'activated\');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 取消选择事件\n\t\t */\n\t\thandleDeselect(e) {\n\t\t\tconst target = e.target || e.srcElement; // body不要带上class, 否则会存在问题\n\n\t\t\tlet path = e.path || (e.composedPath && e.composedPath()) || [];\n\t\t\tif (\n\t\t\t\t!this.$el.contains(target) \n\t\t\t\t&& (!path.some(item => eleInRegExp(item, this.editorRegExp)))\n\t\t\t) {\n\t\t\t\tif (this.active) {\n\t\t\t\t\t// 解绑\n\t\t\t\t\tthis.operateDOMEvents(\'remove\');\n\n\t\t\t\t\tthis.active = false;\n\t\t\t\t\tthis.$emit(\'deactivated\');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t* 拖拽开始\n\t\t*/\n\t\thandleDragStart(e) {\n\t\t\t// 定义拖动数据 - 拖到别的输入框展示的内容\n\t\t\te.dataTransfer.setData(this.type, this.index);\n\n\t\t\t// 拖放效果\n\t\t\te.dataTransfer.effectAllowed = "move";\n\n\t\t\teleDrag = e.target;\n\n\t\t\teleDrag.__START_INDEX__ = this.index;\n\t\t\teleDrag.__END_INDEX__ = this.index;\n\n\t\t\te.target.style.opacity = 0;\n\t\t},\n\n\t\t/**\n\t\t* 拖拽元素进入目标元素头上的时候\n\t\t*/\n\t\thandleDragEnter(e) {\n\t\t\tif (eleDrag && e.target != eleDrag) { // 排序\n\t\t\t\tif (this.index != eleDrag.__END_INDEX__) {\n\t\t\t\t\tif (this.timer) return;\n\t\t\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\t\t\tthis.timer = null;\n\t\t\t\t\t}, 500);\n\n\t\t\t\t\tthis.$emit(\'sort\', [eleDrag.__END_INDEX__, this.index]);\n\t\t\t\t\teleDrag.__END_INDEX__ = this.index;\n\t\t\t\t}\n\t\t\t} else if (!eleDrag) { // 处理高亮\n\t\t\t\tthis.highlight = true;\n\t\t\t\tthis.$emit(\'highlight-change\', true);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 拖拽离开\n\t\t */\n\t\thandleDragLeave() {\n\t\t\tthis.highlight = false;\n\t\t\tthis.$emit(\'highlight-change\', false);\n\t\t},\n\n\t\t/**\n\t\t* 拖拽结束\n\t\t*/\n\t\thandleDragEnd(e) {\n\t\t\te.dataTransfer.clearData(this.type);\n\n\t\t\te.target.style.opacity = 1;\n\n\t\t\tif (eleDrag) {\n\t\t\t\tthis.$emit(\'sort-end\', [eleDrag.__START_INDEX__, eleDrag.__END_INDEX__]);\n\t\t\t}\n\n\t\t\teleDrag = null;\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-sortable {\n\tpadding: 0;\n\tbox-sizing: border-box;\n\tuser-select: none;\n\tposition: relative;\n\ttransition: opacity .5s; // 目的是让拖拽的那个元素保持不透明， 文档流里透明\n\t&:hover {\n\t\tcursor: move;\n\t}\n\t.is-active {\n\t\tpadding: 0;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tborder: 1px dotted #108ee9;\n\t\tcursor: move;\n\t}\n\t&.is-disabled {\n\t\tcursor: no-drop;\n\t}\n}\n\n.vm-sortable__delete {\n\tbackground: rgb(16, 142, 233); \n\tposition: absolute; \n\tright: 0px; \n\twidth: 20px; \n\tcolor: white; \n\ttext-align: center; \n\tz-index: 300;\n\ttop: 0;\n\tright: 0px;\n\tcursor: pointer;\n}\n\n.vm-sortable__highlight {\n\theight: 2px;\n\tbackground: red;\n}\n \n</style>\n',".vm-sortable {\n  padding: 0;\n  box-sizing: border-box;\n  user-select: none;\n  position: relative;\n  transition: opacity 0.5s;\n}\n.vm-sortable:hover {\n  cursor: move;\n}\n.vm-sortable .is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #108ee9;\n  cursor: move;\n}\n.vm-sortable.is-disabled {\n  cursor: no-drop;\n}\n\n.vm-sortable__delete {\n  background: #108ee9;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n.vm-sortable__highlight {\n  height: 2px;\n  background: red;\n}\n\n/*# sourceMappingURL=sortable.vue.map */"]},media:void 0})},Ki,void 0,!1,void 0,Fi,void 0);function Zi(t){return(Zi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tr(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function er(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nr(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),i.forEach(function(e){er(t,e,n[e])})}return t}function ir(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var rr={name:"vm-tpl-viewer",components:{},props:{id:String,x:Number,y:Number,z:Number,w:Number,h:Number,r:Number,name:[Number,String]},data:function(){return{}},computed:{},created:function(){},methods:{}},ar=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:[{height:t.h?t.h+"px":"auto",width:t.w?t.w+"px":"auto",color:"black"}]},[t._v("\n\tid: "+t._s(t.id)+" "),n("br"),t._v("\n\tX: "+t._s(t.x)+" "),n("br"),t._v("\n\tY: "+t._s(t.y)+" "),n("br"),t._v("\n\tZ: "+t._s(t.z)+" "),n("br"),t._v("\n\tWidth: "+t._s(t.w?t.w:"auto")+" "),n("br"),t._v("\n\tHeight: "+t._s(t.h?t.h:"auto")+" "),n("br"),t._v("\n\tRotate: "+t._s(t.r)+" "),n("br"),t._v("\n\tName: "+t._s(t.name)+" "),n("br")])};ar._withStripped=!0;var or=Ti({render:ar,staticRenderFns:[]},function(t){t&&t("data-v-611f347d_0",{source:"\n\n/*# sourceMappingURL=viewer.vue.map */",map:{version:3,sources:["viewer.vue"],names:[],mappings:";;AAEA,qCAAqC",file:"viewer.vue"},media:void 0})},rr,"data-v-611f347d",!1,void 0,Fi,void 0),sr={name:"vm-tpl-editor",components:{},inheritAttrs:!1,props:{},data:function(){return nr({},this.$attrs)},computed:{},created:function(){},methods:{handleChange:function(t,e){this.$emit("change",er({},e,t.target.value))},handleClick:function(){this.$emit("change",{x:this.x+1})}}},dr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{display:"flex","flex-direction":"column"}},[n("div",[t._v("w: "),n("input",{domProps:{value:t.w},on:{input:function(e){return t.handleChange(e,"w")}}})]),t._v(" "),n("div",[t._v("h: "),n("input",{domProps:{value:t.h},on:{input:function(e){return t.handleChange(e,"h")}}})]),t._v(" "),n("div",[t._v("x: "),n("input",{domProps:{value:t.x},on:{input:function(e){return t.handleChange(e,"x")}}})]),t._v(" "),n("div",[t._v("y: "),n("input",{domProps:{value:t.y},on:{input:function(e){return t.handleChange(e,"y")}}})]),t._v(" "),n("div",[t._v("z: "),n("input",{domProps:{value:t.z},on:{input:function(e){return t.handleChange(e,"z")}}})]),t._v(" "),n("div",[t._v("r: "),n("input",{domProps:{value:t.r},on:{input:function(e){return t.handleChange(e,"r")}}})]),t._v(" "),n("div",[t._v("name: "),n("input",{domProps:{value:t.name},on:{input:function(e){return t.handleChange(e,"name")}}})])])};dr._withStripped=!0;var lr={module:"tpl",type:"基础组件",name:"模版",Viewer:or,Editor:Ti({render:dr,staticRenderFns:[]},function(t){t&&t("data-v-7b978e81_0",{source:"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/modules/tpl/editor.vue","editor.vue"],names:[],mappings:"AAmDA;EACA,sBAAA;EACA,YAAA;AClDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div style="display: flex; flex-direction: column;">\n\t\t<div>w: <input :value="w" @input="handleChange($event, \'w\')"></div>\n\t\t<div>h: <input :value="h" @input="handleChange($event, \'h\')"></div>\n\t\t<div>x: <input :value="x" @input="handleChange($event, \'x\')"></div>\n\t\t<div>y: <input :value="y" @input="handleChange($event, \'y\')"></div>\n\t\t<div>z: <input :value="z" @input="handleChange($event, \'z\')"></div>\n\t\t<div>r: <input :value="r" @input="handleChange($event, \'r\')"></div>\n\t\t<div>name: <input :value="name" @input="handleChange($event, \'name\')"></div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n\tname: \'vm-tpl-editor\',\n\tcomponents: {\n\t},\n\t// 以下两周都可行，相对的inheritAttrs比较好用的一点\n\tinheritAttrs: false,\n\tprops: {\n\t\t// w: Number,\n\t\t// h: Number,\n\t\t// r: Number,\n\t\t// x: Number,\n\t\t// y: Number,\n\t\t// z: Number,\n\t\t// name: [Number, String],\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t...this.$attrs\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\tcreated() {\n\t},\n\tmethods: {\n\t\thandleChange(e, key) {\n\t\t\tthis.$emit(\'change\', { [key]: e.target.value });\n\t\t},\n\t\thandleClick() {\n\t\t\t// this.$emit(\'update:x\', this.x + 1);\n\t\t\tthis.$emit(\'change\', { x: this.x + 1 });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\ninput {\n\tborder: 1px solid #000;\n\tmargin: 10px;\n}\n</style>\n',"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})},sr,void 0,!1,void 0,Fi,void 0),data:{w:200,h:150,r:0,x:0,y:0,z:1,parent:!1,clearable:!0,name:"名称"},dataValidity:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name?null:{error:"输入框内容必填"}}},hr={name:"vm-tpl-viewer",components:{},props:{id:String,x:Number,y:Number,z:Number,w:Number,h:Number,r:Number,name:[Number,String]},data:function(){return{}},computed:{},created:function(){},methods:{}},cr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:[{height:t.h?t.h+"px":"auto",width:t.w?t.w+"px":"auto",color:"black"}]},[t._v("\n\tid: "+t._s(t.id)+" "),n("br"),t._v("\n\tX: "+t._s(t.x)+" "),n("br"),t._v("\n\tY: "+t._s(t.y)+" "),n("br"),t._v("\n\tZ: "+t._s(t.z)+" "),n("br"),t._v("\n\tWidth: "+t._s(t.w?t.w:"auto")+" "),n("br"),t._v("\n\tHeight: "+t._s(t.h?t.h:"auto")+" "),n("br"),t._v("\n\tRotate: "+t._s(t.r)+" "),n("br"),t._v("\n\tName: "+t._s(t.name)+" "),n("br")])};cr._withStripped=!0;var ur=Ti({render:cr,staticRenderFns:[]},function(t){t&&t("data-v-479474a6_0",{source:"\n\n/*# sourceMappingURL=viewer.vue.map */",map:{version:3,sources:["viewer.vue"],names:[],mappings:";;AAEA,qCAAqC",file:"viewer.vue"},media:void 0})},hr,void 0,!1,void 0,Fi,void 0),Ar={name:"vm-array-editor",components:{},inheritAttrs:!1,props:{},data:function(){return nr({},this.$attrs)},computed:{},created:function(){},methods:{handleChange:function(t,e){this.$emit("change",er({},e,t.target.value))},handleClick:function(){this.$emit("change",{x:this.x+1})}}},pr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{display:"flex","flex-direction":"column"}},[n("div",[t._v("w: "),n("input",{domProps:{value:t.w},on:{input:function(e){return t.handleChange(e,"w")}}})]),t._v(" "),n("div",[t._v("h: "),n("input",{domProps:{value:t.h},on:{input:function(e){return t.handleChange(e,"h")}}})]),t._v(" "),n("div",[t._v("x: "),n("input",{domProps:{value:t.x},on:{input:function(e){return t.handleChange(e,"x")}}})]),t._v(" "),n("div",[t._v("y: "),n("input",{domProps:{value:t.y},on:{input:function(e){return t.handleChange(e,"y")}}})]),t._v(" "),n("div",[t._v("z: "),n("input",{domProps:{value:t.z},on:{input:function(e){return t.handleChange(e,"z")}}})]),t._v(" "),n("div",[t._v("r: "),n("input",{domProps:{value:t.r},on:{input:function(e){return t.handleChange(e,"r")}}})]),t._v(" "),n("div",[t._v("name: "),n("input",{domProps:{value:t.name},on:{input:function(e){return t.handleChange(e,"name")}}})])])};pr._withStripped=!0;var fr={tpl:lr,array:{module:"array",type:"营销组件",name:"数组模版",widgets:[{render:function(t,e){return t("div",["一行两列"])}},{name:"一行两列",image:"https://avatars3.githubusercontent.com/u/34465004?s=200&v=4"}],Viewer:ur,Editor:Ti({render:pr,staticRenderFns:[]},function(t){t&&t("data-v-6a0cea3e_0",{source:"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/modules/array/editor.vue","editor.vue"],names:[],mappings:"AAmDA;EACA,sBAAA;EACA,YAAA;AClDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div style="display: flex; flex-direction: column;">\n\t\t<div>w: <input :value="w" @input="handleChange($event, \'w\')"></div>\n\t\t<div>h: <input :value="h" @input="handleChange($event, \'h\')"></div>\n\t\t<div>x: <input :value="x" @input="handleChange($event, \'x\')"></div>\n\t\t<div>y: <input :value="y" @input="handleChange($event, \'y\')"></div>\n\t\t<div>z: <input :value="z" @input="handleChange($event, \'z\')"></div>\n\t\t<div>r: <input :value="r" @input="handleChange($event, \'r\')"></div>\n\t\t<div>name: <input :value="name" @input="handleChange($event, \'name\')"></div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n\tname: \'vm-array-editor\',\n\tcomponents: {\n\t},\n\t// 以下两周都可行，相对的inheritAttrs比较好用的一点\n\tinheritAttrs: false,\n\tprops: {\n\t\t// w: Number,\n\t\t// h: Number,\n\t\t// r: Number,\n\t\t// x: Number,\n\t\t// y: Number,\n\t\t// z: Number,\n\t\t// name: [Number, String],\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t...this.$attrs\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\tcreated() {\n\t},\n\tmethods: {\n\t\thandleChange(e, key) {\n\t\t\tthis.$emit(\'change\', { [key]: e.target.value });\n\t\t},\n\t\thandleClick() {\n\t\t\t// this.$emit(\'update:x\', this.x + 1);\n\t\t\tthis.$emit(\'change\', { x: this.x + 1 });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\ninput {\n\tborder: 1px solid #000;\n\tmargin: 10px;\n}\n</style>\n',"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})},Ar,void 0,!1,void 0,Fi,void 0),max:5,data:function(t){return{w:200,h:150,r:0,x:0,y:0,z:1,parent:!1,clearable:!0,name:"名称".concat(t)}},dataValidity:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name?null:{error:"输入框内容必填"}}}},vr={name:"vm-assist-operation",components:{},props:{total:Number,current:Number,isEdit:Boolean},data:function(){return{}},computed:{},watch:{},created:function(){},methods:{handleUndo:function(){this.$emit("undo")},handleRedo:function(){this.$emit("redo")},handleDelete:function(){this.$emit("delete")}}},mr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-assist-operation vm-hack-editor"},[n("div",{class:{disabled:0===t.current},on:{click:t.handleUndo}},[t._v("←")]),t._v(" "),n("div",{class:{disabled:t.current===t.total},on:{click:t.handleRedo}},[t._v("→")]),t._v(" "),n("div",{class:{disabled:!t.isEdit},on:{click:t.handleDelete}},[t._v("✕")]),t._v(" "),n("span",[t._v("\n\t\tcur: "+t._s(t.current)+"\n\t\tlast: "+t._s(t.total)+"\n\t")])])};mr._withStripped=!0;var gr=Ti({render:mr,staticRenderFns:[]},void 0,vr,void 0,!1,void 0,void 0,void 0),br={name:"vm-assist-save",components:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},methods:{}},_r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-assist-save vm-hack-editor"},[n("div",{on:{click:function(e){return t.$emit("save")}}},[t._v("保存")]),t._v(" "),n("div",{on:{click:function(e){return t.$emit("preview")}}},[t._v("预览")])])};_r._withStripped=!0;var yr=Ti({render:_r,staticRenderFns:[]},void 0,br,void 0,!1,void 0,void 0,void 0),xr={Customer:{name:"vm-customer",functional:!0,inheritAttrs:!1,props:{render:{type:Function,default:function(){return function(t){return t("div")}}}},render:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.data.attrs,i=void 0===n?{}:n;return e.props.render(t,i,e)}},Operation:gr,Save:yr};!function(t,e){void 0===e&&(e={});var n=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===n&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}(".vm-combo__theme--default{display:-webkit-box;display:-ms-flexbox;display:flex}.vm-combo__theme--default .vm-widget{-webkit-box-flex:0;-ms-flex:0 0 296px;flex:0 0 296px;width:296px}.vm-combo__theme--default .vm-widget__wrapper{background:#fff;padding:10px 0}.vm-combo__theme--default .vm-widget__header{font-size:15px;color:#000;padding:8px 15px;font-weight:400}.vm-combo__theme--default .vm-widget__tip{background:#fdf5e8;height:40px;border-top:1px solid #d9d9d9;margin:0 8px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;color:#666}.vm-combo__theme--default .vm-widget__tip p{-webkit-box-flex:1;-ms-flex:1;flex:1}.vm-combo__theme--default .vm-widget__tip span{color:#666;cursor:pointer}.vm-combo__theme--default .vm-widget__tabs{padding:12px 18px;color:#666;display:-webkit-box;display:-ms-flexbox;display:flex;line-height:24px;font-size:12px;border-bottom:1px solid #d9d9d9}.vm-combo__theme--default .vm-widget__tabs p:not(:first-child){margin-left:40px}.vm-combo__theme--default .vm-widget__tabs p.is-active{color:#5495f6;border-bottom:2px solid #5495f6}.vm-combo__theme--default .vm-widget__title{padding:15px 20px;font-size:12px;color:#000;font-weight:700;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;border-bottom:1px solid #d9d9d9}.vm-combo__theme--default .vm-widget__title.is-draggable{cursor:move}.vm-combo__theme--default .vm-widget__title.is-click{cursor:pointer}.vm-combo__theme--default .vm-widget__title.is-active{border-left:2px solid #5495f6;color:#5495f6}.vm-combo__theme--default .vm-widget__title.is-active .vm-widget__arrow{-webkit-transform:rotate(-135deg);transform:rotate(-135deg)}.vm-combo__theme--default .vm-widget__arrow{width:8px;height:8px;border:2px solid #d9d9d9;border-top:0;border-left:0;-webkit-transform:rotate(45deg);transform:rotate(45deg);-webkit-transition:-webkit-transform .2s ease-in-out;transition:-webkit-transform .2s ease-in-out;transition:transform .2s ease-in-out;transition:transform .2s ease-in-out,-webkit-transform .2s ease-in-out}.vm-combo__theme--default .vm-widget__combo{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;width:100%;border-bottom:1px solid #d9d9d9;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;padding:12px}.vm-combo__theme--default .vm-widget__item{-webkit-box-flex:0;-ms-flex:0 0 50%;flex:0 0 50%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:6px 12px;cursor:move}.vm-combo__theme--default .vm-widget__item img{width:100%;border:1px dashed #d9d9d9}.vm-combo__theme--default .vm-widget__item p{padding-top:8px}.vm-combo__theme--default .vm-frame-sortable{overflow:auto}.vm-combo__theme--default .vm-frame-draggable,.vm-combo__theme--default .vm-frame-sortable{-ms-flex-negative:0;flex-shrink:0;border:1px solid #d9d9d9;margin-left:20px;position:relative}.vm-combo__theme--default .vm-editor{-ms-flex-negative:0;flex-shrink:0;margin-left:20px;min-width:426px;max-width:426px}.vm-combo__theme--default .vm-editor-wrapper{position:relative;padding:15px;border:1px solid rgba(0,0,0,.10196);border-radius:6px;-webkit-box-shadow:0 2px 12px rgba(0,0,0,.15);box-shadow:0 2px 12px rgba(0,0,0,.15);background:#fff}.vm-combo__theme--default .vm-editor__arrow{left:-7px;top:20px;width:14px;height:14px;-webkit-transform:translateX(-50%) rotate(45deg);transform:translateX(-50%) rotate(45deg);-webkit-box-shadow:-3px 3px 7px rgba(0,0,0,.07);box-shadow:-3px 3px 7px rgba(0,0,0,.07);background:#fff;-webkit-transform:rotate(45deg);transform:rotate(45deg);position:absolute;border-color:transparent;border-style:solid;border-left:1px solid rgba(0,0,0,.10196);border-bottom:1px solid rgba(0,0,0,.10196)}");var wr={name:"vm-combo",components:{"vm-assist-operation":xr.Operation,"vm-assist-save":xr.Save},model:{prop:"data-source",event:"change"},props:{width:Number,height:Number,dataSource:{type:Array,default:function(){return[]}},frameStyle:Object,frameW:Number,frameH:Number,frameOpts:Object,widgetStyle:Object,widgetW:Number,widgetH:Number,widgetOpts:Object,theme:{type:String,default:"default"},showAssist:{type:Boolean,default:!1}},data:function(){return{editor:null,current:0,total:0,rebuildData:[]}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}},classes:function(){return er({},"vm-combo__theme--".concat(this.theme),!!this.theme)}},watch:{dataSource:{deep:!0,immediate:!0,handler:function(t){zi(t,this.rebuildData)||(this.rebuildData=Ln(this.dataSource))}}},created:function(){this.historyData=[]},destroyed:function(){this.$options.previewManager.hide()},methods:{sync:function(t){for(var e in t)this[e]!=t[e]&&this.$emit("update:".concat(e),t[e])},syncData:function(){this.$emit("change",this.rebuildData),this.$emit("update:data-source",this.rebuildData)},handleActivated:function(t){this.editor=t},handleDeactivated:function(t){this.editor=null},handleWidgetChangee:function(t){for(var e=arguments,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=e[r];this.$emit.apply(this,["widget-change",t].concat(i))},handleChange:function(t){var e=t.type,n=t.id,i=t.index,r=t.old,a=t.sort;e&&(a||n)||console.error("[wya-vm/combo]: id, type is required");var o=this.current,s=this.total,d={type:e,id:n,old:r,sort:a,index:n&&void 0===i?this.rebuildData.findIndex(function(t){return t.id===n}):i,data:Ln(this.rebuildData.find(function(t){return t.id===n}))};o===s?this.historyData.push(d):this.historyData.splice(o,s-o,d);var l=this.historyData.length;this.current=l,this.total=l,"delete"===e&&(this.rebuildData.splice(d.index,1),this.editor=null),this.syncData()},handleOperate:function(t){for(var e=arguments,n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=e[r];this[t]&&this[t].apply(this,i)},delete:function(t){(t=t||(this.editor||{}).id)?this.handleChange({type:"delete",id:t}):this.$emit("error",{type:"id",msg:"请先选择操作对象"})},undo:function(){var t=this.current-1;if(t<0)this.$emit("error",{type:"undo",msg:"目前已经是初始状态"});else{this.current=t;var e=this.historyData[this.current]||{},n=e.type,i=e.id,r=e.data,a=e.index,o=e.old,s=e.sort;switch(n){case"create":this.rebuildData.splice(a,1);break;case"delete":this.rebuildData.splice(a,0,r);break;case"update":this.rebuildData.splice(a,1,Ln(nr({},r,o)));break;case"sort":this.$refs.frame.sortData(s)}this.editor&&this.editor.id===i&&(this.editor=this.rebuildData[a]),this.syncData()}},redo:function(){var t=this.current+1;if(t>this.total)this.$emit("error",{type:"undo",msg:"目前已经是最终状态"});else{this.current=t;var e=this.historyData[this.current-1],n=e.type,i=e.id,r=e.data,a=e.index,o=e.sort;switch(n){case"create":this.rebuildData.splice(a,1,r);break;case"delete":this.rebuildData.splice(a,1);break;case"update":this.rebuildData.splice(a,1,r);break;case"sort":this.$refs.frame.sortData(o)}this.editor&&this.editor.id===i&&(this.editor=this.rebuildData[a]),this.syncData()}},save:function(){var t=Ln(this.rebuildData)||[];if(0!==t.length){for(var e=this.$options.modules,n=0;n<t.length;n++){var i=t[n].module;if(e[i].dataValidity){var r=e[i].dataValidity(t[n]);if(r)return this.$emit("error",{type:"save",msg:"第".concat(n+1,"个 - ").concat(r.error),index:n}),void this.$refs.frame.setActived(n)}}this.$emit("save",t)}else this.$emit("error",{type:"save",msg:"保存对象不能为空"})},preview:function(){0!==this.rebuildData.length?this.$options.previewManager.show({dataSource:Ln(this.rebuildData),style:nr({},this.frameStyle,{width:0===this.frameW?"auto":"".concat(this.frameW,"px"),height:0===this.frameH?"auto":"".concat(this.frameH,"px")}),className:"vm-combo__frame"}):this.$emit("error",{type:"preview",msg:"预览数据对象不能为空"})}}},Cr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-combo",class:t.classes,style:t.style},[n("vm-widget",t._b({style:t.widgetStyle,on:{change:t.handleWidgetChangee}},"vm-widget",t.widgetOpts,!1)),t._v(" "),n("vm-frame",t._b({ref:"frame",style:t.frameStyle,attrs:{width:t.frameW,height:t.frameH,"data-source":t.rebuildData,editor:t.editor},on:{activated:t.handleActivated,deactivated:t.handleDeactivated,change:t.handleChange,error:function(e){return t.$emit("error",arguments[0])}}},"vm-frame",t.frameOpts,!1),[t._t("frame-header"),t._v(" "),t._t("frame-footer")],2),t._v(" "),t.editor?n("vm-editor",{attrs:{"data-source":t.editor},on:{change:t.handleChange}}):t._e(),t._v(" "),t.showAssist?n("vm-assist-save",{on:{save:function(e){return t.handleOperate("save")},preview:function(e){return t.handleOperate("preview")}}}):t._e(),t._v(" "),t.showAssist?n("vm-assist-operation",{attrs:{current:t.current,total:t.total,"is-edit":!!t.editor},on:{undo:function(e){return t.handleOperate("undo")},redo:function(e){return t.handleOperate("redo")},delete:function(e){return t.handleOperate("delete")}}}):t._e()],1)};Cr._withStripped=!0;var Er=Ti({render:Cr,staticRenderFns:[]},void 0,wr,void 0,!1,void 0,void 0,void 0),Dr={name:"vm-grid-lines",components:{},props:{width:Number,height:Number,grid:{type:Array,default:function(){return[10,10]}}},data:function(){return{}},computed:{xArr:function(){var t=this,e=Math.floor(this.width/this.grid[0]);return Array.from({length:e},function(e,n){return n*t.grid[0]})},yArr:function(){var t=this,e=Math.floor(this.height/this.grid[1]);return Array.from({length:e},function(e,n){return n*t.grid[1]})}},watch:{},created:function(){},methods:{}},kr=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vm-grid-lines"},[this._l(this.yArr,function(t){return e("div",{key:"y_"+t,staticClass:"vm-grid-lines__y",style:{top:t+"px"}})}),this._v(" "),this._l(this.xArr,function(t){return e("div",{key:"x_"+t,staticClass:"vm-grid-lines__x",style:{left:t+"px"}})})],2)};kr._withStripped=!0;var $r=Ti({render:kr,staticRenderFns:[]},function(t){t&&t("data-v-3f506ed4_0",{source:".vm-grid-lines[data-v-3f506ed4] {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n.vm-grid-lines__x[data-v-3f506ed4] {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #d6d6d6;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.vm-grid-lines__y[data-v-3f506ed4] {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #d6d6d6;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/*# sourceMappingURL=grid-lines.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/grid-lines.vue","grid-lines.vue"],names:[],mappings:"AA4DA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;AC3DA;AD6DA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,0BAAA;EACA,8BAAA;UAAA,sBAAA;AC1DA;AD4DA;EACA,kBAAA;EACA,MAAA;EACA,WAAA;EACA,WAAA;EACA,qBAAA;EACA,wBAAA;EACA,yBAAA;EACA,8BAAA;UAAA,sBAAA;ACzDA;;AAEA,yCAAyC",file:"grid-lines.vue",sourcesContent:['<template>\n\t<div class="vm-grid-lines">\n\t\t<div \n\t\t\tv-for="item in yArr" \n\t\t\t:key="`y_${item}`" \n\t\t\t:style="{top: `${item}px`}"  \n\t\t\tclass="vm-grid-lines__y"\n\t\t/>\n\t\t<div \n\t\t\tv-for="item in xArr" \n\t\t\t:key="`x_${item}`" \n\t\t\t:style="{left: `${item}px`}"  \n\t\t\tclass="vm-grid-lines__x"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-grid-lines\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tgrid: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => {\n\t\t\t\treturn [10, 10];\n\t\t\t}\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t\txArr() {\n\t\t\tlet length = Math.floor(this.width / this.grid[0]);\n\t\t\treturn Array.from({ length }, (v, i) => i * this.grid[0]);\n\t\t},\n\t\tyArr() {\n\t\t\tlet length = Math.floor(this.height / this.grid[1]);\n\t\t\treturn Array.from({ length }, (v, i) => i * this.grid[1]);\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\n\t},\n};\n<\/script>\n\n<style lang="scss" scoped>\n.vm-grid-lines {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: hidden;\n\tz-index: 0;\n}\n.vm-grid-lines__x {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 1px;\n\theight: 100%;\n\tborder-left-width: 1px;\n\tborder-left-style: dotted;\n\tborder-left-color: rgb(214, 214, 214);\n\tbox-sizing: border-box;\n}\n.vm-grid-lines__y {\n\tposition: absolute;\n\ttop: 0;\n\twidth: 100%;\n\theight: 1px;\n\tborder-top-width: 1px;\n\tborder-top-style: dotted;\n\tborder-top-color: rgb(214, 214, 214); \n\tbox-sizing: border-box;\n}\n</style>\n',".vm-grid-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n\n.vm-grid-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #d6d6d6;\n  box-sizing: border-box;\n}\n\n.vm-grid-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #d6d6d6;\n  box-sizing: border-box;\n}\n\n/*# sourceMappingURL=grid-lines.vue.map */"]},media:void 0})},Dr,"data-v-3f506ed4",!1,void 0,Fi,void 0),Or={name:"vm-align-lines",components:{},props:{dataSource:{type:Array,default:function(){return[]}},editor:Object},data:function(){return{}},computed:{alignData:function(){var t=this;if(this.dataSource.length<=1||!this.editor)return{xArr:[],yArr:[]};var e=this.editor||{},n=e.x,i=e.y,r=e.w,a=e.h,o=[n,n+r/2,n+r],s=[i,i+a/2,i+a],d=this.dataSource.reduce(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.x,r=n.y,a=n.w,o=n.h;if(n.id!==t.editor.id){var s=[i,i+a/2,i+a],d=[r,r+o/2,r+o];e.xArr=[].concat(ir(e.xArr),s),e.yArr=[].concat(ir(e.yArr),d)}return e},{xArr:[],yArr:[]});return{xArr:o.filter(function(t){return d.xArr.includes(t)}),yArr:s.filter(function(t){return d.yArr.includes(t)})}}},watch:{},created:function(){},methods:{}},zr=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vm-align-lines"},[this._l(this.alignData.yArr,function(t){return e("div",{key:"y_"+t,staticClass:"vm-align-lines__y",style:{top:t+"px"}})}),this._v(" "),this._l(this.alignData.xArr,function(t){return e("div",{key:"x_"+t,staticClass:"vm-align-lines__x",style:{left:t+"px"}})})],2)};zr._withStripped=!0;var Sr=Ti({render:zr,staticRenderFns:[]},function(t){t&&t("data-v-1c8b90fd_0",{source:".vm-align-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n.vm-align-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #1fb6ff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.vm-align-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #1fb6ff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/*# sourceMappingURL=align-lines.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/align-lines.vue","align-lines.vue"],names:[],mappings:"AA+EA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;AC9EA;ADgFA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,0BAAA;EACA,8BAAA;UAAA,sBAAA;AC7EA;AD+EA;EACA,kBAAA;EACA,MAAA;EACA,WAAA;EACA,WAAA;EACA,qBAAA;EACA,wBAAA;EACA,yBAAA;EACA,8BAAA;UAAA,sBAAA;AC5EA;;AAEA,0CAA0C",file:"align-lines.vue",sourcesContent:['<template>\n\t<div class="vm-align-lines">\n\t\t<div \n\t\t\tv-for="item in alignData.yArr" \n\t\t\t:key="`y_${item}`" \n\t\t\t:style="{top: `${item}px`}"  \n\t\t\tclass="vm-align-lines__y"\n\t\t/>\n\t\t<div \n\t\t\tv-for="item in alignData.xArr" \n\t\t\t:key="`x_${item}`" \n\t\t\t:style="{left: `${item}px`}"  \n\t\t\tclass="vm-align-lines__x"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-align-lines\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([])\n\t\t},\n\t\teditor: Object\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t\talignData() {\n\t\t\tif (this.dataSource.length <= 1 || !this.editor) {\n\t\t\t\treturn {\n\t\t\t\t\txArr: [],\n\t\t\t\t\tyArr: []\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst { x, y, w, h } = this.editor || {};\n\t\t\tlet xArr = [x, x + w / 2, x + w];\n\t\t\tlet yArr = [y, y + h / 2, y + h];\n\n\t\t\tlet xyObj = this.dataSource.reduce((result, itemData = {}) => {\n\n\t\t\t\tconst { x, y, w, h, id } = itemData;\n\t\t\t\tif (id !== this.editor.id) {\n\t\t\t\t\tlet xArr = [x, x + w / 2, x + w];\n\t\t\t\t\tlet yArr = [y, y + h / 2, y + h];\n\t\t\t\t\tresult.xArr = [...result.xArr, ...xArr];\n\t\t\t\t\tresult.yArr = [...result.yArr, ...yArr];\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}, {\n\t\t\t\txArr: [],\n\t\t\t\tyArr: []\n\t\t\t});\n\t\t\treturn {\n\t\t\t\txArr: xArr.filter(item => xyObj.xArr.includes(item)),\n\t\t\t\tyArr: yArr.filter(item => xyObj.yArr.includes(item))\n\t\t\t};\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-align-lines {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: hidden;\n\tz-index: 0;\n}\n.vm-align-lines__x {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 1px;\n\theight: 100%;\n\tborder-left-width: 1px;\n\tborder-left-style: dotted;\n\tborder-left-color: #1fb6ff;\n\tbox-sizing: border-box;\n}\n.vm-align-lines__y {\n\tposition: absolute;\n\ttop: 0;\n\twidth: 100%;\n\theight: 1px;\n\tborder-top-width: 1px;\n\tborder-top-style: dotted;\n\tborder-top-color: #1fb6ff; \n\tbox-sizing: border-box;\n}\n</style>\n',".vm-align-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n\n.vm-align-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #1fb6ff;\n  box-sizing: border-box;\n}\n\n.vm-align-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #1fb6ff;\n  box-sizing: border-box;\n}\n\n/*# sourceMappingURL=align-lines.vue.map */"]},media:void 0})},Or,void 0,!1,void 0,Fi,void 0),jr={name:"vm-frame",components:{"vm-draggable":qi,"vm-grid-lines":$r,"vm-align-lines":Sr},props:{width:Number,height:Number,dataSource:Array,editor:Object},data:function(){return{}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}}},created:function(){},methods:{handleDragOver:function(t){},handleDragEnd:function(t){console.log(t)},handleDrop:function(t){var e=JSON.parse(t.dataTransfer.getData("@wya/vm"))||{},n=e.module,i=e.index,r=this.$parent.$options.modules[n];if(r)if(r.max&&r.max<=this.dataSource.filter(function(t){return t.module===n}).length)this.$emit("error",{type:"create",msg:"当前模块最多只能创建".concat(r.max,"个")});else{var a=this.$el.getBoundingClientRect(),o=a.x,s=a.y,d=t.pageX||t.clientX+doc.scrollLeft,l=t.pageY||t.clientY+doc.scrollTop,h=Yi(),c=this.dataSource.length,u=nr({},Ln("function"==typeof r.data?r.data(i):r.data),{module:n,id:h,x:d-o,y:l-s});this.dataSource.push(u),this.$emit("change",{type:"create",index:c,id:h}),this.setActived(c)}},handleEnd:function(t,e,n){this.$emit("change",{type:"update",id:e,index:n,old:t})},setActived:function(t){var e=this;this.$nextTick(function(){try{e.$refs.draggable[t].setActived()}catch(t){console.error(t)}})}}},Br=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-frame-draggable",staticStyle:{position:"relative"},style:t.style,on:{dragover:function(e){return e.preventDefault(),t.handleDragOver(e)},dragend:t.handleDragEnd,drop:t.handleDrop}},[n("vm-grid-lines",{attrs:{width:t.width,height:t.height,grid:[10,10]}}),t._v(" "),n("vm-align-lines",{attrs:{"data-source":t.dataSource,editor:t.editor}}),t._v(" "),t._l(t.dataSource,function(e,i){return n("vm-draggable",{key:e.id,ref:"draggable",refInFor:!0,attrs:{x:e.x,y:e.y,z:e.z,w:e.w,h:e.h,r:e.r,parent:e.parent,disabled:e.disabled,handles:e.handles,minw:e.minw,minh:e.minh,zoom:e.zoom,grid:e.grid,restrain:e.restrain,clearable:e.clearable},on:{"update:x":function(n){return t.$set(e,"x",n)},"update:y":function(n){return t.$set(e,"y",n)},"update:z":function(n){return t.$set(e,"z",n)},"update:w":function(n){return t.$set(e,"w",n)},"update:h":function(n){return t.$set(e,"h",n)},"update:r":function(n){return t.$set(e,"r",n)},activated:function(n){return t.$emit("activated",e)},deactivated:function(n){return t.$emit("deactivated",e)},dragging:function(n){return t.$emit("dragging",e)},resizing:function(n){return t.$emit("resizing",e)},rotating:function(n){return t.$emit("rotating",e)},"resize-end":function(n){return t.$emit("resize-end",e)},"drag-end":function(n){return t.$emit("drag-end",e)},delete:function(n){return t.$emit("change",{type:"delete",id:e.id})},end:function(n){return t.handleEnd(arguments[0],e.id,i)}}},[n("vm-"+e.module+"-viewer",t._b({tag:"component"},"component",e,!1))],1)})],2)};Br._withStripped=!0;var Mr=Ti({render:Br,staticRenderFns:[]},void 0,jr,void 0,!1,void 0,void 0,void 0),Yr={name:"vm-frame",components:{"vm-sortable":Qi},props:{width:Number,height:Number,dataSource:Array,editor:Object},data:function(){return{dragType:"@wya/vm"}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}}},created:function(){this.eleDrag=null},methods:{handleHighlightChange:function(t,e){},handleDragOver:function(t){},handleDragEnd:function(t){},handleDrop:function(t){var e=this.dataSource.length;this.$refs.sort&&this.$refs.sort.forEach(function(t,n){!0===t.highlight&&(e=n+1,t.highlight=!1)});var n=JSON.parse(t.dataTransfer.getData("@wya/vm"))||{},i=n.module,r=n.index,a=this.$parent.$options.modules[i];if(a)if(a.max&&a.max<=this.dataSource.filter(function(t){return t.module===i}).length)this.$emit("error",{type:"create",msg:"当前模块最多只能创建".concat(a.max,"个")});else{var o=Yi(),s=nr({},Ln("function"==typeof a.data?a.data(r):a.data),{module:i,id:o});this.dataSource.splice(e,0,s),this.$emit("change",{type:"create",index:e,id:o}),this.setActived(e)}},setActived:function(t){var e=this;this.$nextTick(function(){try{e.$refs.sort[t].setActived()}catch(t){console.error(t)}})},handleSort:function(t){this.sortData(t)},handleSortEnd:function(t){t[1]!=t[2]&&this.$emit("change",{type:"sort",sort:t})},sortData:function(t){var e=this.dataSource[t[0]],n=this.dataSource[t[1]];this.dataSource.splice(t[0],1,n),this.dataSource.splice(t[1],1,e)}}},Nr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-frame-sortable",style:t.style,on:{dragover:function(e){return e.preventDefault(),t.handleDragOver(e)},dragend:t.handleDragEnd,drop:t.handleDrop}},[n("transition-group",{attrs:{tag:"div",name:"flip-list"}},t._l(t.dataSource,function(e,i){return n("div",{key:e.id,staticClass:"vm-frame-sortable__item"},[n("vm-sortable",{ref:"sort",refInFor:!0,attrs:{index:i,type:t.dragType,clearable:e.clearable},on:{activated:function(n){return t.$emit("activated",e,i)},deactivated:function(n){return t.$emit("deactivated",e,i)},delete:function(n){return t.$emit("change",{type:"delete",id:e.id})},"highlight-change":function(e){return t.handleHighlightChange(arguments[0],i)},sort:t.handleSort,"sort-end":t.handleSortEnd}},[n("vm-"+e.module+"-viewer",t._b({tag:"component",staticStyle:{"min-height":"3px"}},"component",e,!1))],1)],1)}),0)],1)};Nr._withStripped=!0;var Xr={Draggable:Mr,Sortable:Ti({render:Nr,staticRenderFns:[]},function(t){t&&t("data-v-3d22dd7e_0",{source:".vm-frame-sortable__item {\n  -webkit-transition: all 0.5s;\n  transition: all 0.5s;\n}\n.flip-list-enter,\n.flip-list-leave-to {\n  opacity: 0;\n}\n.flip-list-leave-active {\n  display: none;\n}\n\n/*# sourceMappingURL=frame.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/sortable/frame.vue","frame.vue"],names:[],mappings:"AAyKA;EACA,4BAAA;EAAA,oBAAA;ACxKA;AD2KA;;EAEA,UAAA;ACxKA;AD0KA;EACA,aAAA;ACvKA;;AAEA,oCAAoC",file:"frame.vue",sourcesContent:['<template>\n\t<div \n\t\t:style="style" \n\t\tclass="vm-frame-sortable"\n\t\t@dragover.prevent="handleDragOver" \n\t\t@dragend="handleDragEnd"\n\t\t@drop="handleDrop"\n\t>\n\t\t<transition-group tag="div" name="flip-list">\n\t\t\t<div v-for="(it, index) in dataSource" :key="it.id" class="vm-frame-sortable__item">\n\t\t\t\t\x3c!-- TODO: 不操作引用修改 --\x3e\n\t\t\t\t<vm-sortable\n\t\t\t\t\tref="sort"\n\t\t\t\t\t:index="index"\n\t\t\t\t\t:type="dragType"\n\t\t\t\t\t:clearable="it.clearable"\n\t\t\t\t\t@activated="$emit(\'activated\', it, index)"\n\t\t\t\t\t@deactivated="$emit(\'deactivated\', it, index)"\n\t\t\t\t\t@delete="$emit(\'change\', { type: \'delete\', id: it.id })"\n\t\t\t\t\t@highlight-change="handleHighlightChange(arguments[0], index)"\n\t\t\t\t\t@sort="handleSort"\n\t\t\t\t\t@sort-end="handleSortEnd"\n\t\t\t\t>\n\t\t\t\t\t<component \n\t\t\t\t\t\t:is="`vm-${it.module}-viewer`" \n\t\t\t\t\t\tv-bind="it" \n\t\t\t\t\t\tstyle="min-height: 3px"\n\t\t\t\t\t/>\n\t\t\t\t</vm-sortable>\n\t\t\t</div>\n\t\t</transition-group>\n\t</div>\n</template>\n\n<script>\nimport Sortable from \'../../../core/sortable.vue\';\nimport { getUid, cloneDeep } from \'../../../utils/helper\';\nimport { SORT_IN_FRAME, WIDGET_TO_FRAME } from \'../../constants\';\n\nexport default {\n\tname: \'vm-frame\',\n\tcomponents: {\n\t\t\'vm-sortable\': Sortable,\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tdataSource: Array,\n\t\teditor: Object\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdragType: SORT_IN_FRAME\n\t\t};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = this.width === 0 ? \'auto\' : `${this.width}px`;\n\t\t\tconst h = this.height === 0 ? \'auto\' : `${this.height}px`;\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.eleDrag = null;\n\t},\n\tmethods: {\n\t\thandleHighlightChange(status, index) {\n\t\t\t// console.log(status, index);\n\t\t},\n\t\thandleDragOver(e) {\n\t\t},\n\t\thandleDragEnd(e) {\n\t\t},\n\t\thandleDrop(e) {\n\t\t\tlet rowIndex = this.dataSource.length;\n\t\t\t/**\n\t\t\t * 清理高亮, 设置插入位置\n\t\t\t */\n\t\t\tif (this.$refs.sort) {\n\t\t\t\tthis.$refs.sort.forEach((instance, index) => {\n\t\t\t\t\tif (instance.highlight === true) {\n\t\t\t\t\t\trowIndex = index + 1;\n\t\t\t\t\t\tinstance.highlight = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet { module, index } = JSON.parse(e.dataTransfer.getData(WIDGET_TO_FRAME)) || {};\n\t\t\tlet result = this.$parent.$options.modules[module];\n\t\t\t// 不存在的模块\n\t\t\tif (!result) return;\n\n\t\t\tif (result.max && result.max <= this.dataSource.filter(i => i.module === module).length) {\n\t\t\t\tthis.$emit(\'error\', {\n\t\t\t\t\ttype: \'create\',\n\t\t\t\t\tmsg: `当前模块最多只能创建${result.max}个`\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet id = getUid();\n\n\t\t\tlet data = {\n\t\t\t\t...cloneDeep(\n\t\t\t\t\ttypeof result.data === \'function\' \n\t\t\t\t\t\t? result.data(index) \n\t\t\t\t\t\t: result.data\n\t\t\t\t),\n\t\t\t\tmodule,\n\t\t\t\tid,\n\t\t\t};\n\n\t\t\t// 会同步到上级 这里不用this.$emit("update:sync")\n\t\t\tthis.dataSource.splice(rowIndex, 0, data);\n\n\t\t\tthis.$emit(\'change\', { \n\t\t\t\ttype: \'create\', \n\t\t\t\tindex: rowIndex,\n\t\t\t\tid\n\t\t\t});\n\n\t\t\t// 新元素处于激活状态\n\t\t\tthis.setActived(rowIndex);\n\t\t},\n\t\tsetActived(index) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\ttry {\n\t\t\t\t\tthis.$refs.sort[index].setActived();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * 交换位置\n\t\t */\n\t\thandleSort(v) {\n\t\t\tthis.sortData(v);\n\t\t},\n\n\n\t\thandleSortEnd(v) {\n\t\t\tif (v[1] != v[2]) {\n\t\t\t\tthis.$emit(\'change\', {\n\t\t\t\t\ttype: \'sort\',\n\t\t\t\t\tsort: v\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 外部使用\n\t\t */\n\t\t\n\t\tsortData(v) {\n\t\t\tlet current = this.dataSource[v[0]];\n\t\t\tlet target = this.dataSource[v[1]];\n\t\t\tthis.dataSource.splice(v[0], 1, target);\n\t\t\tthis.dataSource.splice(v[1], 1, current);\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-frame-sortable__item {\n\ttransition: all .5s;\n}\n// 开始消失/进入的元素\n.flip-list-enter, \n.flip-list-leave-to{\n\topacity: 0;\n}\n.flip-list-leave-active {\n\tdisplay: none;\n}\n</style>\n',".vm-frame-sortable__item {\n  transition: all 0.5s;\n}\n\n.flip-list-enter,\n.flip-list-leave-to {\n  opacity: 0;\n}\n\n.flip-list-leave-active {\n  display: none;\n}\n\n/*# sourceMappingURL=frame.vue.map */"]},media:void 0})},Yr,void 0,!1,void 0,Fi,void 0)},Rr={name:"vm-widget",components:{"vm-assist-customer":xr.Customer},props:{width:Number,height:Number,type:{type:String,default:"free"},dataSource:Array},data:function(){var t=this.$parent.$options.modules,e={};for(var n in t)if(ji(t,n)){var i=t[n],r=i.type||"undefined";e[r]||(e[r]=[]),e[r].push({module:i.module,component:i.Widget||i.name,widgets:i.widgets,draggable:!i.widgets&&i.Viewer&&i.Editor,active:!1})}return{toolsList:e,showTip:!0,currentTab:Object.keys(e)[0]}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}}},created:function(){},methods:{handleStart:function(t,e,n){t.dataTransfer.setData("@wya/vm",JSON.stringify({module:e,index:n}))},handleEvent:function(t){var e=this;return{change:function(){for(var n=arguments,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=n[a];return e.$emit.apply(e,["change",t].concat(r))}}}}},Ur=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-widget",style:t.style},[n("div",{staticClass:"vm-widget__wrapper"},[n("p",{staticClass:"vm-widget__header"},[t._v("组件库")]),t._v(" "),t.showTip?n("div",{staticClass:"vm-widget__tip",on:{click:function(e){t.showTip=!t.showTip}}},[n("p",[t._v("拖拽添加组件，点击修改样式")]),t._v(" "),n("span",[t._v("✕")])]):t._e(),t._v(" "),n("div",{staticClass:"vm-widget__tabs"},t._l(t.toolsList,function(e,i){return"undefined"!==i?n("p",{key:i,class:{"is-active":t.currentTab==i},on:{click:function(e){t.currentTab=i}}},[t._v(t._s(i))]):t._e()}),0),t._v(" "),t._l(t.toolsList[t.currentTab],function(e){return n("div",{key:e.module,attrs:{draggable:e.draggable},on:{dragstart:function(n){e.draggable&&t.handleStart(n,e.module)}}},[n("div",{staticClass:"vm-widget__title",class:{"is-active":e.active,"is-draggable":e.draggable,"is-click":e.widgets},on:{click:function(t){e.widgets&&(e.active=!e.active)}}},["string"==typeof e.component?n("p",{domProps:{innerHTML:t._s(e.component)}}):n("vm-"+e.module+"-widget",t._g({tag:"component"},t.handleEvent(e.module))),t._v(" "),e.widgets?n("div",{staticClass:"vm-widget__arrow"}):t._e()],1),t._v(" "),e.active?n("div",{staticClass:"vm-widget__combo"},t._l(e.widgets,function(i,r){return n("div",{key:r,staticClass:"vm-widget__item",attrs:{draggable:""},on:{dragstart:function(n){return t.handleStart(n,e.module,r)}}},[i.render?[n("vm-assist-customer",{attrs:{render:i.render,index:r}})]:[n("img",{attrs:{src:i.image}}),t._v(" "),n("p",[t._v(t._s(i.name))])]],2)}),0):t._e()])})],2)])};Ur._withStripped=!0;var Tr=Ti({render:Ur,staticRenderFns:[]},void 0,Rr,void 0,!1,void 0,void 0,void 0),Wr={name:"vm-editor",components:{},props:{dataSource:Object},data:function(){return{}},computed:{},created:function(){},methods:{handleChange:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"===Zi(e))for(var n in e){var i=e[n];["x","y","z","r","w","h"].includes(n)&&(i=Number(i)),ji(e,n)&&(t=i)==t&&(this.$emit("change",{type:"update",id:this.dataSource.id,old:er({},n,i)}),this.$refs.target.$emit("update:".concat(n),i))}}}},Ir=function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"vm-editor vm-hack-editor"},[e("div",{staticClass:"vm-editor-wrapper"},[e("div",{staticClass:"vm-editor__arrow"}),this._v(" "),e("vm-"+this.dataSource.module+"-editor",this._b({ref:"target",tag:"component",on:{change:this.handleChange}},"component",this.dataSource,!1,!0))],1)])};Ir._withStripped=!0;var Pr=Ti({render:Ir,staticRenderFns:[]},void 0,Wr,void 0,!1,void 0,void 0,void 0),Fr={name:"vm-tools-preview",components:{},props:{dataSource:Array,mode:String},data:function(){return{}},computed:{isDraggable:function(){return"draggable"===this.mode}}},Lr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-tools-preview"},[n("div",{staticStyle:{position:"relative"}},t._l(t.dataSource,function(e){return n("div",{key:e.id,style:t.isDraggable?{position:"absolute",width:e.w?e.w+"px":"auto",height:e.h?e.h+"px":"auto",left:e.x+"px",top:e.y+"px",transform:"rotate("+e.r+"deg)"}:{}},[n("vm-"+e.module+"-viewer",t._b({tag:"component"},"component",e,!1))],1)}),0)])};Lr._withStripped=!0;var Hr=Ti({render:Lr,staticRenderFns:[]},void 0,Fr,void 0,!1,void 0,void 0,void 0),qr={name:"vm-preview",components:{},props:{dataSource:Array,css:{type:Object,default:function(){return{style:{},className:""}}},animate:{type:String,default:"vm-fade"},mask:{type:Boolean,default:!0},mode:{type:String,default:"draggable"}},data:function(){return{visible:!1,transform:"translate(-100px, -100px)"}},computed:{isDraggable:function(){return"draggable"===this.mode}},watch:{},mounted:function(){this.visible=!0},updated:function(){},methods:{handleClose:function(){var t=this;this.visible=!1,setTimeout(function(){t.$emit("close")},300)}}},Vr=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"vm-tools-preview-popup"},[t.mask?n("transition",{attrs:{name:t.animate}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-tools-preview-popup__mask",on:{click:t.handleClose}})]):t._e(),t._v(" "),t.mask?n("transition",{attrs:{name:t.animate}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-tools-preview-popup__close",on:{click:t.handleClose}},[t._v("✕")])]):t._e(),t._v(" "),n("transition",{attrs:{name:t.animate}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-tools-preview-popup__content"},[n("vm-tools-preview",{attrs:{"data-source":t.dataSource,mode:t.mode}})],1)])],1)};Vr._withStripped=!0;var Gr=Ti({render:Vr,staticRenderFns:[]},function(t){t&&t("data-v-bde478fc_0",{source:".vm-tools-preview-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 999;\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.vm-tools-preview-popup__mask {\n  position: absolute;\n  z-index: 997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, .2);\n  -webkit-transition: opacity 0.2s;\n  transition: opacity 0.2s;\n}\n.vm-tools-preview-popup__content {\n  position: relative;\n  z-index: 998;\n  overflow: auto;\n  max-height: 100vh;\n  max-width: 100vw;\n  -webkit-transition: opacity 0.2s, -webkit-transform 0.2s;\n  transition: opacity 0.2s, -webkit-transform 0.2s;\n  transition: transform 0.2s, opacity 0.2s;\n  transition: transform 0.2s, opacity 0.2s, -webkit-transform 0.2s;\n}\n.vm-tools-preview-popup__close {\n  position: absolute;\n  right: 30px;\n  top: 30px;\n  font-size: 24px;\n  z-index: 999;\n}\n.vm-fade-enter, .vm-fade-leave-active {\n  opacity: 0;\n}\n\n/*# sourceMappingURL=popup.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/preview/popup.vue","popup.vue"],names:[],mappings:"AAwEA;EACA,eAAA;EACA,MAAA;EACA,QAAA;EACA,OAAA;EACA,SAAA;EACA,YAAA;EACA,oBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;MAAA,qBAAA;UAAA,uBAAA;ACvEA;ADyEA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,mCAAA;EAEA,gCAAA;EAAA,wBAAA;ACvEA;ADyEA;EACA,kBAAA;EACA,YAAA;EACA,cAAA;EACA,iBAAA;EACA,gBAAA;EACA,wDAAA;EAAA,gDAAA;EAAA,wCAAA;EAAA,gEAAA;ACtEA;ADwEA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;EACA,eAAA;EACA,YAAA;ACrEA;ADuEA;EACA,UAAA;ACpEA;;AAEA,oCAAoC",file:"popup.vue",sourcesContent:['<template>\n\t<div class="vm-tools-preview-popup">\n\t\t<transition v-if="mask" :name="animate" >\n\t\t\t<div v-show="visible" class="vm-tools-preview-popup__mask" @click="handleClose" />\n\t\t</transition>\n\t\t<transition v-if="mask" :name="animate" >\n\t\t\t<div v-show="visible" class="vm-tools-preview-popup__close" @click="handleClose">&#10005;</div>\n\t\t</transition>\n\t\t<transition :name="animate">\n\t\t\t<div v-show="visible" class="vm-tools-preview-popup__content">\n\t\t\t\t<vm-tools-preview :data-source="dataSource" :mode="mode"/>\n\t\t\t</div>\n\t\t</transition>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-preview\',\n\tcomponents: {\n\t\t\n\t},\n\tprops: {\n\t\tdataSource: Array,\n\t\tcss: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({ style: {}, className: "" })\n\t\t},\n\t\tanimate: {\n\t\t\ttype: String,\n\t\t\tdefault: \'vm-fade\'\n\t\t},\n\t\tmask: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\tdefault: \'draggable\'\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvisible: false,\n\t\t\ttransform: `translate(-100px, -100px)`\n\t\t};\n\t},\n\tcomputed: {\n\t\tisDraggable() {\n\t\t\treturn this.mode === \'draggable\';\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tmounted() {\n\t\tthis.visible = true;\n\t},\n\tupdated() {\n\t},\n\tmethods: {\n\t\thandleClose() {\n\t\t\tthis.visible = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$emit(\'close\');\n\t\t\t}, 300); // 动画时间\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-tools-preview-popup {\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tleft: 0;\n\tbottom: 0;\n\tz-index: 999;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n.vm-tools-preview-popup__mask {\n\tposition: absolute;\n\tz-index: 997;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(#000, 0.2);\n\t// opacity: 0;\n\ttransition: opacity 0.2s;\n}\n.vm-tools-preview-popup__content {\n\tposition: relative;\n\tz-index: 998;\n\toverflow: auto; // 区域之外不形式\n\tmax-height: 100vh; \n\tmax-width: 100vw; \n\ttransition: transform 0.2s, opacity 0.2s;\n}\n.vm-tools-preview-popup__close {\n\tposition: absolute;\n\tright: 30px; \n\ttop: 30px;\n\tfont-size: 24px;\n\tz-index: 999;\n}\n.vm-fade-enter, .vm-fade-leave-active {\n\topacity: 0;\n}\n</style>\n',".vm-tools-preview-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.vm-tools-preview-popup__mask {\n  position: absolute;\n  z-index: 997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.2);\n  transition: opacity 0.2s;\n}\n\n.vm-tools-preview-popup__content {\n  position: relative;\n  z-index: 998;\n  overflow: auto;\n  max-height: 100vh;\n  max-width: 100vw;\n  transition: transform 0.2s, opacity 0.2s;\n}\n\n.vm-tools-preview-popup__close {\n  position: absolute;\n  right: 30px;\n  top: 30px;\n  font-size: 24px;\n  z-index: 999;\n}\n\n.vm-fade-enter, .vm-fade-leave-active {\n  opacity: 0;\n}\n\n/*# sourceMappingURL=popup.vue.map */"]},media:void 0})},qr,void 0,!1,void 0,Fi,void 0),Kr=document.body,Jr=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ToolsPreview=e,this.mode=n,this.vm=null,this.show=this.show.bind(this),this.hide=this.hide.bind(this)}var e,n,i;return e=t,(n=[{key:"show",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=document.createElement("div"),i=r.extend(Ln(nr({},Gr,{components:{"vm-tools-preview":this.ToolsPreview}})));return this.vm&&this.vm.$emit("close"),this.vm=new i({el:n,propsData:nr({},e,{mode:this.mode})}),this.vm.$on("close",function(){t.vm.$destroy(),Kr.removeChild(t.vm.$el)}),Kr.appendChild(this.vm.$el),this.vm}},{key:"hide",value:function(){this.vm&&this.vm.$emit("close")}}])&&tr(e.prototype,n),i&&tr(e,i),t}();e.Draggable=qi,e.Sortable=Qi,e.createVMDrags=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fr,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.mode,i=void 0===n?"draggable":n;try{var r=Ln(e.Combo||Er),a=Ln(e.Frame||("draggable"===i?Xr.Draggable:Xr.Sortable)),o=Ln(e.Widget||Tr),s=Ln(e.Preview||Hr),d=Ln(e.Editor||Pr),l={},h={},c={};Object.keys(t).forEach(function(e,n){var i=t[e],r=i.Viewer,a=i.Editor,o=i.Widget;l["vm-".concat(e,"-viewer")]=r,h["vm-".concat(e,"-editor")]=a,c["vm-".concat(e,"-widget")]=o}),r.modules=t,r.viewers=l,r.editors=h,a.components=nr({},a.components,l),d.components=nr({},d.components,h),o.components=nr({},o.components,c),r.components=nr({},r.components,{"vm-frame":a,"vm-editor":d,"vm-widget":o}),s.components=nr({},s.components,l);var u=Ln(r),A=Ln(s),p=new Jr(s,i);return u.previewManager=p,A.show=p.show,A.hide=p.hide,{Combo:u,Preview:A}}catch(t){throw console.error("[wya-vm/register]",t),new Error(t)}}}).call(this,n("./node_modules/webpack/buildin/global.js"))}}]);