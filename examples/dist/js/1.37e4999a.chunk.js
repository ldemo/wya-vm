(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"./src/libs/vm.min.js":function(t,n,e){"use strict";function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t){return t&&"object"===i(t)&&"default"in t?t.default:t}Object.defineProperty(n,"__esModule",{value:!0});var a=e("./node_modules/lodash/lodash.js"),s=r(e("./node_modules/@babel/runtime/helpers/defineProperty.js")),o=r(e("./node_modules/@babel/runtime/helpers/toConsumableArray.js")),l=e("./node_modules/@wya/utils/lib/index.js"),d=r(e("./node_modules/@wya/vc/lib/customer/index.js")),A=r(e("./node_modules/@wya/vc/lib/portal/index.js")),c=r(e("./node_modules/@wya/vc/lib/slider/index.js")),m=r(e("./node_modules/@wya/vc/lib/select/index.js")),h=r(e("./node_modules/@wya/vc/lib/option/index.js")),p=e("./node_modules/@wya/vc/lib/clipboard/utils.js"),u=r(e("./node_modules/@babel/runtime/helpers/typeof.js")),g=function(){var t=!1;try{var n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,n)}catch(t){console.log(t)}return t}(),f=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},v=+new Date,b=0,x=function(){return"vm-".concat(v,"-").concat(++b)},y=function(t){return t!=t},w=function(t,n){for(var e in n)if(n[e].test(t[e]))return!0;return!1},E=document.documentElement,C=[0,45,90,135,180,225,270,315,360],_={start:["touchstart","mousedown"],move:["touchmove","mousemove"],end:["touchend","touchcancel","mouseup"]},$={replace:!0,name:"vm-draggable",props:{handles:{type:Array,default:function(){return["top","right","bottom","left","top-left","top-right","bottom-right","bottom-left","rotate"]}},w:{type:Number,default:0,validator:function(t){return t>=0}},h:{type:Number,default:0,validator:function(t){return t>=0}},r:{type:Number,default:0},minW:{type:Number,default:36,validator:function(t){return t>0}},minH:{type:Number,default:36,validator:function(t){return t>0}},x:{type:Number,default:0},y:{type:Number,default:0},z:{type:Number,default:1},scale:{type:Number,default:1},grid:{type:Array,default:function(){return[1,1]}},guides:{type:Array,default:function(){return[[],[]]}},restrain:{type:Number,default:0},parent:{type:Boolean,default:!1},entryRegExp:{type:Object,default:function(){return{className:/vm-hack-entry/,id:/^(app|pages)$/}}},editorRegExp:{type:Object,default:function(){return{className:/vm-hack-editor/}}},prevent:{type:Boolean,default:!0},preventRegExp:{type:Object,default:function(){return{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT|OPTION)$/,className:/vm-hack-pevent/}}},module:{type:String},disabled:{type:Boolean,default:!1},closeable:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},resizable:{type:Boolean,default:!0},rotatable:{type:Boolean,default:!0},active:{type:Boolean,default:!1},offset:{type:Array,default:function(){return[0,0]}}},data:function(){return{isResizing:!1,isDraging:!1,isRotating:!1,isChanging:!1,isActive:!1}},computed:{coord:function(){return{left:this.x+"px",top:this.y+"px",zIndex:this.isActive&&"page"!==this.module?999:this.z}},style:function(){return{width:0===this.w?"auto":"".concat(this.w,"px"),height:0===this.h?"auto":"".concat(this.h,"px"),transform:"rotate(".concat(this.r,"deg)")}},width:function(){var t=Math.floor(1.15*Math.sqrt(this.w*this.w+this.h*this.h));return"".concat(t,"px")},realHandles:function(){var t=this.handles;return this.rotatable||(t=t.filter((function(t){return"rotate"!==t}))),this.resizable||(t=t.filter((function(t){return"rotate"===t}))),t}},watch:{},beforeCreate:function(){this.parentX=0,this.parentY=0,this.parentW=9999,this.parentH=9999,this.mouseX=0,this.mouseY=0,this.lastMouseX=0,this.lastMouseY=0,this.mouseOffX=0,this.mouseOffY=0,this.handle=null,this.eventOpts=!g||{capture:!0,passive:!0},this.beforeStatus=null},mounted:function(){var t=this;this.w&&this.minW>this.w&&this.sync({w:this.minW}),this.h&&this.minH>this.h&&this.sync({h:this.minH}),this.$nextTick((function(){var n=t.$el.parentNode.getBoundingClientRect(),e=n.x,i=n.y;t.parentX=e+t.offset[0],t.parentY=i+t.offset[1],t.parent&&t.calculation(),t.$emit("resizing")}))},destroyed:function(){this.operateDOMEvents("remove")},methods:{calculation:function(){var t=this.$el.parentNode.getBoundingClientRect(),n=t.width,e=t.height;if(!n||!e)throw new Error("@wya/vm: 父层容器宽度计算异常");this.parentW=n,this.parentH=e,this.w>this.parentW&&this.sync({w:this.parentW}),this.h>this.parentH&&this.sync({h:this.parentH}),this.x+this.w>this.parentW&&this.sync({x:this.parentW-this.w}),this.y+this.h>this.parentH&&this.sync({y:this.parentH-this.h})},sync:function(t){for(var n in t)this[n]!=t[n]&&(!this.beforeStatus&&(this.beforeStatus={x:this.x,y:this.y,z:this.z,w:this.w,r:this.r}),this.$emit("update:".concat(n),t[n]))},operateDOMEvents:function(t){var n=this,e="add"===t?E.addEventListener:E.removeEventListener;_.start.forEach((function(t){e(t,n.handleDeselect,n.eventOpts)})),_.move.forEach((function(t){e(t,n.handleMove,n.eventOpts)})),_.end.forEach((function(t){e(t,n.handleUp,n.eventOpts)}))},setActived:function(){this.handleContainerDown(),this.handleUp()},handleContainerDown:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.prevent&&t.preventDefault&&!w(t.target,this.preventRegExp)&&t.preventDefault(),!this.disabled){var n=t.target||t.srcElement;if(!n||this.$el.contains(n)){if(!this.isActive){var e=this.getPositionByEvent(t),i=e.mousePositionX,r=e.mousePositionY;this.lastMouseX=i+E.scrollLeft,this.lastMouseY=r+E.scrollTop,this.operateDOMEvents("add"),this.isActive=!0,this.$emit("activated")}this.draggable&&(this.isDraging=!0)}}},handleDeselect:function(t){var n=this,e=this.getPositionByEvent(t),i=e.mousePositionX,r=e.mousePositionY;this.mouseX=i+E.scrollLeft,this.mouseY=r+E.scrollTop,this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY;var a=t.target||t.srcElement,s=t.path||t.composedPath&&t.composedPath()||[];!s.some((function(t){return w(t,n.entryRegExp)}))||this.$el.contains(a)||w(a,{className:/is-([(top|right|-|bottom|left)]{2})/})||s.some((function(t){return w(t,n.editorRegExp)}))||this.isActive&&(this.operateDOMEvents("remove"),this.isActive=!1,this.$emit("deactivated",t))},handleDown:function(t,n){this.prevent&&t.preventDefault&&!w(t.target,this.preventRegExp)&&t.preventDefault(),this.handle=n,"rotate"===n?this.rotatable&&(this.isRotating=!0):this.resizable&&(this.isResizing=!0);var e=this.getPositionByEvent(t),i=e.mousePositionX,r=e.mousePositionY;this.preMouseX=i+E.scrollLeft,this.preMouseY=r+E.scrollTop},handleMove:function(t){var n=this.getPositionByEvent(t),e=n.mousePositionX,i=n.mousePositionY;this.mouseX=e+E.scrollLeft,this.mouseY=i+E.scrollTop;var r=parseInt(this.x,10),a=parseInt(this.y,10),s=parseInt(this.w,10),o=parseInt(this.h,10),l=Math.round((this.mouseX-this.parentX+this.offset[0])/this.scale),d=Math.round((this.mouseY-this.parentY+this.offset[1])/this.scale),A=l-Math.round((this.lastMouseX-this.parentX+this.offset[0])/this.scale),c=d-Math.round((this.lastMouseY-this.parentY+this.offset[1])/this.scale);if(this.lastMouseX=this.mouseX,this.lastMouseY=this.mouseY,this.isResizing)this.handle.includes("top")&&(a-d+o<this.minH?d=a+o-this.minH:this.parent&&d<0&&(d=0),o=a+o-d,a=d),this.handle.includes("bottom")&&(d-a<this.minH?d=a+this.minH:this.parent&&d>this.parentH/this.scale&&(d=Math.round(this.parentH/this.scale)),o=d-a),this.handle.includes("left")&&(r-l+s<this.minW?l=r+s-this.minW:this.parent&&l<0&&(l=0),s=r+s-l,r=l),this.handle.includes("right")&&(l-r<this.minW?l=r+this.minW:this.parent&&l>this.parentW/this.scale&&(l=Math.round(this.parentW/this.scale)),s=l-r),!this.disabled&&this.sync({x:Math.round(r/this.grid[0])*this.grid[0],y:Math.round(a/this.grid[1])*this.grid[1],w:Math.round(s/this.grid[0])*this.grid[0],h:Math.round(o/this.grid[1])*this.grid[1]}),this.$emit("resizing");else if(this.isRotating){var m=this.getAngle([this.parentX+this.x+this.w/2,-(this.parentY+this.y+this.h/2)],[this.lastMouseX+this.offset[0],-(this.lastMouseY+this.offset[1])]),h=C.find((function(t){return Math.abs(t-m)<3}));m="number"==typeof h?h:m,!this.disabled&&this.sync({r:360===m?0:m}),this.$emit("rotating")}else if(this.isDraging){var p=this.guides[0]&&this.guides[0].find((function(t){return Math.abs(r+A-t)<3})),u=this.guides[0]&&this.guides[0].find((function(t){return Math.abs(r+A+s-t)<2})),g=this.guides[1]&&this.guides[1].find((function(t){return Math.abs(a+c-t)<3})),f=this.guides[1]&&this.guides[1].find((function(t){return Math.abs(a+c+o-t)<2}));p&&(A=p-r),u&&(A=u-r-s),g&&(c=g-a),f&&(c=f-a-o),this.parent&&((r+A<0||r+A+s>this.parentW/this.scale)&&(A=0),(a+c<0||a+c+o>this.parentH/this.scale)&&(c=0)),r+=A,a+=c,!this.disabled&&this.sync({x:Math.round(r/this.grid[0])*this.grid[0],y:Math.round(a/this.grid[1])*this.grid[1]}),this.$emit("dragging")}!this.isChanging&&(this.isRotating||this.isDraging||this.isResizing)&&(this.isChanging=!0)},getAngle:function(t,n){var e=n[0]-t[0],i=n[1]-t[1],r=360*Math.atan2(i,e)/(2*Math.PI);return r=r>90?450-r:90-r,Math.floor(r)},getRestrain:function(t){var n=this.restrain;return(t/n).toFixed(0)*n},getPositionByEvent:function(t){return{mousePositionX:(t.targetTouches?t.targetTouches[0].pageX:t.clientX)||0,mousePositionY:(t.targetTouches?t.targetTouches[0].pageY:t.clientY)||0}},handleUp:function(t){this.isChanging=!1,this.handle=null;var n=this.restrain;n&&n>0&&this.sync({x:this.getRestrain(this.x),y:this.getRestrain(this.y),w:this.getRestrain(this.w),h:this.getRestrain(this.h)}),this.isRotating&&(this.isRotating=!1,this.$emit("rotate-end")),this.isResizing&&(this.isResizing=!1,this.$emit("resize-end")),this.isDraging&&(this.isDraging=!1,this.$emit("drag-end")),this.beforeStatus&&(this.$emit("end",this.beforeStatus),this.beforeStatus=null)}}};var B,k=function(t,n,e,i,r,a,s,o,l,d){"boolean"!=typeof s&&(l=o,o=s,s=!1);var A,c="function"==typeof e?e.options:e;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),i&&(c._scopeId=i),a?(A=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=A):n&&(A=s?function(){n.call(this,d(this.$root.$options.shadowRoot))}:function(t){n.call(this,o(t))}),A)if(c.functional){var m=c.render;c.render=function(t,n){return A.call(n),m(t,n)}}else{var h=c.beforeCreate;c.beforeCreate=h?[].concat(h,A):[A]}return e},D="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());var S={};var M=function(t){return function(t,n){return function(t,n){var e=D?n.media||"default":t,i=S[e]||(S[e]={ids:new Set,styles:[]});if(!i.ids.has(t)){i.ids.add(t);var r=n.source;if(n.map&&(r+="\n/*# sourceURL="+n.map.sources[0]+" */",r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n.map))))+" */"),i.element||(i.element=document.createElement("style"),i.element.type="text/css",n.media&&i.element.setAttribute("media",n.media),void 0===B&&(B=document.head||document.getElementsByTagName("head")[0]),B.appendChild(i.element)),"styleSheet"in i.element)i.styles.push(r),i.element.styleSheet.cssText=i.styles.filter(Boolean).join("\n");else{var a=i.ids.size-1,s=document.createTextNode(r),o=i.element.childNodes;o[a]&&i.element.removeChild(o[a]),o.length?i.element.insertBefore(s,o[a]):i.element.appendChild(s)}}}(t,n)}},z=$,O=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-draggable",class:t.draggable?"":"vm-draggable-disabled",style:t.coord,on:{mousedown:t.handleContainerDown,touchstart:function(n){return n.stopPropagation(),t.handleContainerDown(n)}}},[e("div",{class:{"is-events-none":t.isChanging},style:t.style},[t._t("default")],2),t._v(" "),(t.active||t.isActive)&&(t.closeable||t.realHandles.length>0)?e("div",{staticClass:"vm-draggable__handles",class:{"is-disabled":t.disabled,"is-active":t.active||t.isActive},style:t.style},[t._l(t.realHandles,(function(n){return[t.disabled?t._e():e("div",{key:n,staticClass:"vm-draggable__handle",class:"is-"+n,on:{mousedown:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?null:"button"in e&&0!==e.button?null:(e.stopPropagation(),t.handleDown(e,n))},touchstart:function(e){return e.stopPropagation(),t.handleDown(e,n)}}})]})),t._v(" "),t.rotatable&&t.isRotating?e("div",{staticClass:"vm-draggable__rotate",style:{width:t.width}}):t._e(),t._v(" "),t.closeable?e("p",{staticClass:"vm-draggable__delete",on:{click:function(n){return t.$emit("delete")}}},[t._v("✕")]):t._e()],2):t._e(),t._v(" "),t.isRotating?[e("div",{staticClass:"vm-draggable__rotate--deg is-0",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--deg is-45",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--deg is-90",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--deg is-135",style:{width:t.width}}),t._v(" "),e("div",{staticClass:"vm-draggable__rotate--tip"},[t._v(t._s(t.r)+" °")])]:t._e()],2)};O._withStripped=!0;var F=k({render:O,staticRenderFns:[]},(function(t){t&&t("data-v-342caf62_0",{source:'@charset "UTF-8";\n.vm-draggable {\n  padding: 0;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.vm-draggable:hover {\n  cursor: move;\n}\n.vm-draggable .is-events-none {\n  pointer-events: none;\n}\n.vm-draggable .is-delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n}\n.vm-draggable-disabled:hover {\n  cursor: default;\n}\n.vm-draggable__handles.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-draggable__handles.is-active .vm-draggable__handle {\n  display: block;\n}\n.vm-draggable__handles.is-disabled {\n  border: 1px dotted #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:after {\n  background: #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:before {\n  color: #e96101;\n}\n.vm-draggable__handle {\n  display: none;\n  position: absolute;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  z-index: 999;\n}\n.vm-draggable__handle.is-left {\n  top: 0;\n  left: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-left:hover {\n  background: -webkit-gradient(linear, left top, right top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-right {\n  top: 0;\n  right: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-right:hover {\n  background: -webkit-gradient(linear, right top, left top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  top: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-top:hover {\n  background: -webkit-gradient(linear, left top, left bottom, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-bottom {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  bottom: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-bottom:hover {\n  background: -webkit-gradient(linear, left bottom, left top, from(rgba(255, 255, 255, 0)), to(#3F51B5));\n  background: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top-left {\n  top: 0;\n  left: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle .is-bottom-left {\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-top-right {\n  top: 0;\n  right: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-bottom-right {\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-rotate {\n  top: 0;\n  left: 50%;\n  -webkit-transform: translate(-50%, -100%);\n      -ms-transform: translate(-50%, -100%);\n          transform: translate(-50%, -100%);\n  cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" style="font-size: 20px;"><text y="15">↻</text></svg>\') 10 10, default;\n  display: -webkit-box !important;\n  display: -webkit-flex !important;\n  display: -ms-flexbox !important;\n  display: flex !important;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.vm-draggable__handle.is-rotate:after {\n  content: " ";\n  height: 10px;\n  width: 1px;\n  background: #5495F6;\n}\n.vm-draggable__handle.is-rotate:before {\n  content: "☐";\n  -webkit-transform: translateY(26%);\n      -ms-transform: translateY(26%);\n          transform: translateY(26%);\n  color: #5495F6;\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  z-index: 2;\n  width: 500px;\n  border: 1px solid #1fb6ff;\n  background-color: #1fb6ff;\n  -webkit-transform: translate(-50%, -50%) rotate(90deg);\n      -ms-transform: translate(-50%, -50%) rotate(90deg);\n          transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  z-index: 2;\n  width: 500px;\n  border-top: 1px dashed #fff;\n  border-bottom: 1px dashed #262626;\n  opacity: 0.4;\n}\n.vm-draggable__rotate--deg.is-0 {\n  -webkit-transform: translate(-50%, -50%);\n      -ms-transform: translate(-50%, -50%);\n          transform: translate(-50%, -50%);\n}\n.vm-draggable__rotate--deg.is-45 {\n  -webkit-transform: translate(-50%, -50%) rotate(45deg);\n      -ms-transform: translate(-50%, -50%) rotate(45deg);\n          transform: translate(-50%, -50%) rotate(45deg);\n}\n.vm-draggable__rotate--deg.is-90 {\n  -webkit-transform: translate(-50%, -50%) rotate(90deg);\n      -ms-transform: translate(-50%, -50%) rotate(90deg);\n          transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg.is-135 {\n  -webkit-transform: translate(-50%, -50%) rotate(135deg);\n      -ms-transform: translate(-50%, -50%) rotate(135deg);\n          transform: translate(-50%, -50%) rotate(135deg);\n}\n.vm-draggable__rotate--tip {\n  position: absolute;\n  top: -50px;\n  left: 60%;\n  width: 40px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: 1px solid #262626;\n  border-radius: 8px;\n  background-color: #fff;\n}\n.vm-draggable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=draggable.vue.map */',map:{version:3,sources:["draggable.vue","/Users/deot/Desktop/wya/github/wya-vm/src/base/draggable.vue"],names:[],mappings:"AAAA,gBAAgB;ACynBhB;EACA,UAAA;EACA,kBAAA;EACA,8BAAA;UAAA,sBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;ADvnBA;ACwnBA;EACA,YAAA;ADtnBA;ACwnBA;EACA,oBAAA;ADtnBA;ACynBA;EACA,mBAAA;EACA,kBAAA;EACA,QAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;ADvnBA;AC2nBA;EACA,eAAA;ADxnBA;AC4nBA;EACA,UAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,UAAA;EACA,0BAAA;ADznBA;AC2nBA;EACA,cAAA;ADznBA;AC4nBA;EACA,0BAAA;AD1nBA;AC4nBA;EACA,mBAAA;AD1nBA;AC4nBA;EACA,cAAA;AD1nBA;AC+nBA;EACA,aAAA;EACA,kBAAA;EACA,8BAAA;UAAA,sBAAA;EACA,YAAA;AD5nBA;AC6nBA;EACA,MAAA;EACA,UAAA;EACA,iBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;AD3nBA;AC4nBA;EACA,oGAAA;EAAA,sEAAA;AD1nBA;AC6nBA;EACA,MAAA;EACA,WAAA;EACA,iBAAA;EACA,kBAAA;EACA,YAAA;EACA,UAAA;AD3nBA;AC4nBA;EACA,oGAAA;EAAA,qEAAA;AD1nBA;AC8nBA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;EACA,SAAA;EACA,OAAA;EACA,iBAAA;AD5nBA;AC6nBA;EACA,sGAAA;EAAA,uEAAA;AD3nBA;AC8nBA;EACA,kBAAA;EACA,WAAA;EACA,WAAA;EACA,YAAA;EACA,OAAA;EACA,iBAAA;AD5nBA;AC6nBA;EACA,sGAAA;EAAA,oEAAA;AD3nBA;AC8nBA;EACA,MAAA;EACA,OAAA;EACA,mBAAA;EACA,YAAA;AD5nBA;AC8nBA;EACA,SAAA;EACA,OAAA;EACA,mBAAA;EACA,YAAA;AD5nBA;AC8nBA;EACA,MAAA;EACA,QAAA;EACA,mBAAA;EACA,YAAA;AD5nBA;AC8nBA;EACA,SAAA;EACA,QAAA;EACA,mBAAA;EACA,YAAA;AD5nBA;AC8nBA;EACA,MAAA;EACA,SAAA;EACA,yCAAA;MAAA,qCAAA;UAAA,iCAAA;EACA,yKAAA;EACA,+BAAA;EAAA,gCAAA;EAAA,+BAAA;EAAA,wBAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;AD5nBA;AC6nBA;EACA,YAAA;EACA,YAAA;EACA,UAAA;EACA,mBAAA;AD3nBA;AC6nBA;EACA,YAAA;EACA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;EACA,cAAA;AD3nBA;;ACgoBA;;EAAA;AAGA;EACA,kBAAA;EACA,SAAA;EACA,QAAA;EACA,UAAA;EACA,YAAA;EACA,yBAAA;EACA,yBAAA;EACA,sDAAA;MAAA,kDAAA;UAAA,8CAAA;AD7nBA;AC+nBA;EACA,kBAAA;EACA,QAAA;EACA,SAAA;EACA,UAAA;EACA,YAAA;EACA,2BAAA;EACA,iCAAA;EACA,YAAA;AD5nBA;AC6nBA;EACA,wCAAA;MAAA,oCAAA;UAAA,gCAAA;AD3nBA;AC6nBA;EACA,sDAAA;MAAA,kDAAA;UAAA,8CAAA;AD3nBA;AC6nBA;EACA,sDAAA;MAAA,kDAAA;UAAA,8CAAA;AD3nBA;AC6nBA;EACA,uDAAA;MAAA,mDAAA;UAAA,+CAAA;AD3nBA;AC+nBA;EACA,kBAAA;EACA,UAAA;EACA,SAAA;EACA,WAAA;EACA,YAAA;EACA,iBAAA;EACA,kBAAA;EACA,yBAAA;EACA,kBAAA;EACA,sBAAA;AD5nBA;AC+nBA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,UAAA;EACA,eAAA;AD5nBA;;AAEA,wCAAwC",file:"draggable.vue",sourcesContent:['@charset "UTF-8";\n.vm-draggable {\n  padding: 0;\n  position: absolute;\n  box-sizing: border-box;\n  user-select: none;\n}\n.vm-draggable:hover {\n  cursor: move;\n}\n.vm-draggable .is-events-none {\n  pointer-events: none;\n}\n.vm-draggable .is-delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n}\n\n.vm-draggable-disabled:hover {\n  cursor: default;\n}\n\n.vm-draggable__handles.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-draggable__handles.is-active .vm-draggable__handle {\n  display: block;\n}\n.vm-draggable__handles.is-disabled {\n  border: 1px dotted #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:after {\n  background: #e96101;\n}\n.vm-draggable__handles.is-disabled .handle-rotate:before {\n  color: #e96101;\n}\n\n.vm-draggable__handle {\n  display: none;\n  position: absolute;\n  box-sizing: border-box;\n  z-index: 999;\n}\n.vm-draggable__handle.is-left {\n  top: 0;\n  left: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-left:hover {\n  background: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-right {\n  top: 0;\n  right: -5px;\n  cursor: ew-resize;\n  position: absolute;\n  height: 100%;\n  width: 5px;\n}\n.vm-draggable__handle.is-right:hover {\n  background: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  top: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-top:hover {\n  background: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-bottom {\n  position: absolute;\n  width: 100%;\n  height: 5px;\n  bottom: -5px;\n  left: 0;\n  cursor: ns-resize;\n}\n.vm-draggable__handle.is-bottom:hover {\n  background: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n}\n.vm-draggable__handle.is-top-left {\n  top: 0;\n  left: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle .is-bottom-left {\n  bottom: 0;\n  left: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-top-right {\n  top: 0;\n  right: 0;\n  cursor: nesw-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-bottom-right {\n  bottom: 0;\n  right: 0;\n  cursor: nwse-resize;\n  padding: 5px;\n}\n.vm-draggable__handle.is-rotate {\n  top: 0;\n  left: 50%;\n  transform: translate(-50%, -100%);\n  cursor: url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" style="font-size: 20px;"><text y="15">↻</text></svg>\') 10 10, default;\n  display: flex !important;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n.vm-draggable__handle.is-rotate:after {\n  content: " ";\n  height: 10px;\n  width: 1px;\n  background: #5495F6;\n}\n.vm-draggable__handle.is-rotate:before {\n  content: "☐";\n  transform: translateY(26%);\n  color: #5495F6;\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  z-index: 2;\n  width: 500px;\n  border: 1px solid #1fb6ff;\n  background-color: #1fb6ff;\n  transform: translate(-50%, -50%) rotate(90deg);\n}\n\n.vm-draggable__rotate--deg {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  z-index: 2;\n  width: 500px;\n  border-top: 1px dashed #fff;\n  border-bottom: 1px dashed #262626;\n  opacity: 0.4;\n}\n.vm-draggable__rotate--deg.is-0 {\n  transform: translate(-50%, -50%);\n}\n.vm-draggable__rotate--deg.is-45 {\n  transform: translate(-50%, -50%) rotate(45deg);\n}\n.vm-draggable__rotate--deg.is-90 {\n  transform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg.is-135 {\n  transform: translate(-50%, -50%) rotate(135deg);\n}\n\n.vm-draggable__rotate--tip {\n  position: absolute;\n  top: -50px;\n  left: 60%;\n  width: 40px;\n  height: 16px;\n  line-height: 16px;\n  text-align: center;\n  border: 1px solid #262626;\n  border-radius: 8px;\n  background-color: #fff;\n}\n\n.vm-draggable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n/*# sourceMappingURL=draggable.vue.map */',"<template>\n\t<div\n\t\t:style=\"coord\"\n\t\t:class=\"!draggable ? 'vm-draggable-disabled' : ''\"\n\t\tclass=\"vm-draggable\"\n\t\t@mousedown=\"handleContainerDown\"\n\t\t@touchstart.stop=\"handleContainerDown\"\n\t>\n\t\t<div :style=\"style\" :class=\"{ 'is-events-none': isChanging }\" >\n\t\t\t<slot :style=\"style\"/>\n\t\t</div>\n\t\t\x3c!-- handle --\x3e\n\t\t<div\n\t\t\tv-if=\"(active || isActive) && (closeable || realHandles.length > 0)\"\n\t\t\t:class=\"{ 'is-disabled': disabled, 'is-active': (active || isActive) }\"\n\t\t\t:style=\"style\"\n\t\t\tclass=\"vm-draggable__handles\"\n\t\t>\n\t\t\t<template v-for=\"item in realHandles\">\n\t\t\t\t<div\n\t\t\t\t\tv-if=\"!disabled\"\n\t\t\t\t\t:key=\"item\"\n\t\t\t\t\t:class=\"`is-${item}`\"\n\t\t\t\t\tclass=\"vm-draggable__handle\"\n\t\t\t\t\t@mousedown.left.stop=\"handleDown($event, item)\"\n\t\t\t\t\t@touchstart.stop=\"handleDown($event, item)\"\n\t\t\t\t/>\n\t\t\t</template>\n\t\t\t<div v-if=\"rotatable && isRotating\" :style=\"{ width }\" class=\"vm-draggable__rotate\"/>\n\t\t\t\x3c!-- delete --\x3e\n\t\t\t<p v-if=\"closeable\" class=\"vm-draggable__delete\" @click=\"$emit('delete')\">✕</p>\n\t\t</div>\n\n\t\t\x3c!-- 位置不会改变的 --\x3e\n\t\t\x3c!-- grid for rotate --\x3e\n\t\t<template v-if=\"isRotating\">\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-0\" />\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-45\" />\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-90\" />\n\t\t\t<div :style=\"{ width }\" class=\"vm-draggable__rotate--deg is-135\" />\n\t\t\t<div class=\"vm-draggable__rotate--tip\">{{ r }} °</div>\n\t\t</template>\n\t</div>\n</template>\n\n<script>\nimport { isPassiveSupported, eleInRegExp } from '../utils/helper';\n\nconst doc = document.documentElement;\nconst angleArr = [0, 45, 90, 135, 180, 225, 270, 315, 360];\n\nexport const draggableEvents = {\n\tstart: ['touchstart', 'mousedown'],\n\tmove: ['touchmove', 'mousemove'],\n\tend: ['touchend', 'touchcancel', 'mouseup']\n};\n\nexport default {\n\treplace: true,\n\tname: 'vm-draggable',\n\tprops: {\n\t\thandles: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => (['top', 'right', 'bottom', 'left', 'top-left', 'top-right', 'bottom-right', 'bottom-left', 'rotate'])\n\t\t},\n\t\t// 宽度\n\t\tw: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t\tvalidator: val => val >= 0\n\t\t},\n\t\t// 高度\n\t\th: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t\tvalidator: val => val >= 0\n\t\t},\n\t\t// 选择角度\n\t\tr: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// 最小宽度\n\t\tminW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 36,\n\t\t\tvalidator: val => val > 0\n\t\t},\n\t\t// 最小高度\n\t\tminH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 36,\n\t\t\tvalidator: val => val > 0\n\t\t},\n\t\t// 距父元素左上角X轴偏移量\n\t\tx: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// 距父元素左上角Y轴偏移量\n\t\ty: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\t// zIndex\n\t\tz: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tgrid: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => {\n\t\t\t\treturn [1, 1];\n\t\t\t}\n\t\t},\n\n\t\tguides: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [[], []];\n\t\t\t}\n\t\t},\n\n\t\t// 约束组件大小\n\t\trestrain: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tparent: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\t// 在入口文件下，才会去判断editorRegExp，如弹层不会判断让其失去激活状态（除非配置）\n\t\tentryRegExp: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\tclassName: /vm-hack-entry/,\n\t\t\t\tid: /^(app|pages)$/\n\t\t\t})\n\t\t},\n\n\t\teditorRegExp: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\tclassName: /vm-hack-editor/\n\t\t\t})\n\t\t},\n\n\t\t/**\n\t\t * 是否屏蔽默认事件\n\t\t */\n\t\tprevent: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tpreventRegExp: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({\n\t\t\t\ttagName: /^(INPUT|TEXTAREA|BUTTON|SELECT|OPTION)$/,\n\t\t\t\tclassName: /vm-hack-pevent/,\n\t\t\t})\n\t\t},\n\n\t\tmodule: {\n\t\t\ttype: String,\n\t\t},\n\n\t\tdisabled: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\tcloseable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\tdraggable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\n\t\tresizable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\n\t\trotatable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\n\t\t// 激活状态， 特殊需求\n\t\tactive: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\n\t\toffset: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [0, 0];\n\t\t\t}\n\t\t},\n\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisResizing: false,\n\t\t\tisDraging: false,\n\t\t\tisRotating: false,\n\t\t\tisChanging: false,\n\t\t\tisActive: false\n\t\t};\n\t},\n\tcomputed: {\n\t\tcoord() {\n\t\t\treturn {\n\t\t\t\tleft: this.x + 'px',\n\t\t\t\ttop: this.y + 'px',\n\t\t\t\tzIndex: this.isActive && this.module !== 'page' ? 999 : this.z\n\t\t\t};\n\t\t},\n\t\tstyle() {\n\t\t\tconst w = this.w === 0 ? 'auto' : `${this.w}px`;\n\t\t\tconst h = this.h === 0 ? 'auto' : `${this.h}px`;\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h,\n\t\t\t\ttransform: `rotate(${this.r}deg)`\n\t\t\t};\n\t\t},\n\t\twidth() {\n\t\t\tlet num = Math.floor(\n\t\t\t\tMath.sqrt(this.w * this.w + this.h * this.h) * 1.15\n\t\t\t);\n\t\t\treturn `${num}px`;\n\t\t},\n\t\trealHandles() {\n\t\t\tlet handles = this.handles;\n\n\t\t\tif (!this.rotatable) {\n\t\t\t\thandles = handles.filter(i => i !== 'rotate');\n\t\t\t}\n\n\t\t\tif (!this.resizable) {\n\t\t\t\thandles = handles.filter(i => i === 'rotate');\n\t\t\t}\n\n\t\t\treturn handles;\n\t\t}\n\t},\n\twatch: {},\n\tbeforeCreate() {\n\t\tthis.parentX = 0;\n\t\tthis.parentY = 0;\n\t\tthis.parentW = 9999;\n\t\tthis.parentH = 9999;\n\t\tthis.mouseX = 0;\n\t\tthis.mouseY = 0;\n\t\tthis.lastMouseX = 0;\n\t\tthis.lastMouseY = 0;\n\t\tthis.mouseOffX = 0;\n\t\tthis.mouseOffY = 0;\n\n\t\tthis.handle = null;\n\n\t\t// 组件捕获阶段执行\n\t\tthis.eventOpts = !isPassiveSupported || { capture: true, passive: true };\n\n\t\t// 改变前状态\n\t\tthis.beforeStatus = null;\n\t},\n\tmounted() {\n\t\t// 初始化控件宽高, todo: 宽高未零时，是否需要计算\n\t\tif (this.w && this.minW > this.w) {\n\t\t\tthis.sync({ w: this.minW });\n\t\t}\n\t\tif (this.h && this.minH > this.h) {\n\t\t\tthis.sync({ h: this.minH });\n\t\t}\n\n\t\tthis.$nextTick(() => {\n\t\t\tconst { x, y } = this.$el.parentNode.getBoundingClientRect();\n\t\t\tthis.parentX = x + this.offset[0];\n\t\t\tthis.parentY = y + this.offset[1];\n\n\t\t\t// 判断是否只能在父级元素中拖动\n\t\t\tthis.parent && this.calculation();\n\t\t\tthis.$emit('resizing');\n\t\t});\n\t},\n\tdestroyed() {\n\t\tthis.operateDOMEvents('remove');\n\t},\n\tmethods: {\n\t\tcalculation() {\n\t\t\tconst { width, height } = this.$el.parentNode.getBoundingClientRect();\n\t\t\tif (!width || !height) {\n\t\t\t\tthrow new Error('@wya/vm: 父层容器宽度计算异常');\n\t\t\t}\n\n\t\t\tthis.parentW = width;\n\t\t\tthis.parentH = height; // this.$el.parentNode.clientHeight\n\n\t\t\tif (this.w > this.parentW) {\n\t\t\t\tthis.sync({ w: this.parentW });\n\t\t\t}\n\t\t\tif (this.h > this.parentH) {\n\t\t\t\tthis.sync({ h: this.parentH });\n\t\t\t}\n\t\t\tif ((this.x + this.w) > this.parentW) {\n\t\t\t\tthis.sync({ x: this.parentW - this.w });\n\t\t\t}\n\t\t\tif ((this.y + this.h) > this.parentH) {\n\t\t\t\tthis.sync({ y: this.parentH - this.h });\n\t\t\t}\n\t\t},\n\t\tsync(opts) {\n\t\t\tfor (let key in opts) {\n\t\t\t\tif (this[key] != opts[key]) {\n\t\t\t\t\t!this.beforeStatus && (this.beforeStatus = {\n\t\t\t\t\t\tx: this.x,\n\t\t\t\t\t\ty: this.y,\n\t\t\t\t\t\tz: this.z,\n\t\t\t\t\t\tw: this.w,\n\t\t\t\t\t\tr: this.r\n\t\t\t\t\t});\n\t\t\t\t\tthis.$emit(`update:${key}`, opts[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === 'add' ? doc.addEventListener : doc.removeEventListener;\n\n\t\t\t// 使用原生绑定 不区分移动端还是桌面端\n\t\t\tdraggableEvents.start.forEach(eventName => {\n\t\t\t\tfn(eventName, this.handleDeselect, this.eventOpts);\n\t\t\t});\n\t\t\tdraggableEvents.move.forEach(eventName => {\n\t\t\t\tfn(eventName, this.handleMove, this.eventOpts);\n\t\t\t});\n\t\t\tdraggableEvents.end.forEach(eventName => {\n\t\t\t\tfn(eventName, this.handleUp, this.eventOpts);\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * 模拟设置isActive状态\n\t\t */\n\t\tsetActived() {\n\t\t\tthis.handleContainerDown();\n\t\t\tthis.handleUp();\n\t\t},\n\t\t/**\n\t\t * 组件被按下事件\n\t\t */\n\t\thandleContainerDown(e = {}) {\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault\n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 判断是否支持拖动\n\t\t\tif (this.disabled) return;\n\t\t\tconst target = e.target || e.srcElement;\n\t\t\t// 确保事件发生在组件内部\n\t\t\tif (!target || this.$el.contains(target)) {\n\t\t\t\tif (!this.isActive) {\n\t\t\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\n\t\t\t\t\tthis.lastMouseX = mousePositionX + doc.scrollLeft;\n\t\t\t\t\tthis.lastMouseY = mousePositionY + doc.scrollTop;\n\n\t\t\t\t\t// 绑定事件\n\t\t\t\t\tthis.operateDOMEvents('add');\n\n\t\t\t\t\tthis.isActive = true;\n\t\t\t\t\tthis.$emit('activated');\n\t\t\t\t}\n\t\t\t\tthis.draggable && (this.isDraging = true);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 取消选择事件\n\t\t */\n\t\thandleDeselect(e) {\n\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\n\t\t\tthis.mouseX = mousePositionX + doc.scrollLeft;\n\t\t\tthis.mouseY = mousePositionY + doc.scrollTop;\n\t\t\tthis.lastMouseX = this.mouseX;\n\t\t\tthis.lastMouseY = this.mouseY;\n\t\t\tconst target = e.target || e.srcElement; // body不要带上class, 否则会存在问题\n\n\t\t\t// 内部管理\n\t\t\tconst regex = {\n\t\t\t\tclassName: /is-([(top|right|-|bottom|left)]{2})/\n\t\t\t};\n\n\t\t\tlet path = e.path || (e.composedPath && e.composedPath()) || [];\n\n\t\t\t// 是否是入口下的元素，如果不是，就意味着可能是弹层（避免销毁）\n\t\t\tlet isInline = path.some(item => eleInRegExp(item, this.entryRegExp));\n\n\t\t\tif (\n\t\t\t\tisInline\n\t\t\t\t&& !this.$el.contains(target)\n\t\t\t\t&& !eleInRegExp(target, regex)\n\t\t\t\t&& (!path.some(item => eleInRegExp(item, this.editorRegExp)))\n\t\t\t) {\n\t\t\t\tif (this.isActive) {\n\t\t\t\t\t// 解绑\n\t\t\t\t\tthis.operateDOMEvents('remove');\n\n\t\t\t\t\tthis.isActive = false;\n\t\t\t\t\tthis.$emit('deactivated', e);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 拖动点按下事件\n\t\t */\n\t\thandleDown(e, handle) {\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault\n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 将handle设置为当前元素\n\t\t\tthis.handle = handle;\n\t\t\tif (handle === 'rotate') {\n\t\t\t\tthis.rotatable && (this.isRotating = true);\n\t\t\t} else {\n\t\t\t\tthis.resizable && (this.isResizing = true);\n\t\t\t}\n\n\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\n\t\t\tthis.preMouseX = mousePositionX + doc.scrollLeft;\n\t\t\tthis.preMouseY = mousePositionY + doc.scrollTop;\n\t\t},\n\t\thandleMove(e) {\n\t\t\tconst { mousePositionX, mousePositionY } = this.getPositionByEvent(e);\n\t\t\tthis.mouseX = mousePositionX + doc.scrollLeft;\n\t\t\tthis.mouseY = mousePositionY + doc.scrollTop;\n\n\t\t\t// x, y, w, h\n\t\t\tlet elmX = parseInt(this.x, 10);\n\t\t\tlet elmY = parseInt(this.y, 10);\n\t\t\tlet elmW = parseInt(this.w, 10);\n\t\t\tlet elmH = parseInt(this.h, 10);\n\n\t\t\t// 鼠标所在的轴xy坐标值\n\t\t\tlet axisX = Math.round((this.mouseX - this.parentX + this.offset[0]) / this.scale);\n\t\t\tlet axisY = Math.round((this.mouseY - this.parentY + this.offset[1]) / this.scale);\n\t\t\tlet diffX = axisX - Math.round((this.lastMouseX - this.parentX + this.offset[0]) / this.scale);\n\t\t\tlet diffY = axisY - Math.round((this.lastMouseY - this.parentY + this.offset[1]) / this.scale);\n\t\t\tthis.lastMouseX = this.mouseX;\n\t\t\tthis.lastMouseY = this.mouseY;\n\n\t\t\tif (this.isResizing) {\n\t\t\t\tif (this.handle.includes('top')) {\n\t\t\t\t\tif (elmY - axisY + elmH < this.minH) {\n\t\t\t\t\t\taxisY = elmY + elmH - this.minH;\n\t\t\t\t\t} else if (this.parent && axisY < 0) {\n\t\t\t\t\t\taxisY = 0;\n\t\t\t\t\t}\n\t\t\t\t\telmH = elmY + elmH - axisY;\n\t\t\t\t\telmY = axisY;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('bottom')) {\n\t\t\t\t\tif (axisY - elmY < this.minH) {\n\t\t\t\t\t\taxisY = elmY + this.minH;\n\t\t\t\t\t} else if (this.parent && axisY > this.parentH / this.scale) {\n\t\t\t\t\t\taxisY = Math.round(this.parentH / this.scale);\n\t\t\t\t\t}\n\t\t\t\t\telmH = axisY - elmY;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('left')) {\n\t\t\t\t\tif (elmX - axisX + elmW < this.minW) {\n\t\t\t\t\t\taxisX = elmX + elmW - this.minW;\n\t\t\t\t\t} else if (this.parent && axisX < 0) {\n\t\t\t\t\t\taxisX = 0;\n\t\t\t\t\t}\n\t\t\t\t\telmW = elmX + elmW - axisX;\n\t\t\t\t\telmX = axisX;\n\t\t\t\t}\n\t\t\t\tif (this.handle.includes('right')) {\n\t\t\t\t\tif (axisX - elmX < this.minW) {\n\t\t\t\t\t\taxisX = elmX + this.minW;\n\t\t\t\t\t} else if (this.parent && axisX > this.parentW / this.scale) {\n\t\t\t\t\t\taxisX = Math.round(this.parentW / this.scale);\n\t\t\t\t\t}\n\t\t\t\t\telmW = axisX - elmX;\n\t\t\t\t}\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tx: (Math.round(elmX / this.grid[0]) * this.grid[0]),\n\t\t\t\t\ty: (Math.round(elmY / this.grid[1]) * this.grid[1]),\n\t\t\t\t\tw: (Math.round(elmW / this.grid[0]) * this.grid[0]),\n\t\t\t\t\th: (Math.round(elmH / this.grid[1]) * this.grid[1]),\n\t\t\t\t});\n\t\t\t\tthis.$emit('resizing');\n\t\t\t} else if (this.isRotating) {\n\t\t\t\tlet angle = this.getAngle(\n\t\t\t\t\t[this.parentX + this.x + this.w / 2, -(this.parentY + this.y + this.h / 2)],\n\t\t\t\t\t[this.lastMouseX + this.offset[0], -(this.lastMouseY + this.offset[1])],\n\t\t\t\t);\n\n\t\t\t\tlet criticalAngle = angleArr.find(item => Math.abs(item - angle) < 3);\n\t\t\t\tangle = typeof criticalAngle === 'number' ? criticalAngle : angle;\n\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tr: angle === 360 ? 0 : angle\n\t\t\t\t});\n\t\t\t\tthis.$emit('rotating');\n\t\t\t} else if (this.isDraging) {\n\n\t\t\t\t// 找出可吸附的辅助线\n\t\t\t\tlet leftline = this.guides[0] && this.guides[0].find(item => {\n\t\t\t\t\treturn Math.abs(elmX + diffX - item) < 3;\n\t\t\t\t});\n\t\t\t\tlet rightline = this.guides[0] && this.guides[0].find(item => {\n\t\t\t\t\treturn Math.abs(elmX + diffX + elmW - item) < 2;\n\t\t\t\t});\n\t\t\t\tlet topline = this.guides[1] && this.guides[1].find(item => {\n\t\t\t\t\treturn Math.abs(elmY + diffY - item) < 3;\n\t\t\t\t});\n\t\t\t\tlet bottomline = this.guides[1] && this.guides[1].find(item => {\n\t\t\t\t\treturn Math.abs(elmY + diffY + elmH - item) < 2;\n\t\t\t\t});\n\n\t\t\t\tleftline && (diffX = leftline - elmX);\n\t\t\t\trightline && (diffX = rightline - elmX - elmW);\n\t\t\t\ttopline && (diffY = topline - elmY);\n\t\t\t\tbottomline && (diffY = bottomline - elmY - elmH);\n\n\t\t\t\tif (this.parent) {\n\t\t\t\t\tif (elmX + diffX < 0 || elmX + diffX + elmW > this.parentW / this.scale) {\n\t\t\t\t\t\tdiffX = 0;\n\t\t\t\t\t}\n\t\t\t\t\tif (elmY + diffY < 0 || elmY + diffY + elmH > this.parentH / this.scale) {\n\t\t\t\t\t\tdiffY = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telmX += diffX;\n\t\t\t\telmY += diffY;\n\n\t\t\t\t!this.disabled && this.sync({\n\t\t\t\t\tx: (Math.round(elmX / this.grid[0]) * this.grid[0]),\n\t\t\t\t\ty: (Math.round(elmY / this.grid[1]) * this.grid[1]),\n\t\t\t\t});\n\t\t\t\tthis.$emit('dragging');\n\t\t\t}\n\n\t\t\t// 正在改变\n\t\t\t!this.isChanging\n\t\t\t\t&& (this.isRotating || this.isDraging || this.isResizing)\n\t\t\t\t&& (this.isChanging = true);\n\n\t\t},\n\n\t\tgetAngle(center, last) {\n\t\t\tlet diffX = last[0] - center[0];\n\t\t\tlet diffY = last[1] - center[1];\n\t\t\t/**\n\t\t\t * https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Math/atan2\n\t\t\t * -180 <= c < 180\n\t\t\t */\n\t\t\tlet c = 360 * Math.atan2(diffY, diffX) / (2 * Math.PI);\n\t\t\tc = c > 90\n\t\t\t\t? (450 - c) // 第4\n\t\t\t\t: 90 - c; // 第1，2，3象限\n\t\t\treturn Math.floor(c);\n\t\t},\n\t\tgetRestrain(num) {\n\t\t\tconst restrain = this.restrain;\n\t\t\treturn (num / restrain).toFixed(0) * restrain;\n\t\t},\n\t\tgetPositionByEvent(e) {\n\t\t\tconst mousePositionX = e.targetTouches\n\t\t\t\t? e.targetTouches[0].pageX\n\t\t\t\t: e.clientX;\n\t\t\tconst mousePositionY = e.targetTouches\n\t\t\t\t? e.targetTouches[0].pageY\n\t\t\t\t: e.clientY;\n\t\t\treturn {\n\t\t\t\tmousePositionX: mousePositionX || 0,\n\t\t\t\tmousePositionY: mousePositionY || 0\n\t\t\t};\n\t\t},\n\t\thandleUp(e) {\n\t\t\tthis.isChanging = false;\n\t\t\tthis.handle = null;\n\t\t\t// 约束\n\t\t\tconst restrain = this.restrain;\n\t\t\tif (restrain && restrain > 0) {\n\t\t\t\tthis.sync({\n\t\t\t\t\tx: this.getRestrain(this.x),\n\t\t\t\t\ty: this.getRestrain(this.y),\n\t\t\t\t\tw: this.getRestrain(this.w),\n\t\t\t\t\th: this.getRestrain(this.h),\n\t\t\t\t});\n\t\t\t}\n\t\t\tif (this.isRotating) {\n\t\t\t\tthis.isRotating = false;\n\t\t\t\tthis.$emit('rotate-end');\n\t\t\t}\n\t\t\tif (this.isResizing) {\n\t\t\t\tthis.isResizing = false;\n\t\t\t\tthis.$emit('resize-end');\n\t\t\t}\n\t\t\tif (this.isDraging) {\n\t\t\t\tthis.isDraging = false;\n\t\t\t\tthis.$emit('drag-end');\n\t\t\t}\n\t\t\tif (this.beforeStatus) {\n\t\t\t\tthis.$emit('end', this.beforeStatus);\n\t\t\t\tthis.beforeStatus = null;\n\t\t\t}\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n\n$url: 'data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"30\" height=\"30\" style=\"font-size: 20px;\"><text y=\"15\">↻</text></svg>';\n\n.vm-draggable {\n\tpadding: 0;\n\tposition: absolute;\n\tbox-sizing: border-box;\n\tuser-select: none;\n\t&:hover {\n\t\tcursor: move;\n\t}\n\t.is-events-none {\n\t\tpointer-events: none;\n\t}\n\t// 重复？\n\t.is-delete {\n\t\tbackground: #5495F6;\n\t\tposition: absolute;\n\t\tright: 0;\n\t\twidth: 20px;\n\t\tcolor: white;\n\t\ttext-align: center;\n\t\tz-index: 300\n\t}\n}\n.vm-draggable-disabled {\n\t&:hover {\n\t\tcursor: default;\n\t}\n}\n.vm-draggable__handles {\n\t&.is-active {\n\t\tpadding: 0;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tright: 0;\n\t\tbottom: 0;\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tborder: 1px dotted #5495F6;\n\t\t// cursor: move;\n\t\t.vm-draggable__handle {\n\t\t\tdisplay: block;\n\t\t}\n\t}\n\t&.is-disabled {\n\t\tborder: 1px dotted #e96101;\n\t\t.handle-rotate {\n\t\t\t&:after {\n\t\t\t\tbackground: #e96101;\n\t\t\t}\n\t\t\t&:before {\n\t\t\t\tcolor: #e96101;\n\t\t\t}\n\t\t}\n\t}\n}\n.vm-draggable__handle {\n\tdisplay: none;\n\tposition: absolute;\n\tbox-sizing: border-box;\n\tz-index: 999;\n\t&.is-left {\n\t\ttop: 0;\n\t\tleft: -5px;\n\t\tcursor: ew-resize;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t\twidth: 5px;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to right, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-right {\n\t\ttop: 0;\n\t\tright: -5px;\n\t\tcursor: ew-resize;\n\t\tposition: absolute;\n\t\theight: 100%;\n\t\twidth: 5px;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to left, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\n\t&.is-top {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 5px;\n\t\ttop: -5px;\n\t\tleft: 0;\n\t\tcursor: ns-resize;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to bottom, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-bottom {\n\t\tposition: absolute;\n\t\twidth: 100%;\n\t\theight: 5px;\n\t\tbottom: -5px;\n\t\tleft: 0;\n\t\tcursor: ns-resize;\n\t\t&:hover {\n\t\t\tbackground: linear-gradient(to top, rgba(255, 255, 255, 0), #3F51B5);\n\t\t}\n\t}\n\t&.is-top-left {\n\t\ttop: 0;\n\t\tleft: 0;\n\t\tcursor: nwse-resize;\n\t\tpadding: 5px;\n\t}\n\t.is-bottom-left {\n\t\tbottom: 0;\n\t\tleft: 0;\n\t\tcursor: nesw-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-top-right {\n\t\ttop: 0;\n\t\tright: 0;\n\t\tcursor: nesw-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-bottom-right {\n\t\tbottom: 0;\n\t\tright: 0;\n\t\tcursor: nwse-resize;\n\t\tpadding: 5px;\n\t}\n\t&.is-rotate {\n\t\ttop: 0;\n\t\tleft: 50%;\n\t\ttransform: translate(-50%, -100%);\n\t\tcursor: url($url) 10 10,default;\n\t\tdisplay: flex !important;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\t&:after {\n\t\t\tcontent: ' ';\n\t\t\theight: 10px;\n\t\t\twidth: 1px;\n\t\t\tbackground: #5495F6;\n\t\t}\n\t\t&:before {\n\t\t\tcontent: '☐';\n\t\t\ttransform: translateY(26%);\n\t\t\tcolor: #5495F6;\n\t\t}\n\t}\n}\n\n/**\n * rotate\n */\n.vm-draggable__rotate {\n\tposition: absolute;\n\tleft: 50%;\n\ttop: 50%;\n\tz-index: 2;\n\twidth: 500px;\n\tborder: 1px solid #1fb6ff;\n\tbackground-color: #1fb6ff;\n\ttransform: translate(-50%, -50%) rotate(90deg);\n}\n.vm-draggable__rotate--deg {\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\tz-index: 2;\n\twidth: 500px;\n\tborder-top: 1px dashed #fff;\n\tborder-bottom: 1px dashed #262626;\n\topacity: .4;\n\t&.is-0 {\n\t\ttransform: translate(-50%, -50%);\n\t}\n\t&.is-45 {\n\t\ttransform: translate(-50%, -50%) rotate(45deg);\n\t}\n\t&.is-90 {\n\t\ttransform: translate(-50%, -50%) rotate(90deg);\n\t}\n\t&.is-135 {\n\t\ttransform: translate(-50%, -50%) rotate(135deg);\n\t}\n}\n\n.vm-draggable__rotate--tip {\n\tposition: absolute;\n\ttop: -50px;\n\tleft: 60%;\n\twidth: 40px;\n\theight: 16px;\n\tline-height: 16px;\n\ttext-align: center;\n\tborder: 1px solid #262626;\n\tborder-radius: 8px;\n\tbackground-color: #fff;\n}\n\n.vm-draggable__delete {\n\tbackground: #5495F6;\n\tposition: absolute;\n\tright: 0px;\n\twidth: 20px;\n\tcolor: white;\n\ttext-align: center;\n\tz-index: 300;\n\ttop: 0;\n\tright: 0px;\n\tcursor: pointer;\n}\n\n</style>\n"]},media:void 0})}),z,void 0,!1,void 0,M,void 0),N=document.documentElement,Y=null,W={replace:!0,name:"vm-srot-list-item",props:{index:{type:Number|String,required:!0},type:{type:String,default:"@wya/vm"},disabled:F.props.disabled,editorRegExp:F.props.editorRegExp,entryRegExp:F.props.entryRegExp,prevent:F.props.prevent,preventRegExp:F.props.preventRegExp,closeable:F.props.closeable,draggable:{type:Boolean,default:!0},showHighlight:{type:Boolean,default:!0}},data:function(){return{isActive:!1,isHover:!1,highlight:!1}},computed:{},watch:{},beforeCreate:function(){this.eventOpts=!g||{capture:!0,passive:!0}},mounted:function(){},destroyed:function(){this.operateDOMEvents("remove")},methods:{operateDOMEvents:function(t){("add"===t?N.addEventListener:N.removeEventListener)("mousedown",this.handleDeselect,this.eventOpts)},setActived:function(){this.handleClick()},handleClick:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.prevent&&t.preventDefault&&!w(t.target,this.preventRegExp)&&t.preventDefault(),!this.disabled){var n=t.target||t.srcElement;n&&!this.$el.contains(n)||this.isActive||(this.operateDOMEvents("add"),this.isActive=!0,this.$emit("activated"))}},handleDeselect:function(t){var n=this,e=t.target||t.srcElement,i=t.path||t.composedPath&&t.composedPath()||[];!i.some((function(t){return w(t,n.entryRegExp)}))||this.$el.contains(e)||i.some((function(t){return w(t,n.editorRegExp)}))||this.isActive&&(this.operateDOMEvents("remove"),this.isActive=!1,this.$emit("deactivated"))},handleDragStart:function(t){t.dataTransfer.setData(this.type,this.index),t.dataTransfer.effectAllowed="move",(Y=t.target).__START_INDEX__=this.index,Y.__END_INDEX__=this.index,Y.__DRAGGABLE__=this.draggable,t.target.style.opacity=0},handleDragEnter:function(t){var n=this;if(this.draggable&&Y&&Y.__DRAGGABLE__&&t.target!=Y){if(this.index!=Y.__END_INDEX__){if(this.timer)return;this.timer=setTimeout((function(){n.timer=null}),500),this.$emit("sorting",[Y.__END_INDEX__,this.index]),Y.__END_INDEX__=this.index}}else Y||(this.highlight=!0,this.$emit("highlight-change",!0))},handleDragLeave:function(t){this.$refs.highlight!==t.fromElement&&(this.highlight=!1,this.$emit("highlight-change",!1))},handleDragEnd:function(t){t.dataTransfer.clearData(this.type),t.target.style.opacity=1,Y&&this.$emit("sort-end",[Y.__START_INDEX__,Y.__END_INDEX__]),Y=null}}},R=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-sortable",class:t.draggable?"":"vm-sortable-disabled",attrs:{draggable:t.draggable&&!t.disabled},on:{click:t.handleClick,dragstart:t.handleDragStart,dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,dragover:function(t){t.preventDefault()},dragend:t.handleDragEnd,mouseenter:function(n){t.isHover=!0},mouseleave:function(n){t.isHover=!1}}},[e("div",{staticStyle:{"pointer-events":"none"}},[t._t("default")],2),t._v(" "),t.isActive||t.isHover?e("div",{staticClass:"vm-sortable__handle",class:{"is-disabled":t.disabled,"is-active":!0}}):t._e(),t._v(" "),t.closeable&&(t.isActive||t.isHover)?e("p",{staticClass:"vm-sortable__delete",on:{click:function(n){return t.$emit("delete")}}},[t._v("✕")]):t._e(),t._v(" "),t.showHighlight&&t.highlight?e("p",{ref:"highlight",staticClass:"vm-sortable__highlight"},[t._v("\n\t\t释放鼠标将模块添加到此处\n\t")]):t._e()])};R._withStripped=!0;var T=k({render:R,staticRenderFns:[]},(function(t){t&&t("data-v-2122c5cc_0",{source:".vm-sortable {\n  padding: 0;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  position: relative;\n  -webkit-transition: opacity 0.5s;\n  transition: opacity 0.5s;\n}\n.vm-sortable:hover {\n  cursor: move;\n}\n.vm-sortable .vm-sortable__handle.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-sortable.is-disabled {\n  cursor: no-drop;\n}\n.vm-sortable-disabled:hover {\n  cursor: default;\n}\n.vm-sortable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n.vm-sortable__highlight {\n  height: 55px;\n  background: #E7F4FF;\n  color: #5495F6;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  border: 1px dotted #5495F6;\n}\n\n/*# sourceMappingURL=sortable.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/base/sortable.vue","sortable.vue"],names:[],mappings:"AAqOA;EACA,UAAA;EACA,8BAAA;UAAA,sBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,kBAAA;EACA,gCAAA;EAAA,wBAAA;ACpOA;ADqOA;EACA,YAAA;ACnOA;ADsOA;EACA,UAAA;EACA,MAAA;EACA,OAAA;EACA,QAAA;EACA,SAAA;EACA,kBAAA;EACA,UAAA;EACA,0BAAA;ACpOA;ADwOA;EACA,eAAA;ACtOA;AD0OA;EACA,eAAA;ACvOA;AD0OA;EACA,mBAAA;EACA,kBAAA;EACA,UAAA;EACA,WAAA;EACA,YAAA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,UAAA;EACA,eAAA;ACvOA;AD0OA;EACA,YAAA;EACA,mBAAA;EACA,cAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;EACA,0BAAA;ACvOA;;AAEA,uCAAuC",file:"sortable.vue",sourcesContent:['<template>\n\t<div\n\t\t:draggable="draggable && !disabled"\n\t\t:class="!draggable ? \'vm-sortable-disabled\' : \'\'"\n\t\tclass="vm-sortable"\n\t\t@click="handleClick"\n\t\t@dragstart="handleDragStart"\n\t\t@dragenter="handleDragEnter"\n\t\t@dragleave="handleDragLeave"\n\t\t@dragover.prevent\n\t\t@dragend="handleDragEnd"\n\t\t@mouseenter="isHover = true"\n\t\t@mouseleave="isHover = false"\n\t>\n\t\t<div style="pointer-events: none;">\n\t\t\t<slot />\n\t\t</div>\n\t\t\x3c!-- handle --\x3e\n\t\t<div\n\t\t\tv-if="isActive || isHover"\n\t\t\t:class="{\n\t\t\t\t\'is-disabled\': disabled,\n\t\t\t\t\'is-active\': true\n\t\t\t}"\n\t\t\tclass="vm-sortable__handle"\n\t\t/>\n\t\t<p\n\t\t\tv-if="closeable && (isActive || isHover)"\n\t\t\tclass="vm-sortable__delete"\n\t\t\t@click="$emit(\'delete\')"\n\t\t>✕</p>\n\n\t\t<p\n\t\t\tv-if="showHighlight && highlight"\n\t\t\tref="highlight"\n\t\t\tclass="vm-sortable__highlight"\n\t\t>\n\t\t\t释放鼠标将模块添加到此处\n\t\t</p>\n\t</div>\n</template>\n\n<script>\nimport { isPassiveSupported, eleInRegExp } from \'../utils/helper\';\nimport Draggable from \'./draggable.vue\';\n\nconst doc = document.documentElement;\nlet eleDrag = null;\n\nexport default {\n\treplace: true,\n\tname: \'vm-srot-list-item\',\n\tprops: {\n\t\t// 当前排序数组的索引值，非order\n\t\tindex: {\n\t\t\ttype: Number | String,\n\t\t\trequired: true\n\t\t},\n\t\t// 用于getData/setData\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: \'@wya/vm\'\n\t\t},\n\t\tdisabled: Draggable.props.disabled,\n\t\teditorRegExp: Draggable.props.editorRegExp,\n\t\tentryRegExp: Draggable.props.entryRegExp,\n\t\tprevent: Draggable.props.prevent,\n\t\tpreventRegExp: Draggable.props.preventRegExp,\n\t\tcloseable: Draggable.props.closeable,\n\t\tdraggable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowHighlight: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tisActive: false,\n\t\t\tisHover: false,\n\t\t\thighlight: false\n\t\t};\n\t},\n\tcomputed: {\n\n\t},\n\twatch: {},\n\tbeforeCreate() {\n\t\t// 组件捕获阶段执行\n\t\tthis.eventOpts = !isPassiveSupported || { capture: true, passive: true };\n\t},\n\tmounted() {\n\n\t},\n\tdestroyed() {\n\t\tthis.operateDOMEvents(\'remove\');\n\t},\n\tmethods: {\n\t\toperateDOMEvents(type) {\n\t\t\tlet fn = type === \'add\' ? doc.addEventListener : doc.removeEventListener;\n\n\t\t\tfn(\'mousedown\', this.handleDeselect, this.eventOpts);\n\t\t},\n\t\t/**\n\t\t * 模拟设置Active状态\n\t\t */\n\t\tsetActived() {\n\t\t\tthis.handleClick();\n\t\t},\n\t\t/**\n\t\t * 组件被按下事件\n\t\t */\n\t\thandleClick(e = {}) {\n\t\t\t// 去除默认事件 todo: 匹配输入框\n\t\t\tthis.prevent\n\t\t\t\t&& e.preventDefault\n\t\t\t\t&& !eleInRegExp(e.target, this.preventRegExp)\n\t\t\t\t&& e.preventDefault();\n\n\t\t\t// 判断是否支持拖动\n\t\t\tif (this.disabled) return;\n\t\t\tconst target = e.target || e.srcElement;\n\t\t\t// 确保事件发生在组件内部\n\t\t\tif (!target || this.$el.contains(target)) {\n\t\t\t\tif (!this.isActive) {\n\t\t\t\t\t// 绑定事件\n\t\t\t\t\tthis.operateDOMEvents(\'add\');\n\n\t\t\t\t\tthis.isActive = true;\n\t\t\t\t\tthis.$emit(\'activated\');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * 取消选择事件\n\t\t */\n\t\thandleDeselect(e) {\n\t\t\tconst target = e.target || e.srcElement; // body不要带上class, 否则会存在问题\n\n\t\t\tlet path = e.path || (e.composedPath && e.composedPath()) || [];\n\n\t\t\t// 是否是入口下的元素，如果不是，就意味着可能是弹层（避免销毁）\n\t\t\tlet isInline = path.some(item => eleInRegExp(item, this.entryRegExp));\n\n\t\t\tif (\n\t\t\t\tisInline\n\t\t\t\t&& !this.$el.contains(target)\n\t\t\t\t&& (!path.some(item => eleInRegExp(item, this.editorRegExp)))\n\t\t\t) {\n\t\t\t\tif (this.isActive) {\n\t\t\t\t\t// 解绑\n\t\t\t\t\tthis.operateDOMEvents(\'remove\');\n\n\t\t\t\t\tthis.isActive = false;\n\t\t\t\t\tthis.$emit(\'deactivated\');\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t* 拖拽开始\n\t\t*/\n\t\thandleDragStart(e) {\n\t\t\t// 定义拖动数据 - 拖到别的输入框展示的内容\n\t\t\te.dataTransfer.setData(this.type, this.index);\n\n\t\t\t// 拖放效果\n\t\t\te.dataTransfer.effectAllowed = "move";\n\n\t\t\teleDrag = e.target;\n\n\t\t\teleDrag.__START_INDEX__ = this.index;\n\t\t\teleDrag.__END_INDEX__ = this.index;\n\t\t\teleDrag.__DRAGGABLE__ = this.draggable;\n\n\t\t\te.target.style.opacity = 0;\n\t\t},\n\n\t\t/**\n\t\t* 拖拽元素进入目标元素头上的时候\n\t\t*/\n\t\thandleDragEnter(e) {\n\t\t\tif (this.draggable && eleDrag && eleDrag.__DRAGGABLE__ && e.target != eleDrag) { // 排序\n\t\t\t\tif (this.index != eleDrag.__END_INDEX__) {\n\t\t\t\t\tif (this.timer) return;\n\t\t\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\t\t\tthis.timer = null;\n\t\t\t\t\t}, 500);\n\n\t\t\t\t\tthis.$emit(\'sorting\', [eleDrag.__END_INDEX__, this.index]);\n\t\t\t\t\teleDrag.__END_INDEX__ = this.index;\n\t\t\t\t}\n\t\t\t} else if (!eleDrag) { // 处理高亮\n\t\t\t\tthis.highlight = true;\n\t\t\t\tthis.$emit(\'highlight-change\', true);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 拖拽离开\n\t\t */\n\t\thandleDragLeave(e) {\n\t\t\tif (this.$refs.highlight === e.fromElement) return;\n\n\t\t\tthis.highlight = false;\n\t\t\tthis.$emit(\'highlight-change\', false);\n\t\t},\n\n\t\t/**\n\t\t* 拖拽结束\n\t\t*/\n\t\thandleDragEnd(e) {\n\t\t\te.dataTransfer.clearData(this.type);\n\n\t\t\te.target.style.opacity = 1;\n\n\t\t\tif (eleDrag) {\n\t\t\t\tthis.$emit(\'sort-end\', [eleDrag.__START_INDEX__, eleDrag.__END_INDEX__]);\n\t\t\t}\n\n\t\t\teleDrag = null;\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-sortable {\n\tpadding: 0;\n\tbox-sizing: border-box;\n\tuser-select: none;\n\tposition: relative;\n\ttransition: opacity .5s; // 目的是让拖拽的那个元素保持不透明， 文档流里透明\n\t&:hover {\n\t\tcursor: move;\n\t}\n\t.vm-sortable__handle {\n\t\t&.is-active {\n\t\t\tpadding: 0;\n\t\t\ttop: 0;\n\t\t\tleft: 0;\n\t\t\tright: 0;\n\t\t\tbottom: 0;\n\t\t\tposition: absolute;\n\t\t\tz-index: 2;\n\t\t\tborder: 1px dotted #5495F6;\n\t\t\t// cursor: move;\n\t\t}\n\t}\n\t&.is-disabled {\n\t\tcursor: no-drop;\n\t}\n}\n.vm-sortable-disabled {\n\t&:hover {\n\t\tcursor: default;\n\t}\n}\n.vm-sortable__delete {\n\tbackground: #5495F6;\n\tposition: absolute;\n\tright: 0px;\n\twidth: 20px;\n\tcolor: white;\n\ttext-align: center;\n\tz-index: 300;\n\ttop: 0;\n\tright: 0px;\n\tcursor: pointer;\n}\n\n.vm-sortable__highlight {\n\theight: 55px;\n\tbackground: #E7F4FF;\n\tcolor: #5495F6;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tborder: 1px dotted #5495F6;\n}\n\n</style>\n',".vm-sortable {\n  padding: 0;\n  box-sizing: border-box;\n  user-select: none;\n  position: relative;\n  transition: opacity 0.5s;\n}\n.vm-sortable:hover {\n  cursor: move;\n}\n.vm-sortable .vm-sortable__handle.is-active {\n  padding: 0;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  position: absolute;\n  z-index: 2;\n  border: 1px dotted #5495F6;\n}\n.vm-sortable.is-disabled {\n  cursor: no-drop;\n}\n\n.vm-sortable-disabled:hover {\n  cursor: default;\n}\n\n.vm-sortable__delete {\n  background: #5495F6;\n  position: absolute;\n  right: 0px;\n  width: 20px;\n  color: white;\n  text-align: center;\n  z-index: 300;\n  top: 0;\n  right: 0px;\n  cursor: pointer;\n}\n\n.vm-sortable__highlight {\n  height: 55px;\n  background: #E7F4FF;\n  color: #5495F6;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  border: 1px dotted #5495F6;\n}\n\n/*# sourceMappingURL=sortable.vue.map */"]},media:void 0})}),W,void 0,!1,void 0,M,void 0),X={name:"vm-widget",props:{draggable:{type:Boolean,default:!0},module:{type:String,required:!0},index:{type:Number}},computed:{style:function(){return this.draggable?{cursor:"move"}:{}}},methods:{handleStart:function(t){t.dataTransfer.setData("@wya/vm",JSON.stringify({module:this.module,index:this.index}))}}},U=function(){var t=this,n=t.$createElement;return(t._self._c||n)("div",{style:t.style,attrs:{draggable:t.draggable},on:{dragstart:function(n){t.draggable&&t.handleStart(n)}}},[t._t("default")],2)};U._withStripped=!0;var P=k({render:U,staticRenderFns:[]},void 0,X,void 0,!1,void 0,void 0,void 0),L={name:"vm-tpl-viewer",components:{},props:{vm:{type:Object,default:function(){return{}}},id:String,x:Number,y:Number,z:Number,w:Number,h:Number,r:Number,name:[Number,String]},data:function(){return{}},computed:{},created:function(){},methods:{}},j=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{style:[{height:t.h?t.h+"px":"auto",width:t.w?t.w+"px":"auto",color:"black"}]},[t._v("\n\tid: "+t._s(t.id)+" "),e("br"),t._v("\n\tX: "+t._s(t.x)+" "),e("br"),t._v("\n\tY: "+t._s(t.y)+" "),e("br"),t._v("\n\tZ: "+t._s(t.z)+" "),e("br"),t._v("\n\tWidth: "+t._s(t.w?t.w:"auto")+" "),e("br"),t._v("\n\tHeight: "+t._s(t.h?t.h:"auto")+" "),e("br"),t._v("\n\tRotate: "+t._s(t.r)+" "),e("br"),t._v("\n\tName: "+t._s(t.name)+" "),e("br")])};j._withStripped=!0;var H=k({render:j,staticRenderFns:[]},(function(t){t&&t("data-v-f166bc66_0",{source:"\n\n/*# sourceMappingURL=viewer.vue.map */",map:{version:3,sources:["viewer.vue"],names:[],mappings:";;AAEA,qCAAqC",file:"viewer.vue"},media:void 0})}),L,"data-v-f166bc66",!1,void 0,M,void 0),I={name:"vm-tpl-editor",components:{},inheritAttrs:!1,props:{},data:function(){return{}},computed:{},created:function(){},methods:{handleChange:function(t,n){this.$emit("change",s({},n,t.target.value))},handleClick:function(){this.$emit("change",{x:this.x+1})}}},G=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticStyle:{display:"flex","flex-direction":"column"}},[e("div",[t._v("w: "),e("input",{domProps:{value:t.$attrs.w},on:{input:function(n){return t.handleChange(n,"w")}}})]),t._v(" "),e("div",[t._v("h: "),e("input",{domProps:{value:t.$attrs.h},on:{input:function(n){return t.handleChange(n,"h")}}})]),t._v(" "),e("div",[t._v("x: "),e("input",{domProps:{value:t.$attrs.x},on:{input:function(n){return t.handleChange(n,"x")}}})]),t._v(" "),e("div",[t._v("y: "),e("input",{domProps:{value:t.$attrs.y},on:{input:function(n){return t.handleChange(n,"y")}}})]),t._v(" "),e("div",[t._v("z: "),e("input",{domProps:{value:t.$attrs.z},on:{input:function(n){return t.handleChange(n,"z")}}})]),t._v(" "),e("div",[t._v("r: "),e("input",{domProps:{value:t.$attrs.r},on:{input:function(n){return t.handleChange(n,"r")}}})]),t._v(" "),e("div",[t._v("name: "),e("input",{domProps:{value:t.$attrs.name},on:{input:function(n){return t.handleChange(n,"name")}}})])])};G._withStripped=!0;var q={module:"tpl",type:"基础组件",name:"模版",Viewer:H,Editor:k({render:G,staticRenderFns:[]},(function(t){t&&t("data-v-2cf16f80_0",{source:"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/modules/tpl/editor.vue","editor.vue"],names:[],mappings:"AAkDA;EACA,sBAAA;EACA,YAAA;ACjDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div style="display: flex; flex-direction: column;">\n\t\t<div>w: <input :value="$attrs.w" @input="handleChange($event, \'w\')"></div>\n\t\t<div>h: <input :value="$attrs.h" @input="handleChange($event, \'h\')"></div>\n\t\t<div>x: <input :value="$attrs.x" @input="handleChange($event, \'x\')"></div>\n\t\t<div>y: <input :value="$attrs.y" @input="handleChange($event, \'y\')"></div>\n\t\t<div>z: <input :value="$attrs.z" @input="handleChange($event, \'z\')"></div>\n\t\t<div>r: <input :value="$attrs.r" @input="handleChange($event, \'r\')"></div>\n\t\t<div>name: <input :value="$attrs.name" @input="handleChange($event, \'name\')"></div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n\tname: \'vm-tpl-editor\',\n\tcomponents: {\n\t},\n\t// 以下两周都可行，相对的inheritAttrs比较好用的一点\n\tinheritAttrs: false,\n\tprops: {\n\t\t// w: Number,\n\t\t// h: Number,\n\t\t// r: Number,\n\t\t// x: Number,\n\t\t// y: Number,\n\t\t// z: Number,\n\t\t// name: [Number, String],\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\tcreated() {\n\t},\n\tmethods: {\n\t\thandleChange(e, key) {\n\t\t\tthis.$emit(\'change\', { [key]: e.target.value });\n\t\t},\n\t\thandleClick() {\n\t\t\t// this.$emit(\'update:x\', this.x + 1);\n\t\t\tthis.$emit(\'change\', { x: this.x + 1 });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\ninput {\n\tborder: 1px solid #000;\n\tmargin: 10px;\n}\n</style>\n',"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})}),I,void 0,!1,void 0,M,void 0),max:5,insertion:"",data:{w:200,h:150,r:0,x:0,y:0,z:1,parent:!1,closeable:!0,name:"名称"},dataValidity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.name?null:{error:"输入框内容必填"}}},K={name:"vm-tpl-viewer",components:{},props:{vm:{type:Object,default:function(){return{}}},id:String,x:Number,y:Number,z:Number,w:Number,h:Number,r:Number,name:[Number,String]},data:function(){return{}},computed:{},created:function(){},methods:{}},V=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{style:[{height:t.h?t.h+"px":"auto",width:t.w?t.w+"px":"auto",color:"black"}]},[t._v("\n\tid: "+t._s(t.id)+" "),e("br"),t._v("\n\tX: "+t._s(t.x)+" "),e("br"),t._v("\n\tY: "+t._s(t.y)+" "),e("br"),t._v("\n\tZ: "+t._s(t.z)+" "),e("br"),t._v("\n\tWidth: "+t._s(t.w?t.w:"auto")+" "),e("br"),t._v("\n\tHeight: "+t._s(t.h?t.h:"auto")+" "),e("br"),t._v("\n\tRotate: "+t._s(t.r)+" "),e("br"),t._v("\n\tName: "+t._s(t.name)+" "),e("br")])};V._withStripped=!0;var J=k({render:V,staticRenderFns:[]},(function(t){t&&t("data-v-a7673120_0",{source:"\n\n/*# sourceMappingURL=viewer.vue.map */",map:{version:3,sources:["viewer.vue"],names:[],mappings:";;AAEA,qCAAqC",file:"viewer.vue"},media:void 0})}),K,void 0,!1,void 0,M,void 0),Z={name:"vm-array-editor",components:{},inheritAttrs:!1,props:{},data:function(){return{}},computed:{},created:function(){},methods:{handleChange:function(t,n){this.$emit("change",s({},n,t.target.value))},handleClick:function(){this.$emit("change",{x:this.x+1})}}},Q=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticStyle:{display:"flex","flex-direction":"column"}},[e("div",[t._v("w: "),e("input",{domProps:{value:t.$attrs.w},on:{input:function(n){return t.handleChange(n,"w")}}})]),t._v(" "),e("div",[t._v("h: "),e("input",{domProps:{value:t.$attrs.h},on:{input:function(n){return t.handleChange(n,"h")}}})]),t._v(" "),e("div",[t._v("x: "),e("input",{domProps:{value:t.$attrs.x},on:{input:function(n){return t.handleChange(n,"x")}}})]),t._v(" "),e("div",[t._v("y: "),e("input",{domProps:{value:t.$attrs.y},on:{input:function(n){return t.handleChange(n,"y")}}})]),t._v(" "),e("div",[t._v("z: "),e("input",{domProps:{value:t.$attrs.z},on:{input:function(n){return t.handleChange(n,"z")}}})]),t._v(" "),e("div",[t._v("r: "),e("input",{domProps:{value:t.$attrs.r},on:{input:function(n){return t.handleChange(n,"r")}}})]),t._v(" "),e("div",[t._v("name: "),e("input",{domProps:{value:t.$attrs.name},on:{input:function(n){return t.handleChange(n,"name")}}})])])};Q._withStripped=!0;var tt={tpl:q,array:{module:"array",type:"营销组件",name:"数组模版",widgets:[{render:function(t,n){return t("div",["一行两列"])}},{name:"一行两列",image:"https://avatars3.githubusercontent.com/u/34465004?s=200&v=4"}],Viewer:J,Editor:k({render:Q,staticRenderFns:[]},(function(t){t&&t("data-v-7c4434dc_0",{source:"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/modules/array/editor.vue","editor.vue"],names:[],mappings:"AAkDA;EACA,sBAAA;EACA,YAAA;ACjDA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div style="display: flex; flex-direction: column;">\n\t\t<div>w: <input :value="$attrs.w" @input="handleChange($event, \'w\')"></div>\n\t\t<div>h: <input :value="$attrs.h" @input="handleChange($event, \'h\')"></div>\n\t\t<div>x: <input :value="$attrs.x" @input="handleChange($event, \'x\')"></div>\n\t\t<div>y: <input :value="$attrs.y" @input="handleChange($event, \'y\')"></div>\n\t\t<div>z: <input :value="$attrs.z" @input="handleChange($event, \'z\')"></div>\n\t\t<div>r: <input :value="$attrs.r" @input="handleChange($event, \'r\')"></div>\n\t\t<div>name: <input :value="$attrs.name" @input="handleChange($event, \'name\')"></div>\n\t</div>\n</template>\n\n<script>\n\nexport default {\n\tname: \'vm-array-editor\',\n\tcomponents: {\n\t},\n\t// 以下两周都可行，相对的inheritAttrs比较好用的一点\n\tinheritAttrs: false,\n\tprops: {\n\t\t// w: Number,\n\t\t// h: Number,\n\t\t// r: Number,\n\t\t// x: Number,\n\t\t// y: Number,\n\t\t// z: Number,\n\t\t// name: [Number, String],\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\tcreated() {\n\t},\n\tmethods: {\n\t\thandleChange(e, key) {\n\t\t\tthis.$emit(\'change\', { [key]: e.target.value });\n\t\t},\n\t\thandleClick() {\n\t\t\t// this.$emit(\'update:x\', this.x + 1);\n\t\t\tthis.$emit(\'change\', { x: this.x + 1 });\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\ninput {\n\tborder: 1px solid #000;\n\tmargin: 10px;\n}\n</style>\n',"input {\n  border: 1px solid #000;\n  margin: 10px;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})}),Z,void 0,!1,void 0,M,void 0),max:5,insertion:"",data:function(t){return{w:200,h:150,r:0,x:0,y:0,z:1,parent:!1,closeable:!0,name:"名称".concat(t)}},dataValidity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t.name?null:{error:"输入框内容必填"}}}},nt={name:"vm-assist-operation",components:{},props:{total:Number,current:Number,isEdit:Boolean},data:function(){return{}},computed:{},watch:{},created:function(){},methods:{handleUndo:function(){this.$emit("undo")},handleRedo:function(){this.$emit("redo")},handleDelete:function(){this.$emit("delete")}}},et=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-assist-operation vm-hack-editor"},[e("div",{class:{disabled:0===t.current},on:{click:t.handleUndo}},[t._v("←")]),t._v(" "),e("div",{class:{disabled:t.current===t.total},on:{click:t.handleRedo}},[t._v("→")]),t._v(" "),e("div",{class:{disabled:!t.isEdit},on:{click:t.handleDelete}},[t._v("✕")]),t._v(" "),e("span",[t._v("\n\t\tcur: "+t._s(t.current)+"\n\t\tlast: "+t._s(t.total)+"\n\t")])])};et._withStripped=!0;var it=k({render:et,staticRenderFns:[]},void 0,nt,void 0,!1,void 0,void 0,void 0),rt={name:"vm-assist-save",components:{},props:{},data:function(){return{}},computed:{},watch:{},created:function(){},methods:{}},at=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-assist-save vm-hack-editor"},[e("div",{on:{click:function(n){return t.$emit("save")}}},[t._v("保存")]),t._v(" "),e("div",{on:{click:function(n){return t.$emit("preview")}}},[t._v("预览")])])};at._withStripped=!0;var st=k({render:at,staticRenderFns:[]},void 0,rt,void 0,!1,void 0,void 0,void 0),ot={name:"vm-assist-preview",components:{},props:{dataSource:Array,mode:String,frameW:Number},data:function(){return{vm:{type:"preview"}}},computed:{isDraggable:function(){return"draggable"===this.mode},mult:function(){return void 0===this.frameW?1:window.innerWidth/this.frameW}}},lt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-assist-preview"},[e("div",{staticStyle:{position:"relative"}},t._l(t.dataSource,(function(n){return e("div",{key:n.id,style:t.isDraggable?{position:"absolute",width:n.w?n.w*t.mult+"px":"auto",height:n.h?n.h*t.mult+"px":"auto",left:n.x*t.mult+"px",top:n.y*t.mult+"px",transform:"rotate("+n.r+"deg)"}:{}},[e("vm-"+n.module+"-viewer",t._b({tag:"component",attrs:{vm:t.vm}},"component",n,!1))],1)})),0)])};lt._withStripped=!0;var dt=k({render:lt,staticRenderFns:[]},void 0,ot,void 0,!1,void 0,void 0,void 0),At={name:"vm-preview",components:{},props:{dataSource:Array,css:{type:Object,default:function(){return{style:{},className:""}}},animate:{type:String,default:"vm-fade"},mask:{type:Boolean,default:!0},mode:{type:String,default:"draggable"}},data:function(){return{visible:!1,transform:"translate(-100px, -100px)"}},computed:{isDraggable:function(){return"draggable"===this.mode}},watch:{},mounted:function(){this.visible=!0},updated:function(){},methods:{handleClose:function(){var t=this;this.visible=!1,setTimeout((function(){t.$emit("close")}),300)}}},ct=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-assist-preview-popup"},[t.mask?e("transition",{attrs:{name:t.animate}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-assist-preview-popup__mask",on:{click:t.handleClose}})]):t._e(),t._v(" "),t.mask?e("transition",{attrs:{name:t.animate}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-assist-preview-popup__close",on:{click:t.handleClose}},[t._v("✕")])]):t._e(),t._v(" "),e("transition",{attrs:{name:t.animate}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"vm-assist-preview-popup__content"},[e("vm-preview",{attrs:{"data-source":t.dataSource,mode:t.mode}})],1)])],1)};ct._withStripped=!0;var mt={Operation:it,Save:st,Preview:dt,PreviewPopup:k({render:ct,staticRenderFns:[]},(function(t){t&&t("data-v-a13571ac_0",{source:".vm-assist-preview-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 999;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n}\n.vm-assist-preview-popup__mask {\n  position: absolute;\n  z-index: 997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, .2);\n  -webkit-transition: opacity 0.2s;\n  transition: opacity 0.2s;\n}\n.vm-assist-preview-popup__content {\n  position: relative;\n  z-index: 998;\n  overflow: auto;\n  max-height: 100vh;\n  max-width: 100vw;\n  -webkit-transition: opacity 0.2s, -webkit-transform 0.2s;\n  transition: opacity 0.2s, -webkit-transform 0.2s;\n  transition: transform 0.2s, opacity 0.2s;\n  transition: transform 0.2s, opacity 0.2s, -webkit-transform 0.2s;\n}\n.vm-assist-preview-popup__close {\n  position: absolute;\n  right: 30px;\n  top: 30px;\n  font-size: 24px;\n  z-index: 999;\n}\n.vm-fade-enter, .vm-fade-leave-active {\n  opacity: 0;\n}\n\n/*# sourceMappingURL=popup.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/assist/preview/popup.vue","popup.vue"],names:[],mappings:"AA2EA;EACA,eAAA;EACA,MAAA;EACA,QAAA;EACA,OAAA;EACA,SAAA;EACA,YAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;AC1EA;AD4EA;EACA,kBAAA;EACA,YAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,mCAAA;EAEA,gCAAA;EAAA,wBAAA;AC1EA;AD4EA;EACA,kBAAA;EACA,YAAA;EACA,cAAA;EACA,iBAAA;EACA,gBAAA;EACA,wDAAA;EAAA,gDAAA;EAAA,wCAAA;EAAA,gEAAA;ACzEA;AD2EA;EACA,kBAAA;EACA,WAAA;EACA,SAAA;EACA,eAAA;EACA,YAAA;ACxEA;AD0EA;EACA,UAAA;ACvEA;;AAEA,oCAAoC",file:"popup.vue",sourcesContent:['<template>\n\t<div class="vm-assist-preview-popup">\n\t\t<transition v-if="mask" :name="animate" >\n\t\t\t<div v-show="visible" class="vm-assist-preview-popup__mask" @click="handleClose" />\n\t\t</transition>\n\t\t<transition v-if="mask" :name="animate" >\n\t\t\t<div v-show="visible" class="vm-assist-preview-popup__close" @click="handleClose">&#10005;</div>\n\t\t</transition>\n\t\t<transition :name="animate">\n\t\t\t<div v-show="visible" class="vm-assist-preview-popup__content">\n\t\t\t\t<vm-preview \n\t\t\t\t\t:data-source="dataSource" \n\t\t\t\t\t:mode="mode"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</transition>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-preview\',\n\tcomponents: {\n\t\t\n\t},\n\tprops: {\n\t\tdataSource: Array,\n\t\tcss: {\n\t\t\ttype: Object,\n\t\t\tdefault: () => ({ style: {}, className: "" })\n\t\t},\n\t\tanimate: {\n\t\t\ttype: String,\n\t\t\tdefault: \'vm-fade\'\n\t\t},\n\t\tmask: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tmode: {\n\t\t\ttype: String,\n\t\t\tdefault: \'draggable\'\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvisible: false,\n\t\t\ttransform: `translate(-100px, -100px)`\n\t\t};\n\t},\n\tcomputed: {\n\t\tisDraggable() {\n\t\t\treturn this.mode === \'draggable\';\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tmounted() {\n\t\tthis.visible = true;\n\t},\n\tupdated() {\n\t},\n\tmethods: {\n\t\thandleClose() {\n\t\t\tthis.visible = false;\n\t\t\tsetTimeout(() => {\n\t\t\t\tthis.$emit(\'close\');\n\t\t\t}, 300); // 动画时间\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-assist-preview-popup {\n\tposition: fixed;\n\ttop: 0;\n\tright: 0;\n\tleft: 0;\n\tbottom: 0;\n\tz-index: 999;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n}\n.vm-assist-preview-popup__mask {\n\tposition: absolute;\n\tz-index: 997;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tbackground-color: rgba(#000, 0.2);\n\t// opacity: 0;\n\ttransition: opacity 0.2s;\n}\n.vm-assist-preview-popup__content {\n\tposition: relative;\n\tz-index: 998;\n\toverflow: auto; // 区域之外不形式\n\tmax-height: 100vh; \n\tmax-width: 100vw; \n\ttransition: transform 0.2s, opacity 0.2s;\n}\n.vm-assist-preview-popup__close {\n\tposition: absolute;\n\tright: 30px; \n\ttop: 30px;\n\tfont-size: 24px;\n\tz-index: 999;\n}\n.vm-fade-enter, .vm-fade-leave-active {\n\topacity: 0;\n}\n</style>\n',".vm-assist-preview-popup {\n  position: fixed;\n  top: 0;\n  right: 0;\n  left: 0;\n  bottom: 0;\n  z-index: 999;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.vm-assist-preview-popup__mask {\n  position: absolute;\n  z-index: 997;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.2);\n  transition: opacity 0.2s;\n}\n\n.vm-assist-preview-popup__content {\n  position: relative;\n  z-index: 998;\n  overflow: auto;\n  max-height: 100vh;\n  max-width: 100vw;\n  transition: transform 0.2s, opacity 0.2s;\n}\n\n.vm-assist-preview-popup__close {\n  position: absolute;\n  right: 30px;\n  top: 30px;\n  font-size: 24px;\n  z-index: 999;\n}\n\n.vm-fade-enter, .vm-fade-leave-active {\n  opacity: 0;\n}\n\n/*# sourceMappingURL=popup.vue.map */"]},media:void 0})}),At,void 0,!1,void 0,M,void 0)};function ht(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function pt(t){for(var n=arguments,e=1;e<arguments.length;e++){var i=null!=n[e]?n[e]:{};e%2?ht(i,!0).forEach((function(n){s(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):ht(i).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}var ut={name:"vm-combo",components:{"vm-assist-operation":mt.Operation,"vm-assist-save":mt.Save},model:{prop:"data-source",event:"change"},props:{width:Number,height:Number,dataSource:{type:Array,default:function(){return[]}},frameStyle:Object,frameW:Number,frameH:Number,frameOpts:Object,widgetStyle:Object,widgetContentStyle:Object,widgetW:Number,widgetH:Number,widgetOpts:Object,theme:{type:String,default:"default"},showAssist:{type:Boolean,default:!1},showWidget:{type:Boolean,default:!0},showEditor:{type:Boolean,default:!0},showLines:{type:Boolean,default:!0},showRuler:{type:Boolean,default:!0},showZoomBar:{type:Boolean,default:!0},showThumbnail:{type:Boolean,default:!0}},data:function(){return{editor:null,pageEditor:null,current:0,total:0,rebuildData:[],rebuildFrameW:0,rebuildFrameH:0}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}},classes:function(){return s({},"vm-combo__theme--".concat(this.theme),!!this.theme)}},watch:{dataSource:{deep:!0,immediate:!0,handler:function(t){a.isEqualWith(t,this.rebuildData)||(this.rebuildData=this.makeRebuildData(this.dataSource),this.rebuildSpecialComp(this.rebuildData),this.resetEditor(this.editor))}},pageEditor:{deep:!0,immediate:!0,handler:function(t){this.rebuildFrameW=t&&t.w?t.w:this.frameW,this.rebuildFrameH=t&&t.h?t.h:this.frameH}}},created:function(){this.historyData=[]},destroyed:function(){this.$options.previewManager.destroy()},methods:{rebuildSpecialComp:function(t){var n=this;if(!t.length)return{};var e={};return t.forEach((function(t){"page"===t.module&&(n.pageEditor=t),e[t.module]=t})),e},makeRebuildData:function(t){var n=this.$options.modules;return a.cloneDeep(t).map((function(t){var e=n[t.module]||{},i=e.data,r=void 0===i?{}:i,a=e.rebuilder,s=void 0===a?{}:a;return"function"==typeof r&&(r=r()),"function"==typeof s&&(s=s()),Object.keys(t).forEach((function(n){s[n]&&(t[n]instanceof Array?t[n]=t[n].map((function(t){return pt({},s[n],{},t)})):t[n]instanceof Object&&(t[n]=pt({},s[n],{},t[n])))})),pt({},r,{},t)}))},sync:function(t){for(var n in t)this[n]!=t[n]&&this.$emit("update:".concat(n),t[n])},syncData:function(){this.$emit("change",this.rebuildData),this.$emit("update:data-source",this.rebuildData)},resetEditor:function(t){this.editor=t||this.pageEditor||null},handleActivated:function(t){this.editor=t},handleDeactivated:function(){this.editor=this.pageEditor||null},handleWidgetChange:function(t){for(var n=arguments,e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=n[r];this.$emit.apply(this,["widget-change",t].concat(i))},handleChange:function(t){var n=t.type,e=t.id,i=t.index,r=t.old,s=t.sort;n&&(s||e)||console.error("[wya-vm/combo]: id, type is required");var o=this.current,l=this.total,d={type:n,id:e,old:r,sort:s,index:e&&void 0===i?this.rebuildData.findIndex((function(t){return t.id===e})):i,data:a.cloneDeep(this.rebuildData.find((function(t){return t.id===e})))};o===l?this.historyData.push(d):this.historyData.splice(o,l-o,d);var A=this.historyData.length;this.current=A,this.total=A,"delete"===n&&(this.rebuildData.splice(d.index,1),this.resetEditor()),this.syncData()},handleOperate:function(t){for(var n=arguments,e=arguments.length,i=new Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=n[r];this[t]&&this[t].apply(this,i)},add:function(t,n){this.$refs.frame.handleDrop({fake:!0,dataTransfer:{getData:function(){return JSON.stringify({module:t,index:n})}}},!0)},delete:function(t){(t=t||(this.editor||{}).id)?this.handleChange({type:"delete",id:t}):this.$emit("error",{type:"id",msg:"请先选择操作对象"})},undo:function(){var t=this.current-1;if(t<0)this.$emit("error",{type:"undo",msg:"目前已经是初始状态"});else{this.current=t;var n=this.historyData[this.current]||{},e=n.type,i=n.id,r=n.data,s=n.index,o=n.old,l=n.sort;switch(e){case"create":this.rebuildData.splice(s,1);break;case"delete":this.rebuildData.splice(s,0,r);break;case"update":this.rebuildData.splice(s,1,a.cloneDeep(pt({},r,{},o)));break;case"sort":this.$refs.frame.sortData(l)}this.editor&&this.editor.id===i&&this.resetEditor(this.rebuildData[s]),this.syncData()}},redo:function(){var t=this.current+1;if(t>this.total)this.$emit("error",{type:"undo",msg:"目前已经是最终状态"});else{this.current=t;var n=this.historyData[this.current-1],e=n.type,i=n.id,r=n.data,a=n.index,s=n.sort;switch(e){case"create":this.rebuildData.splice(a,1,r);break;case"delete":this.rebuildData.splice(a,1);break;case"update":this.rebuildData.splice(a,1,r);break;case"sort":this.$refs.frame.sortData(s)}this.editor&&this.editor.id===i&&this.resetEditor(this.rebuildData[a]),this.syncData()}},save:function(){var t=a.cloneDeep(this.rebuildData)||[];if(0===t.length)return this.$emit("error",{type:"save",msg:"保存对象不能为空"}),!1;for(var n=this.$options.modules,e=0;e<t.length;e++){var i=t[e].module;if(n[i].dataValidity){var r=n[i].dataValidity(t[e]);if(r)return this.$emit("error",{type:"save",msg:"第".concat(e+1,"个 - ").concat(r.error),index:e}),this.$refs.frame.setActived(e),!1}}return this.$emit("save",t),!0},preview:function(){return 0===this.rebuildData.length?(this.$emit("error",{type:"preview",msg:"预览数据对象不能为空"}),!1):(this.$options.previewManager.popup({dataSource:a.cloneDeep(this.rebuildData),style:pt({},this.frameStyle,{width:0===this.frameW?"auto":"".concat(this.frameW,"px"),height:0===this.frameH?"auto":"".concat(this.frameH,"px")}),className:"vm-combo__frame"}),!0)}}},gt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-combo",class:t.classes,style:t.style},[t.showWidget?e("vm-widget",t._b({style:t.widgetStyle,attrs:{"content-style":t.widgetContentStyle},on:{change:t.handleWidgetChange}},"vm-widget",t.widgetOpts,!1)):t._e(),t._v(" "),e("vm-frame",t._b({ref:"frame",attrs:{"frame-style":t.frameStyle,width:t.rebuildFrameW,height:t.rebuildFrameH,"data-source":t.rebuildData,editor:t.editor,"show-lines":t.showLines,"show-ruler":t.showRuler,"show-zoom-bar":t.showZoomBar,"show-thumbnail":t.showThumbnail},on:{activated:t.handleActivated,deactivated:t.handleDeactivated,change:t.handleChange,error:function(n){return t.$emit("error",arguments[0])}}},"vm-frame",t.frameOpts,!1),[t._t("frame-header"),t._v(" "),t._t("frame-footer")],2),t._v(" "),t.showEditor&&t.editor?e("vm-editor",{attrs:{"data-source":t.editor},on:{change:t.handleChange}}):t._e(),t._v(" "),t.showAssist?e("vm-assist-save",{on:{save:function(n){return t.handleOperate("save")},preview:function(n){return t.handleOperate("preview")}}}):t._e(),t._v(" "),t.showAssist?e("vm-assist-operation",{attrs:{current:t.current,total:t.total,"is-edit":!!t.editor},on:{undo:function(n){return t.handleOperate("undo")},redo:function(n){return t.handleOperate("redo")},delete:function(n){return t.handleOperate("delete")}}}):t._e()],1)};gt._withStripped=!0;var ft=k({render:gt,staticRenderFns:[]},(function(t){t&&t("data-v-52bf9aa7_0",{source:".vm-combo {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n}\n\n/*# sourceMappingURL=combo.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/combo.vue","combo.vue"],names:[],mappings:"AA6eA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;AC5eA;;AAEA,oCAAoC",file:"combo.vue",sourcesContent:["<template>\n\t<div :style=\"style\" :class=\"classes\" class=\"vm-combo\">\n\t\t<vm-widget \n\t\t\tv-if=\"showWidget\"\n\t\t\t:style=\"widgetStyle\" \n\t\t\t:content-style=\"widgetContentStyle\" \n\t\t\tv-bind=\"widgetOpts\"\n\t\t\t@change=\"handleWidgetChange\"\n\t\t/>\n\t\t<vm-frame \n\t\t\tref=\"frame\"\n\t\t\t:frame-style=\"frameStyle\" \n\t\t\t:width=\"rebuildFrameW\" \n\t\t\t:height=\"rebuildFrameH\" \n\t\t\t:data-source=\"rebuildData\" \n\t\t\t:editor=\"editor\" \n\t\t\t:show-lines=\"showLines\"\n\t\t\t:show-ruler=\"showRuler\"\n\t\t\t:show-zoom-bar=\"showZoomBar\"\n\t\t\t:show-thumbnail=\"showThumbnail\"\n\t\t\tv-bind=\"frameOpts\"\n\t\t\t@activated=\"handleActivated\"\n\t\t\t@deactivated=\"handleDeactivated\"\n\t\t\t@change=\"handleChange\"\n\t\t\t@error=\"$emit('error', arguments[0])\"\n\t\t>\n\t\t\t<slot name=\"frame-header\" />\n\t\t\t<slot name=\"frame-footer\" />\n\t\t</vm-frame>\n\t\t\x3c!--  vue.sync遇到引用类型可跨层级修改，Object/Array. 如Object, 不要操作对象，把每个值解构出来v-bind.sync. --\x3e\n\t\t<vm-editor \n\t\t\tv-if=\"showEditor && editor\"\n\t\t\t:data-source=\"editor\"\n\t\t\t@change=\"handleChange\"\n\t\t/>\n\t\t<vm-assist-save\n\t\t\tv-if=\"showAssist\"\n\t\t\t@save=\"handleOperate('save')\"\n\t\t\t@preview=\"handleOperate('preview')\"\n\t\t/>\n\t\t<vm-assist-operation\n\t\t\tv-if=\"showAssist\"\n\t\t\t:current=\"current\"\n\t\t\t:total=\"total\"\n\t\t\t:is-edit=\"!!editor\"\n\t\t\t@undo=\"handleOperate('undo')\"\n\t\t\t@redo=\"handleOperate('redo')\"\n\t\t\t@delete=\"handleOperate('delete')\"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nimport { Assist } from './assist';\nimport { cloneDeep, isEqualWith } from '../utils/helper';\n\nexport default {\n\tname: 'vm-combo',\n\tcomponents: {\n\t\t// 会被注入vm-frame, vm-widget, vm-editor,\n\t\t'vm-assist-operation': Assist.Operation,\n\t\t'vm-assist-save': Assist.Save,\n\t},\n\tmodel: {\n\t\tprop: 'data-source',\n\t\tevent: 'change'\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([])\n\t\t},\n\t\t/**\n\t\t * frame\n\t\t */\n\t\tframeStyle: Object,\n\t\tframeW: Number,\n\t\tframeH: Number,\n\t\tframeOpts: Object,\n\t\t/**\n\t\t * widget\n\t\t */\n\t\twidgetStyle: Object,\n\t\twidgetContentStyle: Object,\n\t\twidgetW: Number,\n\t\twidgetH: Number,\n\t\twidgetOpts: Object,\n\n\t\t/**\n\t\t * combo\n\t\t */\n\t\ttheme: {\n\t\t\ttype: String,\n\t\t\tdefault: 'default'\n\t\t},\n\t\tshowAssist: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\tshowWidget: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowEditor: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowLines: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowRuler: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowZoomBar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowThumbnail: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\teditor: null,\n\t\t\tpageEditor: null,\n\t\t\t/**\n\t\t\t * vm-assist-operation\n\t\t\t */\n\t\t\tcurrent: 0,\n\t\t\ttotal: 0,\n\n\t\t\trebuildData: [],\n\n\t\t\trebuildFrameW: 0,\n\t\t\trebuildFrameH: 0\n\t\t};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = this.width === 0 ? 'auto' : `${this.width}px`;\n\t\t\tconst h = this.height === 0 ? 'auto' : `${this.height}px`;\n\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t},\n\t\tclasses() {\n\t\t\treturn {\n\t\t\t\t[`vm-combo__theme--${this.theme}`]: !!this.theme\n\t\t\t};\n\t\t}\n\t},\n\twatch: {\n\t\tdataSource: {\n\t\t\tdeep: true,\n\t\t\timmediate: true,\n\t\t\thandler(v) {\n\n\t\t\t\tif (isEqualWith(v, this.rebuildData)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// todo, 是否重写\n\t\t\t\tthis.rebuildData = this.makeRebuildData(this.dataSource);\n\n\t\t\t\t// 特殊组件， 如页面设置, 设置PageEditor\n\t\t\t\tthis.rebuildSpecialComp(this.rebuildData);\n\n\t\t\t\t// 初始化编辑状态\n\t\t\t\tthis.resetEditor(this.editor);\n\t\t\t}\n\t\t},\n\t\tpageEditor: {\n\t\t\tdeep: true,\n\t\t\timmediate: true,\n\t\t\thandler(v) {\n\t\t\t\tthis.rebuildFrameW = v && v.w ? v.w : this.frameW;\n\t\t\t\tthis.rebuildFrameH = v && v.h ? v.h : this.frameH;\n\t\t\t}\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.historyData = [];\n\t},\n\tdestroyed() {\n\t\tthis.$options.previewManager.destroy();\n\t},\n\tmethods: {\n\t\t/**\n\t\t *  组件要具有唯一性，否者会异常\n\t\t * page组件处理（页面设置）,\n\t\t * 其他\n\t\t */\n\t\trebuildSpecialComp(source) {\n\t\t\tif (!source.length) return {};\n\t\t\tlet kv = {};\n\n\t\t\tsource.forEach(item => {\n\t\t\t\t// page组件\n\t\t\t\titem.module === 'page' && (this.pageEditor = item);\n\t\t\t\tkv[item.module] = item;\n\t\t\t});\n\n\t\t\treturn kv;\n\t\t},\n\n\t\tmakeRebuildData(source) {\n\t\t\tlet { modules } = this.$options;\n\t\t\tlet result = cloneDeep(source).map((it) => {\n\t\t\t\tlet { data = {}, rebuilder = {} } = modules[it.module] || {};\n\n\t\t\t\ttypeof data === 'function' && (data = data());\n\t\t\t\ttypeof rebuilder === 'function' && (rebuilder = rebuilder());\n\n\t\t\t\t// TODO: 深度遍历，目前仅一层\n\t\t\t\tObject.keys(it).forEach(key => {\n\t\t\t\t\tif (!rebuilder[key]) return;\n\t\t\t\t\tif (it[key] instanceof Array) {\n\t\t\t\t\t\tit[key] = it[key].map((children) => {\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t...rebuilder[key],\n\t\t\t\t\t\t\t\t...children\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (it[key] instanceof Object) {\n\t\t\t\t\t\tit[key] = {\n\t\t\t\t\t\t\t...rebuilder[key],\n\t\t\t\t\t\t\t...it[key]\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn {\n\t\t\t\t\t...data,\n\t\t\t\t\t...it\n\t\t\t\t};\n\t\t\t});\n\t\t\treturn result;\n\t\t},\n\t\t/**\n\t\t * 目前只支持以下几种数据\n\t\t * current, total\n\t\t */\n\t\tsync(opts) {\t\n\t\t\tfor (let key in opts) {\n\t\t\t\tif (this[key] != opts[key]) {\n\t\t\t\t\tthis.$emit(`update:${key}`, opts[key]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsyncData() {\n\t\t\tthis.$emit('change', this.rebuildData);\n\t\t\tthis.$emit('update:data-source', this.rebuildData);\n\t\t},\n\n\t\tresetEditor(it) {\n\t\t\tthis.editor = it || this.pageEditor || null;\n\t\t},\n\t\t/**\n\t\t * draggable\n\t\t */\n\t\thandleActivated(it) {\n\t\t\tthis.editor = it;\n\t\t},\n\n\t\thandleDeactivated() {\n\t\t\tthis.editor = this.pageEditor || null;\n\t\t},\n\n\t\t/**\n\t\t * 用户处理widget出来的数据, 暂时做不到记忆\n\t\t * TODO: 可能被废弃\n\t\t */\n\t\thandleWidgetChange(module, ...rest) {\n\t\t\tthis.$emit('widget-change', module, ...rest);\n\t\t},\n\n\t\t/**\n\t\t * 数据变化\n\t\t */\n\t\thandleChange({ type, id, index, old, sort }) {\n\t\t\tif (!type || (!sort && !id)) {\n\t\t\t\tconsole.error('[wya-vm/combo]: id, type is required');\n\t\t\t}\n\t\t\tconst { current, total } = this;\n\t\t\tconst target = {\n\t\t\t\ttype,\n\t\t\t\tid,\n\t\t\t\told,\n\t\t\t\tsort,\n\t\t\t\tindex: id && typeof index === 'undefined' \n\t\t\t\t\t? this.rebuildData.findIndex(item => item.id === id) \n\t\t\t\t\t: index,\n\t\t\t\tdata: cloneDeep(this.rebuildData.find(item => item.id === id)),\n\t\t\t};\n\n\t\t\t// 继续插入，还是以当前停留位置插入\n\t\t\tcurrent === total \n\t\t\t\t? this.historyData.push(target)\n\t\t\t\t: this.historyData.splice(current, total - current, target);\n\n\t\t\tlet { length } = this.historyData;\n\t\t\tthis.current = length;\n\t\t\tthis.total = length;\n\t\t\t\n\t\t\ttype === 'delete' && (\n\t\t\t\tthis.rebuildData.splice(target.index, 1), \n\t\t\t\tthis.resetEditor()\n\t\t\t);\n\n\t\t\tthis.syncData();\n\t\t},\n\n\t\t/**\n\t\t * widget-operation\n\t\t */\n\t\thandleOperate(type, ...rest) {\n\t\t\tthis[type] && this[type](...rest);\n\t\t},\n\n\t\t/**\n\t\t * 模拟添加\n\t\t */\n\t\tadd(module, index) {\n\t\t\tthis.$refs.frame.handleDrop({\n\t\t\t\tfake: true,\n\t\t\t\tdataTransfer: {\n\t\t\t\t\tgetData: () => {\n\t\t\t\t\t\treturn JSON.stringify({\n\t\t\t\t\t\t\tmodule,\n\t\t\t\t\t\t\tindex\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, true);\n\t\t},\n\n\t\t/**\n\t\t * 删除\n\t\t */\n\t\tdelete(id) {\n\t\t\tid = id || (this.editor || {}).id;\n\t\t\tif (!id) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'id', \n\t\t\t\t\tmsg: \"请先选择操作对象\" \n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.handleChange({ type: 'delete', id });\n\t\t},\n\n\t\tundo() {\n\t\t\tlet current = this.current - 1;\n\t\t\tif (current < 0) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'undo', \n\t\t\t\t\tmsg: \"目前已经是初始状态\" \n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.current = current;\n\n\t\t\tlet { type, id, data, index, old, sort } = this.historyData[this.current] || {};\n\t\t\tswitch (type) {\n\t\t\t\tcase 'create':\n\t\t\t\t\tthis.rebuildData.splice(index, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\tthis.rebuildData.splice(index, 0, data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'update':\t\n\t\t\t\t\tthis.rebuildData.splice(index, 1, cloneDeep({ ...data, ...old }));\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sort':\t\n\t\t\t\t\tthis.$refs.frame.sortData(sort);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (this.editor && this.editor.id === id) {\n\t\t\t\tthis.resetEditor(this.rebuildData[index]);\n\t\t\t}\n\n\t\t\tthis.syncData();\n\t\t},\n\n\t\tredo() {\n\t\t\tlet current = this.current + 1;\n\t\t\tif (current > this.total) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'undo', \n\t\t\t\t\tmsg: \"目前已经是最终状态\" \n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.current = current;\n\n\t\t\tlet { type, id, data, index, sort } = this.historyData[this.current - 1];\n\t\t\tswitch (type) {\n\t\t\t\tcase 'create':\n\t\t\t\t\tthis.rebuildData.splice(index, 1, data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'delete':\n\t\t\t\t\tthis.rebuildData.splice(index, 1);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'update':\t\n\t\t\t\t\tthis.rebuildData.splice(index, 1, data);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'sort':\t\n\t\t\t\t\tthis.$refs.frame.sortData(sort);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (this.editor && this.editor.id === id) {\n\t\t\t\tthis.resetEditor(this.rebuildData[index]);\n\t\t\t}\n\n\t\t\tthis.syncData();\n\t\t},\n\n\t\t/**\n\t\t * widget-save\n\t\t */\n\t\tsave() {\n\t\t\tconst data = cloneDeep(this.rebuildData) || [];\n\n\t\t\tif (data.length === 0) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'save', \n\t\t\t\t\tmsg: `保存对象不能为空` \n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconst { modules } = this.$options;\n\t\t\tfor (let i = 0; i < data.length; i++) {\n\t\t\t\tlet { module: mod } = data[i];\n\t\t\t\tif (modules[mod].dataValidity) {\n\t\t\t\t\tlet error = modules[mod].dataValidity(data[i]);\n\t\t\t\t\tif (error) {\n\t\t\t\t\t\tthis.$emit('error', { \n\t\t\t\t\t\t\ttype: 'save', \n\t\t\t\t\t\t\tmsg: `第${i + 1}个 - ${error.error}`, \n\t\t\t\t\t\t\tindex: i \n\t\t\t\t\t\t});\n\t\t\t\t\t\t// 错误元素激活\n\t\t\t\t\t\tthis.$refs.frame.setActived(i);\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t/**\n\t\t\t * 数据验证\n\t\t\t */\n\t\t\tthis.$emit('save', data);\n\t\t\treturn true;\n\t\t},\n\n\t\tpreview() {\n\t\t\tif (this.rebuildData.length === 0) {\n\t\t\t\tthis.$emit('error', { \n\t\t\t\t\ttype: 'preview', \n\t\t\t\t\tmsg: `预览数据对象不能为空` \n\t\t\t\t});\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tthis.$options.previewManager.popup({\n\t\t\t\tdataSource: cloneDeep(this.rebuildData),\n\t\t\t\tstyle: {\n\t\t\t\t\t...this.frameStyle,\n\t\t\t\t\twidth: this.frameW === 0 ? 'auto' : `${this.frameW}px`,\n\t\t\t\t\theight: this.frameH === 0 ? 'auto' : `${this.frameH}px`\n\t\t\t\t},\n\t\t\t\tclassName: 'vm-combo__frame'\n\t\t\t});\n\n\t\t\treturn true;\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n.vm-combo {\n\tdisplay: flex;\n}\n</style>\n",".vm-combo {\n  display: flex;\n}\n\n/*# sourceMappingURL=combo.vue.map */"]},media:void 0})}),ut,void 0,!1,void 0,M,void 0),vt={name:"vm-grid-lines",components:{},props:{width:Number,height:Number,grid:{type:Array,default:function(){return[10,10]}}},data:function(){return{}},computed:{xArr:function(){var t=this,n=Math.floor(this.width/this.grid[0]);return Array.from({length:n},(function(n,e){return e*t.grid[0]}))},yArr:function(){var t=this,n=Math.floor(this.height/this.grid[1]);return Array.from({length:n},(function(n,e){return e*t.grid[1]}))}},watch:{},created:function(){},methods:{}},bt=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-grid-lines"},[this._l(this.yArr,(function(t){return n("div",{key:"y_"+t,staticClass:"vm-grid-lines__y",style:{top:t+"px"}})})),this._v(" "),this._l(this.xArr,(function(t){return n("div",{key:"x_"+t,staticClass:"vm-grid-lines__x",style:{left:t+"px"}})}))],2)};bt._withStripped=!0;var xt=k({render:bt,staticRenderFns:[]},(function(t){t&&t("data-v-02acb640_0",{source:".vm-grid-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n.vm-grid-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #d6d6d6;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.vm-grid-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #d6d6d6;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/*# sourceMappingURL=grid-lines.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/grid-lines.vue","grid-lines.vue"],names:[],mappings:"AA4DA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;AC3DA;AD6DA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,0BAAA;EACA,8BAAA;UAAA,sBAAA;AC1DA;AD4DA;EACA,kBAAA;EACA,MAAA;EACA,WAAA;EACA,WAAA;EACA,qBAAA;EACA,wBAAA;EACA,yBAAA;EACA,8BAAA;UAAA,sBAAA;ACzDA;;AAEA,yCAAyC",file:"grid-lines.vue",sourcesContent:['<template>\n\t<div class="vm-grid-lines">\n\t\t<div \n\t\t\tv-for="item in yArr" \n\t\t\t:key="`y_${item}`" \n\t\t\t:style="{top: `${item}px`}"  \n\t\t\tclass="vm-grid-lines__y"\n\t\t/>\n\t\t<div \n\t\t\tv-for="item in xArr" \n\t\t\t:key="`x_${item}`" \n\t\t\t:style="{left: `${item}px`}"  \n\t\t\tclass="vm-grid-lines__x"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-grid-lines\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tgrid: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => {\n\t\t\t\treturn [10, 10];\n\t\t\t}\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t\txArr() {\n\t\t\tlet length = Math.floor(this.width / this.grid[0]);\n\t\t\treturn Array.from({ length }, (v, i) => i * this.grid[0]);\n\t\t},\n\t\tyArr() {\n\t\t\tlet length = Math.floor(this.height / this.grid[1]);\n\t\t\treturn Array.from({ length }, (v, i) => i * this.grid[1]);\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-grid-lines {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: hidden;\n\tz-index: 0;\n}\n.vm-grid-lines__x {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 1px;\n\theight: 100%;\n\tborder-left-width: 1px;\n\tborder-left-style: dotted;\n\tborder-left-color: rgb(214, 214, 214);\n\tbox-sizing: border-box;\n}\n.vm-grid-lines__y {\n\tposition: absolute;\n\ttop: 0;\n\twidth: 100%;\n\theight: 1px;\n\tborder-top-width: 1px;\n\tborder-top-style: dotted;\n\tborder-top-color: rgb(214, 214, 214); \n\tbox-sizing: border-box;\n}\n</style>\n',".vm-grid-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n\n.vm-grid-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #d6d6d6;\n  box-sizing: border-box;\n}\n\n.vm-grid-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #d6d6d6;\n  box-sizing: border-box;\n}\n\n/*# sourceMappingURL=grid-lines.vue.map */"]},media:void 0})}),vt,void 0,!1,void 0,M,void 0),yt={name:"vm-align-lines",components:{},props:{dataSource:{type:Array,default:function(){return[]}},editor:Object},data:function(){return{}},computed:{alignData:function(){var t=this;if(this.dataSource.length<=1||!this.editor)return{xArr:[],yArr:[]};var n=this.editor||{},e=n.x,i=n.y,r=n.w,a=n.h,s=[e,e+r/2,e+r],l=[i,i+a/2,i+a],d=this.dataSource.reduce((function(n){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.x,r=e.y,a=e.w,s=e.h,l=e.id;if(l!==t.editor.id){var d=[i,i+a/2,i+a],A=[r,r+s/2,r+s];n.xArr=[].concat(o(n.xArr),d),n.yArr=[].concat(o(n.yArr),A)}return n}),{xArr:[],yArr:[]});return{xArr:s.filter((function(t){return d.xArr.includes(t)})),yArr:l.filter((function(t){return d.yArr.includes(t)}))}}},watch:{},created:function(){},methods:{}},wt=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-align-lines"},[this._l(this.alignData.yArr,(function(t){return n("div",{key:"y_"+t,staticClass:"vm-align-lines__y",style:{top:t+"px"}})})),this._v(" "),this._l(this.alignData.xArr,(function(t){return n("div",{key:"x_"+t,staticClass:"vm-align-lines__x",style:{left:t+"px"}})}))],2)};wt._withStripped=!0;var Et=k({render:wt,staticRenderFns:[]},(function(t){t&&t("data-v-1c8b90fd_0",{source:".vm-align-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n.vm-align-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #1fb6ff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n.vm-align-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #1fb6ff;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n}\n\n/*# sourceMappingURL=align-lines.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/align-lines.vue","align-lines.vue"],names:[],mappings:"AA+EA;EACA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,gBAAA;EACA,UAAA;AC9EA;ADgFA;EACA,kBAAA;EACA,OAAA;EACA,UAAA;EACA,YAAA;EACA,sBAAA;EACA,yBAAA;EACA,0BAAA;EACA,8BAAA;UAAA,sBAAA;AC7EA;AD+EA;EACA,kBAAA;EACA,MAAA;EACA,WAAA;EACA,WAAA;EACA,qBAAA;EACA,wBAAA;EACA,yBAAA;EACA,8BAAA;UAAA,sBAAA;AC5EA;;AAEA,0CAA0C",file:"align-lines.vue",sourcesContent:['<template>\n\t<div class="vm-align-lines">\n\t\t<div \n\t\t\tv-for="item in alignData.yArr" \n\t\t\t:key="`y_${item}`" \n\t\t\t:style="{top: `${item}px`}"  \n\t\t\tclass="vm-align-lines__y"\n\t\t/>\n\t\t<div \n\t\t\tv-for="item in alignData.xArr" \n\t\t\t:key="`x_${item}`" \n\t\t\t:style="{left: `${item}px`}"  \n\t\t\tclass="vm-align-lines__x"\n\t\t/>\n\t</div>\n</template>\n\n<script>\nexport default {\n\tname: \'vm-align-lines\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault: () => ([])\n\t\t},\n\t\teditor: Object\n\t},\n\tdata() {\n\t\treturn {\n\t\t};\n\t},\n\tcomputed: {\n\t\talignData() {\n\t\t\tif (this.dataSource.length <= 1 || !this.editor) {\n\t\t\t\treturn {\n\t\t\t\t\txArr: [],\n\t\t\t\t\tyArr: []\n\t\t\t\t};\n\t\t\t}\n\t\t\tconst { x, y, w, h } = this.editor || {};\n\t\t\tlet xArr = [x, x + w / 2, x + w];\n\t\t\tlet yArr = [y, y + h / 2, y + h];\n\n\t\t\tlet xyObj = this.dataSource.reduce((result, itemData = {}) => {\n\n\t\t\t\tconst { x, y, w, h, id } = itemData;\n\t\t\t\tif (id !== this.editor.id) {\n\t\t\t\t\tlet xArr = [x, x + w / 2, x + w];\n\t\t\t\t\tlet yArr = [y, y + h / 2, y + h];\n\t\t\t\t\tresult.xArr = [...result.xArr, ...xArr];\n\t\t\t\t\tresult.yArr = [...result.yArr, ...yArr];\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}, {\n\t\t\t\txArr: [],\n\t\t\t\tyArr: []\n\t\t\t});\n\t\t\treturn {\n\t\t\t\txArr: xArr.filter(item => xyObj.xArr.includes(item)),\n\t\t\t\tyArr: yArr.filter(item => xyObj.yArr.includes(item))\n\t\t\t};\n\t\t}\n\t},\n\twatch: {\n\t\t\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\n\t},\n};\n<\/script>\n\n<style lang="scss">\n.vm-align-lines {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\toverflow: hidden;\n\tz-index: 0;\n}\n.vm-align-lines__x {\n\tposition: absolute;\n\tleft: 0;\n\twidth: 1px;\n\theight: 100%;\n\tborder-left-width: 1px;\n\tborder-left-style: dotted;\n\tborder-left-color: #1fb6ff;\n\tbox-sizing: border-box;\n}\n.vm-align-lines__y {\n\tposition: absolute;\n\ttop: 0;\n\twidth: 100%;\n\theight: 1px;\n\tborder-top-width: 1px;\n\tborder-top-style: dotted;\n\tborder-top-color: #1fb6ff; \n\tbox-sizing: border-box;\n}\n</style>\n',".vm-align-lines {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  overflow: hidden;\n  z-index: 0;\n}\n\n.vm-align-lines__x {\n  position: absolute;\n  left: 0;\n  width: 1px;\n  height: 100%;\n  border-left-width: 1px;\n  border-left-style: dotted;\n  border-left-color: #1fb6ff;\n  box-sizing: border-box;\n}\n\n.vm-align-lines__y {\n  position: absolute;\n  top: 0;\n  width: 100%;\n  height: 1px;\n  border-top-width: 1px;\n  border-top-style: dotted;\n  border-top-color: #1fb6ff;\n  box-sizing: border-box;\n}\n\n/*# sourceMappingURL=align-lines.vue.map */"]},media:void 0})}),yt,void 0,!1,void 0,M,void 0),Ct={name:"vm-ruler",components:{},props:{scrollTop:{type:Number,default:0},scrollLeft:{type:Number,default:0},frameW:{type:Number,default:0},frameH:{type:Number,default:0},scale:{type:Number,default:1},guides:Array,borderSize:Number},data:function(){return{interval:100*this.scale,guideSize:20,showGuide:!0,showGuideX:!1,showGuideY:!1,mouseX:0,mouseY:0,offsetX:0,offsetY:0,linesX:[],linesY:[],movingAxias:"",movingIndex:-1}},computed:{canvasW:function(){return Math.max(this.frameW*this.scale,this.frameH*this.scale,7e3)},placeholderW:function(){return this.borderSize+this.guideSize}},watch:{frameW:function(){this.refreshCanvas()},frameH:function(){this.refreshCanvas()},scale:function(t){this.interval=this.interval*t,this.refreshCanvas()},linesX:{deep:!0,handler:function(){this.$emit("guides-change",[this.linesX,this.linesY])}},linesY:{deep:!0,handler:function(){this.$emit("guides-change",[this.linesX,this.linesY])}}},mounted:function(){var t=this;this.$nextTick((function(){t.canvas=[t.$refs.canvasX,t.$refs.canvasY],t.offsetX=t.$refs.x.getBoundingClientRect().x,t.offsetY=t.$refs.y.getBoundingClientRect().y,t.refreshCanvas(),window.addEventListener("mouseup",t.handleMouseUp),window.addEventListener("mousemove",t.handleMouseMove)}))},destroyed:function(){window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mousemove",this.handleMouseMove)},methods:{refreshCanvas:function(){var t=this;this.canvas.forEach((function(n){return t.repaint(n)}))},repaint:function(t){if(this._isMounted){t.height=t.height;var n=this.canvasW,e=this.guideSize,i=this.placeholderW,r=this.interval,a=t.getContext("2d");a.beginPath(),a.fillStyle="#474747",a.fillRect(0,0,n,e),a.translate(i,0),a.fillStyle="#615E5B",a.save();for(var s=0;s<n/r;s++)a.fillStyle="#615E5B",a.translate(s*r,0),a.fillRect(0,0,1,e),a.restore(),a.save(),a.fillStyle="#8C8D89",a.font="12px",a.fillText(100*s,s*r+4,e/5*3);a.restore(),a.translate(0,e-3),a.save();for(var o=0;o<n/r*10;o++)o%10!=0&&(a.translate(o*r/10,0),a.fillRect(0,0,1,3),a.restore(),a.save())}},handleShowGuideX:function(t){var n=this.offsetX,e=this.placeholderW,i=this.scrollLeft,r=this.scale;this.$refs.x.contains(t.target)&&!l.$(t.target).hasClass("is-solid")?(this.showGuideX=!0,this.mouseX=Math.floor((t.clientX-n-e+i)/r)):this.showGuideX=!1},handleShowGuideY:function(t){var n=this.offsetY,e=this.placeholderW,i=this.scrollTop,r=this.scale;this.$refs.y.contains(t.target)&&!l.$(t.target).hasClass("is-solid")?(this.showGuideY=!0,this.mouseY=Math.floor((t.clientY-n-e+i)/r)):this.showGuideY=!1},handleAddLineX:function(){!this.linesX.includes(this.mouseX)&&this.linesX.push(this.mouseX)},handleAddLineY:function(){!this.linesY.includes(this.mouseY)&&this.linesY.push(this.mouseY)},handleMouseDown:function(t,n){this.isMousePress=!0,this.movingIndex=n,this.movingAxias=t},handleMouseUp:function(){this.isMousePress=!1},handleMouseMove:function(t){if(this.isMousePress){var n=this.offsetX,e=this.offsetY,i=this.placeholderW,r=this.scrollLeft,a=this.scrollTop,s=this.scale;"x"!==this.movingAxias?"y"!==this.movingAxias||this.$set(this.linesY,this.movingIndex,Math.floor((t.clientY-e-i+a)/s)):this.$set(this.linesX,this.movingIndex,Math.floor((t.clientX-n-i+r)/s))}}}},_t=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-ruler"},[e("div",{staticClass:"vm-ruler__guide",style:{width:t.guideSize+"px",height:t.guideSize+"px"},attrs:{title:"单击"+(t.showGuide?"隐藏":"显示")+"辅助线"},on:{click:function(n){t.showGuide=!t.showGuide}}}),t._v(" "),e("div",{ref:"x",staticClass:"vm-ruler__x",style:{transform:"translateX("+-t.scrollLeft+"px)"},on:{mousemove:t.handleShowGuideX,mouseleave:function(n){t.showGuideX=!1}}},[e("canvas",{ref:"canvasX",attrs:{width:t.canvasW,height:t.guideSize}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showGuideX,expression:"showGuideX"}],ref:"guideX",staticClass:"vm-ruler__guide-x",style:{left:t.mouseX*t.scale+t.placeholderW+"px"},on:{click:function(n){return n.stopPropagation(),t.handleAddLineX(n)}}},[e("span",[t._v("\n\t\t\t\t"+t._s(t.mouseX)+"\n\t\t\t")])]),t._v(" "),t.showGuide?t._l(t.linesX,(function(n,i){return e("div",{key:i,staticClass:"vm-ruler__guide-x is-solid",style:{left:n*t.scale+t.placeholderW+"px"},attrs:{title:"双击删除参考线"},on:{mousedown:function(n){return n.stopPropagation(),t.handleMouseDown("x",i)},dblclick:function(n){return t.linesX.splice(i,1)}}},[e("span",[t._v("\n\t\t\t\t\t"+t._s(n)+"\n\t\t\t\t")])])})):t._e()],2),t._v(" "),e("div",{staticClass:"vm-ruler__wrapper"},[e("div",{staticClass:"vm-ruler__y"},[e("div",{ref:"y",staticClass:"vm-ruler__y-rotate",style:{transform:"rotate(90deg) translateX("+-t.scrollTop+"px)"},on:{mousemove:t.handleShowGuideY,mouseleave:function(n){t.showGuideY=!1}}},[e("canvas",{ref:"canvasY",attrs:{width:t.canvasW,height:t.guideSize}}),t._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showGuideY,expression:"showGuideY"}],staticClass:"vm-ruler__guide-y",style:{left:t.mouseY*t.scale+t.placeholderW+"px"},on:{click:function(n){return n.stopPropagation(),t.handleAddLineY(n)}}},[e("span",[t._v("\n\t\t\t\t\t\t"+t._s(t.mouseY)+"\n\t\t\t\t\t")])]),t._v(" "),t.showGuide?t._l(t.linesY,(function(n,i){return e("div",{key:i,staticClass:"vm-ruler__guide-y is-solid",style:{left:n*t.scale+t.placeholderW+"px"},attrs:{title:"双击删除参考线"},on:{mousedown:function(n){return n.stopPropagation(),t.handleMouseDown("y",i)},dblclick:function(n){return t.linesY.splice(i,1)}}},[e("span",[t._v("\n\t\t\t\t\t\t\t"+t._s(n)+"\n\t\t\t\t\t\t")])])})):t._e()],2)]),t._v(" "),t._t("default")],2)])};_t._withStripped=!0;var $t=k({render:_t,staticRenderFns:[]},(function(t){t&&t("data-v-df1337c8_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-ruler {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  height: 100%;\n  position: relative;\n}\n.vm-ruler__x {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  position: relative;\n  z-index: 2;\n}\n.vm-ruler__wrapper {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  height: 100%;\n}\n.vm-ruler__y {\n  height: 100%;\n  width: 20px;\n  z-index: 2;\n}\n.vm-ruler__y-rotate {\n  -webkit-transform-origin: 0 100% 0;\n      -ms-transform-origin: 0 100% 0;\n          transform-origin: 0 100% 0;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  position: relative;\n  margin-top: -39px;\n}\n.vm-ruler__guide {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  background: #535353;\n  cursor: pointer;\n  z-index: 3;\n}\n.vm-ruler__guide-x {\n  position: absolute;\n  height: 100vh;\n  top: 0;\n  border-left: 1px dashed rgba(0, 173, 255, .84);\n  padding-left: 5px;\n  cursor: ew-resize;\n}\n.vm-ruler__guide-x > span {\n  position: absolute;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n  -webkit-justify-content: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  -webkit-box-shadow: 0 0 5px -3px #000;\n          box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, .7);\n}\n.vm-ruler__guide-x.is-solid {\n  border-left: 1px solid rgba(0, 173, 255, .84);\n}\n.vm-ruler__guide-y {\n  -webkit-transform: rotate(-90deg);\n      -ms-transform: rotate(-90deg);\n          transform: rotate(-90deg);\n  -webkit-transform-origin: 0 100% 0;\n      -ms-transform-origin: 0 100% 0;\n          transform-origin: 0 100% 0;\n  position: absolute;\n  width: 100vw;\n  top: 20px;\n  border-bottom: 1px dashed rgba(0, 173, 255, .84);\n  padding-bottom: 5px;\n  cursor: ns-resize;\n}\n.vm-ruler__guide-y > span {\n  -webkit-transform: rotate(90deg);\n      -ms-transform: rotate(90deg);\n          transform: rotate(90deg);\n  -webkit-transform-origin: 0 0 0;\n      -ms-transform-origin: 0 0 0;\n          transform-origin: 0 0 0;\n  position: absolute;\n  left: 20px;\n  top: 5px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  -webkit-box-shadow: 0 0 5px -3px #000;\n          box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, .7);\n}\n.vm-ruler__guide-y.is-solid {\n  border-bottom: 1px solid rgba(0, 173, 255, .84);\n}\n\n/*# sourceMappingURL=ruler.vue.map */",map:{version:3,sources:["ruler.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/ruler.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;ECuRA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,YAAA;EACA,kBAAA;ADrRA;AACA;ECsRA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,kBAAA;EACA,UAAA;ADpRA;AAEA;ECqRA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,YAAA;ADnRA;AAEA;ECoRA,YAAA;EACA,WAAA;EACA,UAAA;ADlRA;AAEA;ECmRA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,kBAAA;EACA,iBAAA;ADjRA;AAEA;ECmRA,kBAAA;EACA,MAAA;EACA,OAAA;EACA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,eAAA;EACA,UAAA;ADjRA;AAEA;ECoRA,kBAAA;EACA,aAAA;EACA,MAAA;EACA,8CAAA;EACA,iBAAA;EACA,iBAAA;ADlRA;ACmRA;EACA,kBAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,wBAAA;EAAA,+BAAA;MAAA,qBAAA;UAAA,uBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,WAAA;EACA,cAAA;EACA,iBAAA;EACA,kBAAA;EACA,qCAAA;UAAA,6BAAA;EACA,kCA1DA;ADvNA;AACA;ECmRA,6CAAA;ADjRA;AAEA;ECqRA,iCAAA;MAAA,6BAAA;UAAA,yBAAA;EACA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;EACA,kBAAA;EACA,YAAA;EACA,SAAA;EACA,gDAAA;EACA,mBAAA;EACA,iBAAA;ADnRA;ACoRA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;EACA,+BAAA;MAAA,2BAAA;UAAA,uBAAA;EACA,kBAAA;EACA,UAAA;EACA,QAAA;EACA,yBAAA;KAAA,sBAAA;MAAA,qBAAA;UAAA,iBAAA;EACA,WAAA;EACA,cAAA;EACA,iBAAA;EACA,kBAAA;EACA,qCAAA;UAAA,6BAAA;EACA,kCAvFA;AD3LA;AACA;ECoRA,+CAAA;ADlRA;;AAEA,oCAAoC",file:"ruler.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-ruler {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n}\n.vm-ruler__x {\n  display: flex;\n  position: relative;\n  z-index: 2;\n}\n\n.vm-ruler__wrapper {\n  display: flex;\n  height: 100%;\n}\n\n.vm-ruler__y {\n  height: 100%;\n  width: 20px;\n  z-index: 2;\n}\n\n.vm-ruler__y-rotate {\n  transform-origin: 0 100% 0;\n  display: flex;\n  position: relative;\n  margin-top: -39px;\n}\n\n.vm-ruler__guide {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 20px;\n  height: 20px;\n  background: #535353;\n  cursor: pointer;\n  z-index: 3;\n}\n\n.vm-ruler__guide-x {\n  position: absolute;\n  height: 100vh;\n  top: 0;\n  border-left: 1px dashed rgba(0, 173, 255, 0.84);\n  padding-left: 5px;\n  cursor: ew-resize;\n}\n.vm-ruler__guide-x > span {\n  position: absolute;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, 0.7);\n}\n.vm-ruler__guide-x.is-solid {\n  border-left: 1px solid rgba(0, 173, 255, 0.84);\n}\n\n.vm-ruler__guide-y {\n  transform: rotate(-90deg);\n  transform-origin: 0 100% 0;\n  position: absolute;\n  width: 100vw;\n  top: 20px;\n  border-bottom: 1px dashed rgba(0, 173, 255, 0.84);\n  padding-bottom: 5px;\n  cursor: ns-resize;\n}\n.vm-ruler__guide-y > span {\n  transform: rotate(90deg);\n  transform-origin: 0 0 0;\n  position: absolute;\n  left: 20px;\n  top: 5px;\n  user-select: none;\n  color: #fff;\n  padding: 0 4px;\n  line-height: 20px;\n  border-radius: 1px;\n  box-shadow: 0 0 5px -3px #000;\n  background: rgba(64, 116, 180, 0.7);\n}\n.vm-ruler__guide-y.is-solid {\n  border-bottom: 1px solid rgba(0, 173, 255, 0.84);\n}\n\n/*# sourceMappingURL=ruler.vue.map */",'<template>\n\t<div class="vm-ruler">\n\t\t\x3c!-- 坐标原点，定位 --\x3e\n\t\t<div\n\t\t\t:style="{\n\t\t\t\twidth: `${guideSize}px`,\n\t\t\t\theight: `${guideSize}px`,\n\t\t\t}"\n\t\t\t:title="`单击${showGuide ? \'隐藏\' : \'显示\'}辅助线`"\n\t\t\tclass="vm-ruler__guide"\n\t\t\t@click="showGuide = !showGuide"\n\t\t/>\n\t\t\x3c!-- x轴 --\x3e\n\t\t<div \n\t\t\tref="x"\n\t\t\t:style="{ transform: `translateX(${-scrollLeft}px)` }"\n\t\t\tclass="vm-ruler__x"\n\t\t\t@mousemove="handleShowGuideX"\n\t\t\t@mouseleave="showGuideX = false"\n\t\t>\n\t\t\t<canvas\n\t\t\t\tref="canvasX"\n\t\t\t\t:width="canvasW"\n\t\t\t\t:height="guideSize"\n\t\t\t/>\n\t\t\t\x3c!-- X虚线 --\x3e\n\t\t\t<div\n\t\t\t\tv-show="showGuideX"\n\t\t\t\tref="guideX"\n\t\t\t\t:style="{ left: `${mouseX * scale + placeholderW}px`}"\n\t\t\t\tclass="vm-ruler__guide-x"\n\t\t\t\t@click.stop="handleAddLineX"\n\t\t\t>\n\t\t\t\t<span>\n\t\t\t\t\t{{ mouseX }}\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t\t\x3c!-- X实线 --\x3e\n\t\t\t<template v-if="showGuide">\n\t\t\t\t<div\n\t\t\t\t\tv-for="(item, index) in linesX"\n\t\t\t\t\t:key="index"\n\t\t\t\t\t:style="{\n\t\t\t\t\t\tleft: `${item * scale + placeholderW}px`,\n\t\t\t\t\t}"\n\t\t\t\t\ttitle="双击删除参考线"\n\t\t\t\t\tclass="vm-ruler__guide-x is-solid"\n\t\t\t\t\t@mousedown.stop="handleMouseDown(\'x\', index)"\n\t\t\t\t\t@dblclick="linesX.splice(index, 1)"\n\t\t\t\t>\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{{ item }}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</template>\n\t\t</div>\n\t\t<div class="vm-ruler__wrapper">\n\t\t\t<div class="vm-ruler__y">\n\t\t\t\t<div\n\t\t\t\t\tref="y"\n\t\t\t\t\t:style="{\n\t\t\t\t\t\ttransform: `rotate(90deg) translateX(${-scrollTop}px)`,\n\t\t\t\t\t}"\n\t\t\t\t\tclass="vm-ruler__y-rotate"\n\t\t\t\t\t@mousemove="handleShowGuideY"\n\t\t\t\t\t@mouseleave="showGuideY = false"\n\t\t\t\t>\n\t\t\t\t\t<canvas\n\t\t\t\t\t\tref="canvasY"\n\t\t\t\t\t\t:width="canvasW"\n\t\t\t\t\t\t:height="guideSize"\n\t\t\t\t\t/>\n\t\t\t\t\t\n\t\t\t\t\t\x3c!-- Y虚线 --\x3e\n\t\t\t\t\t<div\n\t\t\t\t\t\tv-show="showGuideY"\n\t\t\t\t\t\t:style="{\n\t\t\t\t\t\t\tleft: `${mouseY * scale + placeholderW}px`,\n\t\t\t\t\t\t}"\n\t\t\t\t\t\tclass="vm-ruler__guide-y"\n\t\t\t\t\t\t@click.stop="handleAddLineY"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t{{ mouseY }}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t\n\t\t\t\t\t\x3c!-- Y实线 --\x3e\n\t\t\t\t\t<template v-if="showGuide">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tv-for="(item, index) in linesY"\n\t\t\t\t\t\t\t:key="index"\n\t\t\t\t\t\t\t:style="{\n\t\t\t\t\t\t\t\tleft: `${item * scale + placeholderW}px`,\n\t\t\t\t\t\t\t}"\n\t\t\t\t\t\t\tclass="vm-ruler__guide-y is-solid"\n\t\t\t\t\t\t\ttitle="双击删除参考线"\n\t\t\t\t\t\t\t@mousedown.stop="handleMouseDown(\'y\', index)"\n\t\t\t\t\t\t\t@dblclick="linesY.splice(index, 1)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span>\n\t\t\t\t\t\t\t\t{{ item }}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<slot />\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { $ } from \'@wya/utils\';\n\nexport default {\n\tname: \'vm-ruler\',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tscrollTop: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tscrollLeft: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tframeW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tframeH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\t\tguides: Array,\n\t\tborderSize: Number\n\t},\n\tdata() {\n\t\treturn {\n\t\t\t// 10刻度间隔(缩放后)\n\t\t\tinterval: 100 * this.scale,\n\t\t\t// 辅助线开关区域宽高\n\t\t\tguideSize: 20,\n\n\t\t\t// 是否显示鼠标移动的X/Y轴辅助线 (虚线)\n\t\t\tshowGuide: true,\n\t\t\tshowGuideX: false,\n\t\t\tshowGuideY: false,\n\t\t\t// 鼠标在X/Y轴的坐标\n\t\t\tmouseX: 0,\n\t\t\tmouseY: 0,\n\t\t\t// 横轴起始X/Y位置\n\t\t\toffsetX: 0,\n\t\t\toffsetY: 0,\n\n\t\t\t// X/Y轴辅助线 (实线)\n\t\t\tlinesX: [],\n\t\t\tlinesY: [],\n\n\t\t\tmovingAxias: \'\',\n\t\t\tmovingIndex: -1,\n\t\t};\n\t},\n\tcomputed: {\n\t\t// 刻度的宽度, 5000用于滚动距离避免重绘\n\t\tcanvasW() {\n\t\t\treturn Math.max(\n\t\t\t\tthis.frameW * this.scale, \n\t\t\t\tthis.frameH * this.scale, \n\t\t\t\t7000\n\t\t\t);\n\t\t},\n\t\t// 0刻度距离轴容器左边的距离\n\t\tplaceholderW() {\n\t\t\treturn this.borderSize + this.guideSize;\n\t\t},\n\t},\n\twatch: {\n\t\tframeW() {\n\t\t\tthis.refreshCanvas();\n\t\t},\n\t\tframeH() {\n\t\t\tthis.refreshCanvas();\n\t\t},\n\t\tscale(v) {\n\t\t\tthis.interval = this.interval * v;\n\t\t\tthis.refreshCanvas();\n\t\t},\n\t\tlinesX: {\n\t\t\tdeep: true,\n\t\t\thandler() {\n\t\t\t\tthis.$emit(\'guides-change\', [this.linesX, this.linesY]);\n\t\t\t}\n\t\t},\n\t\tlinesY: {\n\t\t\tdeep: true,\n\t\t\thandler() {\n\t\t\t\tthis.$emit(\'guides-change\', [this.linesX, this.linesY]);\n\t\t\t}\n\t\t}\n\t},\n\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\tthis.canvas = [this.$refs.canvasX, this.$refs.canvasY];\n\t\t\tthis.offsetX = this.$refs.x.getBoundingClientRect().x;\n\t\t\tthis.offsetY = this.$refs.y.getBoundingClientRect().y;\n\t\t\tthis.refreshCanvas();\n\n\t\t\t// 辅助线抬起/移动事件\n\t\t\twindow.addEventListener(\'mouseup\', this.handleMouseUp);\n\t\t\twindow.addEventListener(\'mousemove\', this.handleMouseMove);\n\t\t});\n\t},\n\n\tdestroyed() {\n\t\twindow.removeEventListener(\'mouseup\', this.handleMouseUp);\n\t\twindow.removeEventListener(\'mousemove\', this.handleMouseMove);\n\t},\n\n\tmethods: {\n\t\trefreshCanvas() {\n\t\t\tthis.canvas.forEach(canvas => this.repaint(canvas));\n\t\t},\n\n\t\t/**\n\t\t * 轴距离容器左边有20px的间距和辅助线开关区域的宽度\n\t\t */\n\t\trepaint(canvas) {\n\t\t\tif (!this._isMounted) return;\n\t\t\t\n\t\t\tcanvas.height = canvas.height; // 重设高度，清空画布\n\n\t\t\tlet { canvasW, guideSize, placeholderW, interval } = this;\n\t\t\tlet ctx = canvas.getContext(\'2d\');\n\n\t\t\tctx.beginPath();\n\t\t\tctx.fillStyle = \'#474747\';\n\t\t\tctx.fillRect(0, 0, canvasW, guideSize);\n\t\t\tctx.translate(placeholderW, 0); // (20, 0)坐标开始画10刻度线\n\t\t\tctx.fillStyle = "#615E5B";\n\t\t\tctx.save();\n\t\t\tfor (let i = 0; i < canvasW / interval; i++) {\n\t\t\t\t// 画刻度线\n\t\t\t\tctx.fillStyle = "#615E5B";\n\t\t\t\tctx.translate(i * interval, 0);\n\t\t\t\tctx.fillRect(0, 0, 1, guideSize);\n\t\t\t\tctx.restore();\n\t\t\t\tctx.save();\n\t\t\t\t// 返回画刻度数字\n\t\t\t\tctx.fillStyle = "#8C8D89";\n\t\t\t\tctx.font = "12px";\n\t\t\t\t// 文字在轴内的 3/5 位置\n\t\t\t\tctx.fillText(i * 100, i * interval + 4, guideSize / 5 * 3);\n\t\t\t}\n\t\t\t// 还原到 (20, 0)坐标\n\t\t\tctx.restore();\n\t\t\t// 移到 (20, 17)坐标\n\t\t\tctx.translate(0, guideSize - 3);\n\t\t\tctx.save(); // (20, 17)坐标开始画1刻度线\n\t\t\tfor (let i = 0; i < canvasW / interval * 10; i++) {\n\t\t\t\tif (i % 10 !== 0) {\n\t\t\t\t\tctx.translate(i * interval / 10, 0);\n\t\t\t\t\tctx.fillRect(0, 0, 1, 3);\n\t\t\t\t\tctx.restore();\n\t\t\t\t\tctx.save();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 参考X虚线显示\n\t\t */\n\t\thandleShowGuideX(e) {\n\t\t\tconst { offsetX, placeholderW, scrollLeft, scale } = this;\n\t\t\tif (\n\t\t\t\tthis.$refs.x.contains(e.target)\n\t\t\t\t&& !$(e.target).hasClass(\'is-solid\')\n\t\t\t) {\n\t\t\t\tthis.showGuideX = true;\n\t\t\t\tthis.mouseX = Math.floor((e.clientX - offsetX - placeholderW + scrollLeft) / scale);\n\t\t\t} else {\n\t\t\t\tthis.showGuideX = false;\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 参考Y虚线显示\n\t\t */\n\t\thandleShowGuideY(e) {\n\t\t\tconst { offsetY, placeholderW, scrollTop, scale } = this;\n\t\t\tif (\n\t\t\t\tthis.$refs.y.contains(e.target) \n\t\t\t\t&& !$(e.target).hasClass(\'is-solid\')\n\t\t\t) {\n\t\t\t\tthis.showGuideY = true;\n\t\t\t\tthis.mouseY = Math.floor((e.clientY - offsetY - placeholderW + scrollTop) / scale);\n\t\t\t} else {\n\t\t\t\tthis.showGuideY = false;\n\t\t\t}\n\t\t},\n\n\t\thandleAddLineX() {\n\t\t\t!this.linesX.includes(this.mouseX) && this.linesX.push(this.mouseX);\n\t\t},\n\n\t\thandleAddLineY() {\n\t\t\t!this.linesY.includes(this.mouseY) && this.linesY.push(this.mouseY);\n\t\t},\n\n\t\t// 鼠标按下事件\n\t\thandleMouseDown(axias, index) {\n\t\t\tthis.isMousePress = true;\n\t\t\tthis.movingIndex = index;\n\t\t\tthis.movingAxias = axias;\n\t\t},\n\n\t\t// 鼠标放手事件\n\t\thandleMouseUp() {\n\t\t\tthis.isMousePress = false;\n\t\t},\n\n\t\thandleMouseMove(e) {\n\t\t\tif (!this.isMousePress) return;\n\t\t\tconst { offsetX, offsetY, placeholderW, scrollLeft, scrollTop, scale } = this;\n\t\t\tif (this.movingAxias === \'x\') {\n\t\t\t\tthis.$set(\n\t\t\t\t\tthis.linesX, \n\t\t\t\t\tthis.movingIndex, \n\t\t\t\t\tMath.floor((e.clientX - offsetX - placeholderW + scrollLeft) / scale),\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tif (this.movingAxias === \'y\') {\n\t\t\t\tthis.$set(\n\t\t\t\t\tthis.linesY, \n\t\t\t\t\tthis.movingIndex, \n\t\t\t\t\tMath.floor((e.clientY - offsetY - placeholderW + scrollTop) / scale),\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t},\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-ruler;\n$blue-guide: rgba(0,173,255,.84);\n$blue-label: rgba(64, 116, 180, .7);\n\n@include block($block) {\n\tdisplay: flex; \n\tflex-direction: column;\n\theight: 100%;\n\tposition: relative;\n\t@include element(x) {\n\t\tdisplay: flex; \n\t\tposition: relative;\n\t\tz-index: 2;\n\t}\n\t@include element(wrapper) {\n\t\tdisplay: flex; \n\t\theight: 100%\n\t}\n\t@include element(y) {\n\t\theight: 100%; \n\t\twidth: 20px;\n\t\tz-index: 2;\n\t}\n\t@include element(y-rotate) {\n\t\ttransform-origin: 0 100% 0;\n\t\tdisplay: flex;\n\t\tposition: relative;\n\t\tmargin-top: -39px;\n\t}\n\n\t@include element(guide) {\n\t\tposition: absolute;\n\t\ttop: 0;\n\t\tleft: 0;\n\t\twidth: 20px;\n\t\theight: 20px;\n\t\tbackground: #535353;\n\t\tcursor: pointer;\n\t\tz-index: 3;\n\t}\n}\n\n@include block(vm-ruler__guide-x) {\n\tposition: absolute;\n\theight: 100vh;\n\ttop: 0;\n\tborder-left: 1px dashed $blue-guide;\n\tpadding-left: 5px;\n\tcursor: ew-resize;\n\t> span {\n\t\tposition: absolute;\n\t\tdisplay: flex;\n\t\tjustify-content: center;\n\t\talign-items: center;\n\t\tuser-select: none;\n\t\tcolor: #fff;\n\t\tpadding: 0 4px;\n\t\tline-height: 20px;\n\t\tborder-radius: 1px;\n\t\tbox-shadow: 0 0 5px -3px #000;\n\t\tbackground: $blue-label;\n\t}\n\t@include when(solid) {\n\t\tborder-left: 1px solid $blue-guide;\n\t}\n}\n\n\n@include block(vm-ruler__guide-y) {\n\ttransform: rotate(-90deg);\n\ttransform-origin: 0 100% 0;\n\tposition: absolute;\n\twidth: 100vw;\n\ttop: 20px;\n\tborder-bottom: 1px dashed $blue-guide;\n\tpadding-bottom: 5px;\n\tcursor: ns-resize;\n\t> span {\n\t\ttransform: rotate(90deg);\n\t\ttransform-origin: 0 0 0;\n\t\tposition: absolute;\n\t\tleft: 20px;\n\t\ttop: 5px;\n\t\tuser-select: none;\n\t\tcolor: #fff;\n\t\tpadding: 0 4px;\n\t\tline-height: 20px;\n\t\tborder-radius: 1px;\n\t\tbox-shadow: 0 0 5px -3px #000;\n\t\tbackground: $blue-label;\n\t}\n\t@include when(solid) {\n\t\tborder-bottom: 1px solid $blue-guide;\n\t}\n}\n\n</style>\n']},media:void 0})}),Ct,void 0,!1,void 0,M,void 0);function Bt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}var kt={name:"vm-frame-inner",components:{"vm-ruler":$t},props:function(t){for(var n=arguments,e=1;e<arguments.length;e++){var i=null!=n[e]?n[e]:{};e%2?Bt(i,!0).forEach((function(n){s(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Bt(i).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}({showRuler:Boolean},$t.props)},Dt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-frame-draggable--inner"},[t.showRuler?e("vm-ruler",{attrs:{"scroll-left":t.scrollLeft,"scroll-top":t.scrollTop,"frame-w":t.frameW,"frame-h":t.frameH,scale:t.scale,guides:t.guides,"border-size":t.borderSize},on:{"guides-change":function(n){return t.$emit("update:guides",arguments[0])}}},[t._t("content")],2):t._t("content"),t._v(" "),t._t("content-extra"),t._v(" "),t._t("footer")],2)};Dt._withStripped=!0;var St=k({render:Dt,staticRenderFns:[]},(function(t){t&&t("data-v-1d12a878_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-frame-draggable--inner {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  overflow: hidden;\n  background: rgba(255, 0, 0, .05);\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  position: relative;\n}\n\n/*# sourceMappingURL=inner.vue.map */",map:{version:3,sources:["inner.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/inner.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;EC3CA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;EACA,gBAAA;EACA,gCAAA;EAEA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EAEA,kBAAA;AD2CA;;AAEA,oCAAoC",file:"inner.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-frame-draggable--inner {\n  flex: 1;\n  overflow: hidden;\n  background: rgba(255, 0, 0, 0.05);\n  display: flex;\n  flex-direction: column;\n  position: relative;\n}\n\n/*# sourceMappingURL=inner.vue.map */",'<template>\n\t<div class="vm-frame-draggable--inner">\n\t\t<vm-ruler\n\t\t\tv-if="showRuler"\n\t\t\t:scroll-left="scrollLeft"\n\t\t\t:scroll-top="scrollTop"\n\t\t\t:frame-w="frameW"\n\t\t\t:frame-h="frameH"\n\t\t\t:scale="scale"\n\t\t\t:guides="guides"\n\t\t\t:border-size="borderSize"\n\t\t\t@guides-change="$emit(\'update:guides\', arguments[0])"\n\t\t>\n\t\t\t<slot name="content" />\n\t\t</vm-ruler>\n\t\t<slot v-else name="content" />\n\t\t<slot name="content-extra" />\n\t\t<slot name="footer" />\n\t</div>\n</template>\n\n<script>\nimport Ruler from \'./ruler.vue\';\n\nexport default {\n\tname: \'vm-frame-inner\',\n\tcomponents: {\n\t\t\'vm-ruler\': Ruler\n\t},\n\tprops: {\n\t\tshowRuler: Boolean,\n\t\t...Ruler.props,\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-frame-draggable--inner;\n@include block($block) {\n\tflex: 1;\n\toverflow: hidden;\n\tbackground: rgba(255, 0, 0, 0.05); // TODO: dark模式;\n\t\n\tdisplay: flex; \n\tflex-direction: column;\n\n\tposition: relative;\n}\n</style>']},media:void 0})}),kt,void 0,!1,void 0,M,void 0);!function(t,n){void 0===n&&(n={});var e=n.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css","top"===e&&i.firstChild?i.insertBefore(r,i.firstChild):i.appendChild(r),r.styleSheet?r.styleSheet.cssText=t:r.appendChild(document.createTextNode(t))}}("#test{color:red}");var Mt=[{label:"50%",value:.5},{label:"100%",value:1},{label:"150%",value:1.5},{label:"200%",value:2}],zt={name:"vm-zoom-bar",components:{"vc-slider":c,"vc-select":m,"vc-option":h},props:{scale:{type:Number,default:1},frameW:{type:Number,default:0},frameH:{type:Number,default:0},clientW:{type:Number,default:0},clientH:{type:Number,default:0},borderSize:{type:Number,default:0}},data:function(){return{currentScale:1,currentSelect:1}},computed:{autoScale:function(){var t=this.frameW,n=this.frameH,e=this.clientW,i=this.clientH,r=this.borderSize;return t&&n&&e&&i?Math.min((e-2*r)/t,(i-2*r)/n,1):1},options:function(){var t=this;return!this.autoScale||Mt.some((function(n){return n.value===t.autoScale}))?Mt:Mt.concat([{label:"自适应",value:this.autoScale}])}},watch:{scale:{immediate:!0,handler:function(t){this.currentScale=t,this.currentPlaceholder=100*t+"%"}}},created:function(){},methods:{handleChangeSlider:function(t){this.currentScale=t/100,this.$emit("update:scale",this.currentScale)},handleChangeSelect:function(t){this.currentScale=t,this.$emit("update:scale",this.currentScale)}}},Ot=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-zoom-bar"},[e("div",{staticClass:"vm-zoom-bar__wrapper"},[e("vc-select",{staticStyle:{width:"75px"},attrs:{value:t.currentScale,placeholder:t.currentPlaceholder},on:{change:t.handleChangeSelect}},t._l(t.options,(function(n,i){return e("vc-option",{key:i,attrs:{value:n.value}},[t._v("\n\t\t\t\t"+t._s(n.label)+"\n\t\t\t")])})),1),t._v(" "),e("vc-slider",{staticStyle:{width:"160px","margin-left":"16px","margin-right":"15px"},attrs:{value:100*t.currentScale,step:1,min:50,max:200},on:{change:t.handleChangeSlider}})],1)])};Ot._withStripped=!0;var Ft=k({render:Ot,staticRenderFns:[]},(function(t){t&&t("data-v-4f8b3b11_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-zoom-bar {\n  background: #4a4a4a;\n  height: 40px;\n  z-index: 2;\n}\n.vm-zoom-bar__wrapper {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: end;\n  -webkit-justify-content: flex-end;\n      -ms-flex-pack: end;\n          justify-content: flex-end;\n}\n\n/*# sourceMappingURL=zoom-bar.vue.map */",map:{version:3,sources:["zoom-bar.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/zoom-bar.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;ACgJF;;;;;;;EAAA;ADvIA;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;EC2EA,mBAAA;EACA,YAAA;EACA,UAAA;ADzEA;AACA;EC0EA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,qBAAA;EAAA,iCAAA;MAAA,kBAAA;UAAA,yBAAA;ADxEA;;AAEA,uCAAuC",file:"zoom-bar.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-zoom-bar {\n  background: #4a4a4a;\n  height: 40px;\n  z-index: 2;\n}\n.vm-zoom-bar__wrapper {\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n}\n\n/*# sourceMappingURL=zoom-bar.vue.map */",'<template>\n\t<div class="vm-zoom-bar">\n\t\t<div class="vm-zoom-bar__wrapper">\n\t\t\t<vc-select\n\t\t\t\t:value="currentScale"\n\t\t\t\t:placeholder="currentPlaceholder"\n\t\t\t\tstyle="width: 75px"\n\t\t\t\t@change="handleChangeSelect"\n\t\t\t>\n\t\t\t\t<vc-option\n\t\t\t\t\tv-for="(item, index) in options"\n\t\t\t\t\t:value="item.value"\n\t\t\t\t\t:key="index"\n\t\t\t\t>\n\t\t\t\t\t{{ item.label }}\n\t\t\t\t</vc-option>\n\t\t\t</vc-select>\n\t\t\t<vc-slider\n\t\t\t\t:value="currentScale * 100"\n\t\t\t\t:step="1"\n\t\t\t\t:min="50"\n\t\t\t\t:max="200"\n\t\t\t\tstyle="width: 160px; margin-left: 16px; margin-right: 15px;"\n\t\t\t\t@change="handleChangeSlider"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { Slider, Select, Option } from \'../../../vc\';\n\nconst OPTIONS = [\n\t{\n\t\tlabel: \'50%\',\n\t\tvalue: 0.5\n\t},\n\t{\n\t\tlabel: \'100%\',\n\t\tvalue: 1\n\t},\n\t{\n\t\tlabel: \'150%\',\n\t\tvalue: 1.5\n\t},\n\t{\n\t\tlabel: \'200%\',\n\t\tvalue: 2\n\t}\n];\n\nexport default {\n\tname: \'vm-zoom-bar\',\n\tcomponents: {\n\t\t\'vc-slider\': Slider,\n\t\t\'vc-select\': Select,\n\t\t\'vc-option\': Option\n\t},\n\tprops: {\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\n\t\tframeW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tframeH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tborderSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tcurrentScale: 1,\n\t\t\tcurrentSelect: 1,\n\t\t};\n\t},\n\tcomputed: {\n\t\tautoScale() {\n\t\t\tlet { frameW, frameH, clientW, clientH, borderSize } = this;\n\t\t\tif (!frameW \n\t\t\t\t|| !frameH \n\t\t\t\t|| !clientW \n\t\t\t\t|| !clientH\n\t\t\t) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\treturn Math.min(\n\t\t\t\t(clientW - borderSize * 2) / frameW, \n\t\t\t\t(clientH - borderSize * 2) / frameH, \n\t\t\t\t1\n\t\t\t);\n\t\t},\n\n\t\toptions() {\n\t\t\tif (!this.autoScale \n\t\t\t\t|| OPTIONS.some(i => i.value === this.autoScale)\n\t\t\t) {\n\t\t\t\treturn OPTIONS;\n\t\t\t}\n\n\t\t\treturn OPTIONS.concat([\n\t\t\t\t{\n\t\t\t\t\tlabel: \'自适应\',\n\t\t\t\t\tvalue: this.autoScale\n\t\t\t\t}\n\t\t\t]);\n\t\t}\n\t},\n\twatch: {\n\t\tscale: {\n\t\t\timmediate: true,\n\t\t\thandler(v) {\n\t\t\t\tthis.currentScale = v;\n\t\t\t\tthis.currentPlaceholder = v * 100 + \'%\';\n\t\t\t}\n\t\t}\n\t},\n\tcreated() {\n\t\t\n\t},\n\tmethods: {\n\t\thandleChangeSlider(v) {\n\t\t\tthis.currentScale = v / 100;\n\n\t\t\tthis.$emit(\'update:scale\', this.currentScale);\n\t\t},\n\t\thandleChangeSelect(v) {\n\t\t\tthis.currentScale = v;\n\t\t\t\n\t\t\tthis.$emit(\'update:scale\', this.currentScale);\n\t\t},\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-zoom-bar;\n@include block($block) {\n\tbackground: #4a4a4a; \n\theight: 40px; \n\tz-index: 2;\n\t@include element(wrapper) {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: flex-end;\n\t}\n}\n</style>\n']},media:void 0})}),zt,void 0,!1,void 0,M,void 0),Nt={name:"vm-thumbnail",components:{},props:{dataSource:{type:Array,default:function(){return[]}},scale:{type:Number,default:1},frameW:{type:Number,default:0},frameH:{type:Number,default:0},clientW:{type:Number,default:0},clientH:{type:Number,default:0},scrollTop:{type:Number,default:0},scrollLeft:{type:Number,default:0},borderSize:{type:Number,default:0}},data:function(){return{width:192,height:108}},computed:{shrink:function(){var t=this.width,n=this.height,e=this.frameW,i=this.frameH,r=this.borderSize;return Math.min((e+2*r)/t,(i+2*r)/n)},visibleStyle:function(){var t=this.width,n=this.height,e=this.clientW,i=this.clientH,r=this.scale,a=this.shrink,s=this.scrollLeft,o=this.scrollTop,l=Math.min(e/a/r,t),d=Math.min(i/a/r,n),A=s/a/r,c=o/a/r;return{width:"".concat(l,"px"),height:"".concat(d,"px"),left:"".concat(A+l>t?t-l:A,"px"),top:"".concat(c+d>n?n-d:c,"px")}},maxScrollLeft:function(){return this.frameW-this.clientW+2*this.borderSize},maxScrollTop:function(){return this.frameH-this.clientH+2*this.borderSize}},watch:{dataSource:{deep:!0,handler:function(){this.repaint()}},frameW:function(){this.repaint()},frameH:function(){this.repaint()}},mounted:function(){this.repaint(),window.addEventListener("mouseup",this.handleMouseUp),window.addEventListener("mousemove",this.handleMouseMove)},destroyed:function(){window.removeEventListener("mouseup",this.handleMouseUp),window.removeEventListener("mousemove",this.handleMouseMove)},methods:{repaint:function(){if(this._isMounted){var t=this.$refs.canvas,n=this.dataSource,e=this.shrink,i=t.getContext("2d");t.height=t.height,i.beginPath(),i.translate(40/e,40/e),i.save(),n.forEach((function(t){if("page"!==t.module){var n=t.x,r=t.y,a=t.w,s=t.h,o=t.r;i.translate((n+a/2)/e,(r+s/2)/e),i.fillStyle="rgba(219, 219, 219, 0.4)",i.rotate(o*Math.PI/180),i.fillRect(-a/2/e,-s/2/e,a/e,s/e),i.restore(),i.save()}}))}},handleMouseDown:function(t){p.toggleSelection(),this.lastMouseX=t.clientX,this.lastMouseY=t.clientY,this.isMoving=!0},handleMouseMove:function(t){if(p.toggleSelection(),this.isMoving){var n=this.scrollLeft,e=this.scrollTop,i=this.shrink,r=this.scale,a=this.maxScrollLeft,s=this.maxScrollTop,o=t.clientX,l=t.clientY,d=o-this.lastMouseX,A=l-this.lastMouseY;this.lastMouseX=o,this.lastMouseY=l;var c=n+d*i*r,m=e+A*i*r;c=c>=0&&c<=a?c:n,m=m>=0&&m<=s?m:e,this.$emit("scroll",c,m)}},handleMouseUp:function(){this.isMoving=!1}}},Yt=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"vm-thumbnail"},[n("div",{staticStyle:{position:"relative"}},[n("canvas",{ref:"canvas",attrs:{width:this.width,height:this.height}}),this._v(" "),n("div",{staticClass:"vm-thumbnail__visible",style:this.visibleStyle,on:{mousedown:this.handleMouseDown}})])])};Yt._withStripped=!0;var Wt=k({render:Yt,staticRenderFns:[]},(function(t){t&&t("data-v-49fb6316_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-thumbnail {\n  position: absolute;\n  bottom: 50px;\n  right: 10px;\n  background: #343434;\n  border: 1px solid #16F2F6;\n  z-index: 2;\n}\n.vm-thumbnail__visible {\n  position: absolute;\n  z-index: 2;\n  border: 1px solid #DBDBDB;\n  background: rgba(68, 68, 68, .5);\n  cursor: move;\n}\n\n/*# sourceMappingURL=thumbnail.vue.map */",map:{version:3,sources:["thumbnail.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/thumbnail.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;ACmIF;;EAAA;AD/HA;ECmIA,kBAAA;EACA,YAAA;EACA,WAAA;EACA,mBAAA;EACA,yBAAA;EACA,UAAA;ADjIA;AACA;ECkIA,kBAAA;EACA,UAAA;EACA,yBAAA;EACA,gCAAA;EACA,YAAA;ADhIA;;AAEA,wCAAwC",file:"thumbnail.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-thumbnail {\n  position: absolute;\n  bottom: 50px;\n  right: 10px;\n  background: #343434;\n  border: 1px solid #16F2F6;\n  z-index: 2;\n}\n.vm-thumbnail__visible {\n  position: absolute;\n  z-index: 2;\n  border: 1px solid #DBDBDB;\n  background: rgba(68, 68, 68, 0.5);\n  cursor: move;\n}\n\n/*# sourceMappingURL=thumbnail.vue.map */","<template>\n\t<div class=\"vm-thumbnail\">\n\t\t<div style=\"position: relative;\">\n\t\t\t<canvas\n\t\t\t\tref=\"canvas\"\n\t\t\t\t:width=\"width\"\n\t\t\t\t:height=\"height\"\n\t\t\t/>\n\t\t\t<div\n\t\t\t\t:style=\"visibleStyle\"\n\t\t\t\tclass=\"vm-thumbnail__visible\"\n\t\t\t\t@mousedown=\"handleMouseDown\"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { toggleSelection } from '../../../vc';\n\nexport default {\n\tname: 'vm-thumbnail',\n\tcomponents: {\n\n\t},\n\tprops: {\n\t\tdataSource: {\n\t\t\ttype: Array,\n\t\t\tdefault() {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t},\n\n\t\tscale: {\n\t\t\ttype: Number,\n\t\t\tdefault: 1\n\t\t},\n\n\t\tframeW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tframeH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientW: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tclientH: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tscrollTop: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tscrollLeft: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\n\t\tborderSize: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\twidth: 192,\n\t\t\theight: 108\n\t\t};\n\t},\n\tcomputed: {\n\t\tshrink() {\n\t\t\tconst { width, height, frameW, frameH, borderSize } = this;\n\t\t\treturn Math.min(\n\t\t\t\t(frameW + borderSize * 2) / width,\n\t\t\t\t(frameH + borderSize * 2) / height\n\t\t\t);\n\t\t},\n\t\tvisibleStyle() {\n\t\t\tconst { width, height, clientW, clientH, scale, shrink, scrollLeft, scrollTop } = this;\n\n\t\t\tlet visibleW = Math.min(clientW / shrink / scale, width);\n\t\t\tlet visibleH = Math.min(clientH / shrink / scale, height);\n\t\t\tlet left = scrollLeft / shrink / scale;\n\t\t\tlet top = scrollTop / shrink / scale;\n\n\t\t\treturn {\n\t\t\t\twidth: `${visibleW}px`,\n\t\t\t\theight: `${visibleH}px`,\n\t\t\t\tleft: `${left + visibleW > width ? width - visibleW : left}px`,\n\t\t\t\ttop: `${top + visibleH > height ? height - visibleH : top}px`\n\t\t\t};\n\t\t},\n\t\tmaxScrollLeft() {\n\t\t\tconst { frameW, clientW, borderSize } = this;\n\t\t\treturn frameW - clientW + borderSize * 2;\n\t\t},\n\t\tmaxScrollTop() {\n\t\t\tconst { frameH, clientH, borderSize } = this;\n\t\t\treturn frameH - clientH + borderSize * 2;\n\t\t}\n\t},\n\n\twatch: {\n\t\tdataSource: {\n\t\t\tdeep: true,\n\t\t\thandler() {\n\t\t\t\tthis.repaint();\n\t\t\t}\n\t\t},\n\t\tframeW() {\n\t\t\tthis.repaint();\n\t\t},\n\t\tframeH() {\n\t\t\tthis.repaint();\n\t\t},\n\t},\n\t\n\tmounted() {\n\t\tthis.repaint();\n\n\t\twindow.addEventListener('mouseup', this.handleMouseUp);\n\t\twindow.addEventListener('mousemove', this.handleMouseMove);\n\t},\n\n\tdestroyed() {\n\t\twindow.removeEventListener('mouseup', this.handleMouseUp);\n\t\twindow.removeEventListener('mousemove', this.handleMouseMove);\n\t},\n\n\tmethods: {\n\t\trepaint() {\n\t\t\tif (!this._isMounted) return;\n\n\t\t\tlet canvas = this.$refs.canvas;\n\t\t\tlet { dataSource, shrink } = this;\n\t\t\tlet ctx = canvas.getContext('2d');\n\n\t\t\tcanvas.height = canvas.height; // 重设高度，清空画布\n\n\t\t\tctx.beginPath();\n\t\t\tctx.translate(40 / shrink, 40 / shrink);\n\t\t\tctx.save();\n\t\t\tdataSource.forEach(item => {\n\t\t\t\tif (item.module === 'page') return;\n\n\t\t\t\tlet { x, y, w, h, r } = item;\n\t\t\t\tctx.translate(\n\t\t\t\t\t(x + w / 2) / shrink,\n\t\t\t\t\t(y + h / 2) / shrink\n\t\t\t\t);\n\t\t\t\tctx.fillStyle = 'rgba(219, 219, 219, 0.4)';\n\t\t\t\tctx.rotate(r * Math.PI / 180);\n\t\t\t\tctx.fillRect(\n\t\t\t\t\t-w / 2 / shrink,\n\t\t\t\t\t-h / 2 / shrink,\n\t\t\t\t\tw / shrink,\n\t\t\t\t\th / shrink\n\t\t\t\t);\n\t\t\t\tctx.restore();\n\t\t\t\tctx.save();\n\t\t\t});\n\t\t},\n\t\thandleMouseDown(e) {\n\t\t\ttoggleSelection();\n\t\t\tthis.lastMouseX = e.clientX;\n\t\t\tthis.lastMouseY = e.clientY;\n\n\t\t\tthis.isMoving = true;\n\t\t},\n\n\t\thandleMouseMove(e) {\n\t\t\ttoggleSelection();\n\t\t\tif (!this.isMoving) return;\n\n\t\t\tconst { scrollLeft, scrollTop, shrink, scale, maxScrollLeft, maxScrollTop } = this;\n\n\t\t\tlet mouseX = e.clientX;\n\t\t\tlet mouseY = e.clientY;\n\t\t\tlet diffX = mouseX - this.lastMouseX;\n\t\t\tlet diffY = mouseY - this.lastMouseY;\n\n\t\t\tthis.lastMouseX = mouseX;\n\t\t\tthis.lastMouseY = mouseY;\n\n\t\t\tlet x = scrollLeft + diffX * shrink * scale;\n\t\t\tlet y = scrollTop + diffY * shrink * scale;\n\t\t\tx = x >= 0 && x <= maxScrollLeft ? x : scrollLeft;\n\t\t\ty = y >= 0 && y <= maxScrollTop ? y : scrollTop;\n\n\t\t\tthis.$emit('scroll', x, y);\n\t\t},\n\n\t\thandleMouseUp() {\n\t\t\tthis.isMoving = false;\n\t\t}\n\n\t},\n};\n<\/script>\n\n<style lang=\"scss\">\n@import \"../../../style/index.scss\";\n\n$block: vm-thumbnail;\n@include block($block) {\n\tposition: absolute;\n\tbottom: 50px;\n\tright: 10px;\n\tbackground: #343434;\n\tborder: 1px solid #16F2F6;\n\tz-index: 2;\n\t@include element(visible) {\n\t\tposition: absolute;\n\t\tz-index: 2;\n\t\tborder: 1px solid #DBDBDB;\n\t\tbackground: rgba(68, 68, 68, 0.5);\n\t\tcursor: move;\n\t}\n}\n</style>\n"]},media:void 0})}),Nt,void 0,!1,void 0,M,void 0),Rt={TOP:"置顶",BOTTOM:"置底",UP:"上移一层",DOWN:"下移一层",DELETE:"删除"},Tt={name:"vm-right-menu",props:{event:MouseEvent},data:function(){return{visible:!1,wrapHeight:175,menu:Object.keys(Rt).map((function(t){return Rt[t]}))}},computed:{top:function(){return window.innerHeight-this.event.clientY<this.wrapHeight?this.event.clientY-this.wrapHeight:this.event.clientY}},mounted:function(){this.visible=!0},methods:{handleClick:function(t){this.visible=!1,this.$emit("sure",t)}}},Xt=new A(Tt),Ut=Tt,Pt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],ref:"vm-right-menu",staticClass:"vm-right-menu",style:{left:t.event.clientX+"px",top:t.top+"px"}},[e("div",{staticClass:"vm-right-menu__content"},t._l(t.menu,(function(n){return e("span",{key:n,staticClass:"vm-right-menu__item",on:{click:function(e){return t.handleClick(n)},mousedown:function(t){t.stopPropagation()}}},[t._v("\n\t\t\t"+t._s(n)+"\n\t\t")])})),0)])};Pt._withStripped=!0;function Lt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}k({render:Pt,staticRenderFns:[]},(function(t){t&&t("data-v-a5bbe3b2_0",{source:".vm-right-menu {\n  position: fixed;\n  z-index: 999;\n  width: 104px;\n  background: #444;\n  padding: 6px 0px;\n  border: 1px solid #47DAFF;\n  border-radius: 4px;\n}\n.vm-right-menu .vm-right-menu__content {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item {\n  height: 32px;\n  width: 100%;\n  line-height: 32px;\n  text-align: center;\n  display: block;\n  color: #fff;\n  cursor: pointer;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item:hover {\n  background: #343434;\n  color: #16F2F6;\n}\n\n/*# sourceMappingURL=right-menu.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/right-menu.vue","right-menu.vue"],names:[],mappings:"AAoEA;EACA,eAAA;EACA,YAAA;EACA,YAAA;EACA,gBAAA;EACA,gBAAA;EACA,yBAAA;EACA,kBAAA;ACnEA;ADoEA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;AClEA;ADmEA;EACA,YAAA;EACA,WAAA;EACA,iBAAA;EACA,kBAAA;EACA,cAAA;EACA,WAAA;EACA,eAAA;ACjEA;ADkEA;EACA,mBAAA;EACA,cAAA;AChEA;;AAEA,yCAAyC",file:"right-menu.vue",sourcesContent:['<template>\n\t<div\n\t\tv-show="visible"\n\t\tref="vm-right-menu"\n\t\t:style="{\n\t\t\tleft: `${event.clientX}px`,\n\t\t\ttop: `${top}px`\n\t\t}"\n\t\tclass="vm-right-menu"\n\t>\n\t\t<div class="vm-right-menu__content">\n\t\t\t<span\n\t\t\t\tv-for="item in menu"\n\t\t\t\t:key="item"\n\t\t\t\tclass="vm-right-menu__item"\n\t\t\t\t@click="handleClick(item)"\n\t\t\t\t@mousedown.stop\n\t\t\t>\n\t\t\t\t{{ item }}\n\t\t\t</span>\n\t\t</div>\n\t</div>\n</template>\n<script>\nimport { Portal } from \'../../../vc\';\n\nexport const RIGHT_MENU_MAP = {\n\tTOP: \'置顶\', \n\tBOTTOM: \'置底\', \n\tUP: \'上移一层\', \n\tDOWN: \'下移一层\', \n\tDELETE: \'删除\', \n};\n\nexport const config = {\n\tname: \'vm-right-menu\',\n\tprops: {\n\t\tevent: MouseEvent\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvisible: false,\n\t\t\twrapHeight: 175,\n\t\t\tmenu: Object.keys(RIGHT_MENU_MAP).map((key) => RIGHT_MENU_MAP[key])\n\t\t};\n\t},\n\tcomputed: {\n\t\ttop() {\n\t\t\treturn (window.innerHeight - this.event.clientY) < this.wrapHeight\n\t\t\t\t? (this.event.clientY - this.wrapHeight) : this.event.clientY;\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.visible = true;\n\t},\n\tmethods: {\n\t\thandleClick(item) {\n\t\t\tthis.visible = false;\n\t\t\tthis.$emit(\'sure\', item);\n\t\t}\n\t},\n};\n\nexport default config;\nexport const RightMenu = new Portal(config);\n\n<\/script>\n<style lang="scss">\n.vm-right-menu {\n\tposition: fixed;\n\tz-index: 999;\n\twidth: 104px;\n\tbackground: #444;\n\tpadding: 6px 0px;\n\tborder: 1px solid #47DAFF;\n\tborder-radius:4px;\n\t.vm-right-menu__content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\t.vm-right-menu__item {\n\t\t\theight: 32px;\n\t\t\twidth: 100%;\n\t\t\tline-height: 32px;\n\t\t\ttext-align: center;\n\t\t\tdisplay: block;\n\t\t\tcolor: #fff;\n\t\t\tcursor: pointer;\n\t\t\t&:hover {\n\t\t\t\tbackground: #343434;\n\t\t\t\tcolor: #16F2F6;\n\t\t\t}\n\t\t}\n\t}\n}\n</style>\n',".vm-right-menu {\n  position: fixed;\n  z-index: 999;\n  width: 104px;\n  background: #444;\n  padding: 6px 0px;\n  border: 1px solid #47DAFF;\n  border-radius: 4px;\n}\n.vm-right-menu .vm-right-menu__content {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item {\n  height: 32px;\n  width: 100%;\n  line-height: 32px;\n  text-align: center;\n  display: block;\n  color: #fff;\n  cursor: pointer;\n}\n.vm-right-menu .vm-right-menu__content .vm-right-menu__item:hover {\n  background: #343434;\n  color: #16F2F6;\n}\n\n/*# sourceMappingURL=right-menu.vue.map */"]},media:void 0})}),Ut,void 0,!1,void 0,M,void 0);var jt={name:"vm-frame",components:{"vm-draggable":F,"vm-grid-lines":xt,"vm-align-lines":Et,"vm-inner":St,"vm-zoom-bar":Ft,"vm-thumbnail":Wt},props:{width:{type:Number,validator:function(t){return t>0}},height:{type:Number,validator:function(t){return t>0}},dataSource:Array,editor:Object,frameStyle:Object,showLines:{type:Boolean,default:!0},showRuler:{type:Boolean,default:!0},showZoomBar:{type:Boolean,default:!0},showThumbnail:{type:Boolean,default:!0}},data:function(){return{vm:{type:"frame"},scrollLeft:0,scrollTop:0,scale:1,xRuleLines:[],yRuleLines:[],clientW:0,clientH:0,borderSize:20,guides:[[],[]]}},computed:{wrapperStyle:function(){return{paddingTop:"".concat(this.borderSize,"px"),paddingLeft:"".concat(this.borderSize,"px")}},contentStyle:function(){return{width:"".concat(this.width,"px"),height:"".concat(this.height,"px"),transform:"scale(".concat(this.scale,")"),transformOrigin:"0 0"}},hackStyle:function(){return{width:"".concat(Math.max(this.clientW,this.width*this.scale)+this.borderSize,"px"),height:"".concat(this.height*this.scale+this.borderSize,"px")}}},mounted:function(){var t=this;this.$nextTick((function(){t.clientW=t.$refs.wrapper.offsetWidth,t.clientH=t.$refs.wrapper.offsetHeight}))},methods:{handleScroll:a.throttle((function(t){this.scrollLeft=t.target.scrollLeft,this.scrollTop=t.target.scrollTop}),50),handleScrollThumbnail:function(t,n){this.scrollLeft=t,this.$refs.wrapper.scrollLeft=t,this.scrollTop=n,this.$refs.wrapper.scrollTop=n},handleDragOver:function(t){},handleDragEnd:function(t){console.log(t)},handleDrop:function(t){var n=JSON.parse(t.dataTransfer.getData("@wya/vm"))||{},e=n.module,i=n.index,r=this.$parent.$options.modules[e];if(r)if(r.max&&r.max<=this.dataSource.filter((function(t){return t.module===e})).length)this.$emit("error",{type:"create",msg:"当前模块最多只能创建".concat(r.max,"个")});else{var o=this.$refs.content.getBoundingClientRect(),l=o.x,d=o.y,A=t.pageX||t.clientX+document.documentElement.scrollLeft||0,c=t.pageY||t.clientY+document.documentElement.scrollTop||0,m=x(),h=this.dataSource.length,p=function(t){for(var n=arguments,e=1;e<arguments.length;e++){var i=null!=n[e]?n[e]:{};e%2?Lt(i,!0).forEach((function(n){s(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Lt(i).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}({},a.cloneDeep("function"==typeof r.data?r.data(i,this.dataSource):r.data),{module:e,id:m});t.fake||!p.draggable&&void 0!==p.draggable?(p.x=0,p.y=0):(p.x=Math.round((A-l)/this.scale),p.y=Math.round((c-d)/this.scale)),this.dataSource.push(p),this.$emit("change",{type:"create",index:h,id:m}),this.setActived(h)}},handleEnd:function(t,n,e){this.$emit("change",{type:"update",id:n,index:e,old:t})},setActived:function(t){var n=this;this.$nextTick((function(){try{n.$refs.draggable[t].setActived()}catch(t){console.error(t)}}))},handleShowMenu:function(t,n){var e=this,i=o(this.dataSource.filter((function(t){return"page"!==t.module}))).reverse().sort((function(t,n){return n.z-t.z})),r=i.findIndex((function(t){return t.id===n.id}));if("page"!==n.module){var a=Rt.TOP,s=Rt.BOTTOM,l=Rt.UP,d=Rt.DOWN,A=Rt.DELETE;Xt.popup({event:t}).then((function(t){var o;switch(t){case a:r>0&&(o=i[0],n.z=o.z);break;case s:r<i.length-1&&(o=i[i.length-1],n.z=o.z);break;case l:if(r>0){o=i[r-1];var c=[n.z,o.z];o.z=c[0],n.z=c[1]}break;case d:if(r<i.length-1){o=i[r+1];var m=[n.z,o.z];o.z=m[0],n.z=m[1]}break;case A:e.$emit("change",{type:"delete",id:n.id})}if(t!==A&&o){var h=e.dataSource.findIndex((function(t){return t.id===n.id}));e.dataSource.splice(h,1);var p=e.dataSource.findIndex((function(t){return t.id===o.id}))+([a,l].includes(t)?1:0);e.dataSource.splice(p,0,n)}}))}}}},Ht=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("vm-inner",{staticClass:"vm-frame-draggable",attrs:{"show-ruler":t.showRuler,"scroll-left":t.scrollLeft,"scroll-top":t.scrollTop,"frame-w":t.width,"frame-h":t.height,scale:t.scale,"border-size":t.borderSize,guides:t.guides},on:{"update:guides":function(n){t.guides=n}},scopedSlots:t._u([{key:"content",fn:function(){return[e("div",{ref:"wrapper",staticClass:"vm-frame-draggable__wrapper",style:t.wrapperStyle,on:{scroll:t.handleScroll}},[e("div",{style:t.hackStyle},[e("div",{ref:"content",staticClass:"vm-frame-draggable__content",staticStyle:{position:"relative"},style:[t.contentStyle,t.frameStyle],on:{dragover:function(n){return n.preventDefault(),t.handleDragOver(n)},dragend:t.handleDragEnd,drop:t.handleDrop}},[t.showLines?e("vm-grid-lines",{attrs:{width:t.width,height:t.height,grid:[10,10]}}):t._e(),t._v(" "),t.showLines?e("vm-align-lines",{attrs:{"data-source":t.dataSource,editor:t.editor}}):t._e(),t._v(" "),t._l(t.dataSource,(function(n,i){return e("vm-draggable",{key:n.id,ref:"draggable",refInFor:!0,attrs:{x:n.x,y:n.y,z:n.z,w:n.w,h:n.h,r:n.r,module:n.module,parent:n.parent,disabled:n.disabled,handles:n.handles,"min-w":n.minW,"min-h":n.minH,scale:t.scale,grid:n.grid,guides:t.guides,offset:[t.scrollLeft||0,t.scrollTop||0],active:n.active,restrain:n.restrain,closeable:n.closeable||void 0===n.closeable,draggable:n.draggable||void 0===n.draggable,rotatable:n.rotatable||void 0===n.rotatable,resizable:n.resizable||void 0===n.resizable},on:{"update:x":function(e){return t.$set(n,"x",e)},"update:y":function(e){return t.$set(n,"y",e)},"update:z":function(e){return t.$set(n,"z",e)},"update:w":function(e){return t.$set(n,"w",e)},"update:h":function(e){return t.$set(n,"h",e)},"update:r":function(e){return t.$set(n,"r",e)},activated:function(e){return t.$emit("activated",n)},deactivated:function(e){return t.$emit("deactivated",arguments[0],n)},dragging:function(e){return t.$emit("dragging",n)},resizing:function(e){return t.$emit("resizing",n)},rotating:function(e){return t.$emit("rotating",n)},"resize-end":function(e){return t.$emit("resize-end",n)},"drag-end":function(e){return t.$emit("drag-end",n)},delete:function(e){return t.$emit("change",{type:"delete",id:n.id})},end:function(e){return t.handleEnd(arguments[0],n.id,i)}},nativeOn:{contextmenu:function(e){return e.preventDefault(),t.handleShowMenu(e,n)}}},[e("vm-"+n.module+"-viewer",t._b({tag:"component",attrs:{index:i,vm:t.vm}},"component",n,!1))],1)}))],2)])])]},proxy:!0},{key:"content-extra",fn:function(){return[t.showThumbnail?e("vm-thumbnail",{attrs:{"data-source":t.dataSource,scale:t.scale,"frame-w":t.width,"frame-h":t.height,"client-w":t.clientW,"client-h":t.clientH,"scroll-left":t.scrollLeft,"scroll-top":t.scrollTop,"border-size":t.borderSize},on:{scroll:t.handleScrollThumbnail}}):t._e()]},proxy:!0},{key:"footer",fn:function(){return[t.showZoomBar?e("vm-zoom-bar",{attrs:{scale:t.scale,"border-size":t.borderSize,"frame-w":t.width,"frame-h":t.height,"client-w":t.clientW,"client-h":t.clientH},on:{"update:scale":function(n){t.scale=n}}}):t._e()]},proxy:!0}])})};Ht._withStripped=!0;var It=k({render:Ht,staticRenderFns:[]},(function(t){t&&t("data-v-503f6122_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-frame-draggable__wrapper {\n  overflow: auto;\n}\n.vm-frame-draggable__content {\n  -webkit-flex-shrink: 0;\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  position: relative;\n  overflow: hidden;\n  z-index: 1;\n}\n\n/*# sourceMappingURL=frame.vue.map */",map:{version:3,sources:["frame.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/draggable/frame.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AACF;;;;EAIE;AACF;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;AACF;ECgSA,cAAA;AD9RA;AAEA;ECgSA,sBAAA;MAAA,oBAAA;UAAA,cAAA;EACA,yBAAA;EACA,kBAAA;EACA,gBAAA;EACA,UAAA;AD9RA;;AAEA,oCAAoC",file:"frame.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-frame-draggable__wrapper {\n  overflow: auto;\n}\n\n.vm-frame-draggable__content {\n  flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  position: relative;\n  overflow: hidden;\n  z-index: 1;\n}\n\n/*# sourceMappingURL=frame.vue.map */",'<template>\n\t<vm-inner \n\t\t:show-ruler="showRuler"\n\t\t:scroll-left="scrollLeft"\n\t\t:scroll-top="scrollTop"\n\t\t:frame-w="width"\n\t\t:frame-h="height"\n\t\t:scale="scale"\n\t\t:border-size="borderSize"\n\t\t:guides.sync="guides"\n\t\tclass="vm-frame-draggable" \n\t>\n\t\t<template #content>\n\t\t\t<div \n\t\t\t\tref="wrapper" \n\t\t\t\t:style="wrapperStyle"\n\t\t\t\tclass="vm-frame-draggable__wrapper" \n\t\t\t\t@scroll="handleScroll"\n\t\t\t>\n\t\t\t\t<div :style="hackStyle">\n\t\t\t\t\t\x3c!-- 以上仅辅助Frame，所以frameStyle作用在content上 --\x3e\n\t\t\t\t\t<div\n\t\t\t\t\t\tref="content"\n\t\t\t\t\t\t:style="[contentStyle, frameStyle]"\n\t\t\t\t\t\tclass="vm-frame-draggable__content"\n\t\t\t\t\t\tstyle="position: relative;"\n\t\t\t\t\t\t@dragover.prevent="handleDragOver"\n\t\t\t\t\t\t@dragend="handleDragEnd"\n\t\t\t\t\t\t@drop="handleDrop"\n\t\t\t\t\t>\n\t\t\t\t\t\t<vm-grid-lines v-if="showLines" :width="width" :height="height" :grid="[10, 10]" />\n\t\t\t\t\t\t<vm-align-lines v-if="showLines" :data-source="dataSource" :editor="editor"/>\n\t\t\t\t\t\t\x3c!-- TODO: 不操作引用修改 --\x3e\n\t\t\t\t\t\t<vm-draggable\n\t\t\t\t\t\t\tv-for="(it, index) in dataSource"\n\t\t\t\t\t\t\tref="draggable"\n\t\t\t\t\t\t\t:key="it.id"\n\t\t\t\t\t\t\t:x.sync="it.x"\n\t\t\t\t\t\t\t:y.sync="it.y"\n\t\t\t\t\t\t\t:z.sync="it.z"\n\t\t\t\t\t\t\t:w.sync="it.w"\n\t\t\t\t\t\t\t:h.sync="it.h"\n\t\t\t\t\t\t\t:r.sync="it.r"\n\t\t\t\t\t\t\t:module="it.module"\n\t\t\t\t\t\t\t:parent="it.parent"\n\t\t\t\t\t\t\t:disabled="it.disabled"\n\t\t\t\t\t\t\t:handles="it.handles"\n\t\t\t\t\t\t\t:min-w="it.minW"\n\t\t\t\t\t\t\t:min-h="it.minH"\n\t\t\t\t\t\t\t:scale="scale"\n\t\t\t\t\t\t\t:grid="it.grid"\n\t\t\t\t\t\t\t:guides="guides"\n\t\t\t\t\t\t\t:offset="[scrollLeft || 0, scrollTop || 0]"\n\t\t\t\t\t\t\t:active="it.active"\n\t\t\t\t\t\t\t:restrain="it.restrain"\n\t\t\t\t\t\t\t:closeable="it.closeable || typeof it.closeable === \'undefined\'"\n\t\t\t\t\t\t\t:draggable="it.draggable || typeof it.draggable === \'undefined\'"\n\t\t\t\t\t\t\t:rotatable="it.rotatable || typeof it.rotatable === \'undefined\'"\n\t\t\t\t\t\t\t:resizable="it.resizable || typeof it.resizable === \'undefined\'"\n\t\t\t\t\t\t\t@activated="$emit(\'activated\', it)"\n\t\t\t\t\t\t\t@deactivated="$emit(\'deactivated\', arguments[0], it)"\n\t\t\t\t\t\t\t@dragging="$emit(\'dragging\', it)"\n\t\t\t\t\t\t\t@resizing="$emit(\'resizing\', it)"\n\t\t\t\t\t\t\t@rotating="$emit(\'rotating\', it)"\n\t\t\t\t\t\t\t@resize-end="$emit(\'resize-end\', it)"\n\t\t\t\t\t\t\t@drag-end="$emit(\'drag-end\', it)"\n\t\t\t\t\t\t\t@delete="$emit(\'change\', { type: \'delete\', id: it.id })"\n\t\t\t\t\t\t\t@end="handleEnd(arguments[0], it.id, index)"\n\t\t\t\t\t\t\t@contextmenu.prevent.native="handleShowMenu($event, it)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\x3c!-- vm-type让组件内部处理如何渲染或其他操作 --\x3e\n\t\t\t\t\t\t\t<component\n\t\t\t\t\t\t\t\t:is="`vm-${it.module}-viewer`"\n\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\t:vm="vm"\n\t\t\t\t\t\t\t\tv-bind="it"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</vm-draggable>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</template>\n\t\t<template #content-extra>\n\t\t\t<vm-thumbnail\n\t\t\t\tv-if="showThumbnail"\n\t\t\t\t:data-source="dataSource"\n\t\t\t\t:scale="scale"\n\t\t\t\t:frame-w="width"\n\t\t\t\t:frame-h="height"\n\t\t\t\t:client-w="clientW"\n\t\t\t\t:client-h="clientH"\n\t\t\t\t:scroll-left="scrollLeft"\n\t\t\t\t:scroll-top="scrollTop"\n\t\t\t\t:border-size="borderSize"\n\t\t\t\t@scroll="handleScrollThumbnail"\n\t\t\t/>\n\t\t</template>\t\n\t\t<template #footer>\n\t\t\t<vm-zoom-bar\n\t\t\t\tv-if="showZoomBar"\n\t\t\t\t:scale.sync="scale"\n\t\t\t\t:border-size="borderSize"\n\t\t\t\t:frame-w="width"\n\t\t\t\t:frame-h="height"\n\t\t\t\t:client-w="clientW"\n\t\t\t\t:client-h="clientH"\n\t\t\t/>\n\t\t</template>\n\t</vm-inner>\n</template>\n\n<script>\nimport Draggable from \'../../../base/draggable.vue\';\nimport GridLines from \'./grid-lines.vue\';\nimport AlignLines from \'./align-lines.vue\';\nimport Inner from \'./inner.vue\';\nimport ZoomBar from \'./zoom-bar.vue\';\nimport Thumbnail from \'./thumbnail.vue\';\nimport { RightMenu, RIGHT_MENU_MAP } from \'./right-menu.vue\';\nimport { getUid, cloneDeep, throttle } from \'../../../utils/helper\';\nimport { WIDGET_TO_FRAME } from \'../../../utils/constants\';\n\nexport default {\n\tname: \'vm-frame\',\n\tcomponents: {\n\t\t\'vm-draggable\': Draggable,\n\t\t\'vm-grid-lines\': GridLines,\n\t\t\'vm-align-lines\': AlignLines,\n\t\t\'vm-inner\': Inner,\n\t\t\'vm-zoom-bar\': ZoomBar,\n\t\t\'vm-thumbnail\': Thumbnail,\n\t},\n\tprops: {\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tvalidator: v => v > 0,\n\t\t},\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tvalidator: v => v > 0,\n\t\t},\n\t\tdataSource: Array,\n\t\teditor: Object,\n\t\tframeStyle: Object,\n\t\tshowLines: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowRuler: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowZoomBar: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\tshowThumbnail: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tvm: {\n\t\t\t\ttype: \'frame\'\n\t\t\t},\n\t\t\tscrollLeft: 0,\n\t\t\tscrollTop: 0,\n\t\t\tscale: 1,\n\t\t\txRuleLines: [],\n\t\t\tyRuleLines: [],\n\n\t\t\t// 容器的宽高\n\t\t\tclientW: 0,\n\t\t\tclientH: 0,\n\n\t\t\t// 四周留白\n\t\t\tborderSize: 20,\n\n\t\t\t// 参考线\n\t\t\tguides: [[], []]\n\t\t};\n\t},\n\tcomputed: {\n\t\twrapperStyle() {\n\t\t\treturn {\n\t\t\t\tpaddingTop: `${this.borderSize}px`,\n\t\t\t\tpaddingLeft: `${this.borderSize}px`,\n\t\t\t};\n\t\t},\n\t\tcontentStyle() {\n\t\t\treturn {\n\t\t\t\twidth: `${this.width}px`,\n\t\t\t\theight: `${this.height}px`,\n\t\t\t\ttransform: `scale(${this.scale})`,\n\t\t\t\ttransformOrigin: `0 0`,\n\t\t\t};\n\t\t},\n\n\t\thackStyle() {\n\t\t\treturn {\n\t\t\t\twidth: `${Math.max(this.clientW, this.width * this.scale) + this.borderSize}px`,\n\t\t\t\theight: `${this.height * this.scale + this.borderSize}px`\n\t\t\t};\n\t\t}\n\t},\n\tmounted() {\n\t\tthis.$nextTick(() => {\n\t\t\t/**\n\t\t\t * 1. 自适应布局\n\t\t\t * 2. 滚动条最右侧显示（hackStyle）\n\t\t\t */\n\t\t\tthis.clientW = this.$refs.wrapper.offsetWidth;\n\t\t\tthis.clientH = this.$refs.wrapper.offsetHeight;\n\t\t});\n\t},\n\tmethods: {\n\t\thandleScroll: throttle(function (e) {\n\t\t\tthis.scrollLeft = e.target.scrollLeft;\n\t\t\tthis.scrollTop = e.target.scrollTop;\n\t\t}, 50),\n\n\t\thandleScrollThumbnail(x, y) {\n\t\t\tthis.scrollLeft = x;\n\t\t\tthis.$refs.wrapper.scrollLeft = x;\n\n\t\t\tthis.scrollTop = y;\n\t\t\tthis.$refs.wrapper.scrollTop = y;\n\t\t},\n\n\t\thandleDragOver(e) {\n\t\t},\n\t\thandleDragEnd(e) {\n\t\t\tconsole.log(e);\n\t\t},\n\t\thandleDrop(e) {\n\t\t\tlet { module, index } = JSON.parse(e.dataTransfer.getData(WIDGET_TO_FRAME)) || {};\n\t\t\tlet result = this.$parent.$options.modules[module];\n\t\t\t// 不存在的模块\n\t\t\tif (!result) return;\n\t\t\tif (result.max && result.max <= this.dataSource.filter(i => i.module === module).length) {\n\t\t\t\tthis.$emit(\'error\', {\n\t\t\t\t\ttype: \'create\',\n\t\t\t\t\tmsg: `当前模块最多只能创建${result.max}个`\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet { x, y } = this.$refs.content.getBoundingClientRect();\n\n\t\t\tlet mouseX = e.pageX || e.clientX + document.documentElement.scrollLeft || 0;\n\t\t\tlet mouseY = e.pageY || e.clientY + document.documentElement.scrollTop || 0;\n\n\t\t\tlet id = getUid();\n\t\t\tlet rowIndex = this.dataSource.length;\n\n\t\t\tlet data = {\n\t\t\t\t...cloneDeep(\n\t\t\t\t\ttypeof result.data === \'function\'\n\t\t\t\t\t\t? result.data(index, this.dataSource)\n\t\t\t\t\t\t: result.data\n\t\t\t\t),\n\t\t\t\tmodule,\n\t\t\t\tid\n\t\t\t};\n\n\t\t\t// 不可拖拽的情况下\n\t\t\tif (!e.fake && (data.draggable || typeof data.draggable === \'undefined\')) {\n\t\t\t\tdata.x = Math.round((mouseX - x) / this.scale);\n\t\t\t\tdata.y = Math.round((mouseY - y) / this.scale);\n\t\t\t} else {\n\t\t\t\tdata.x = 0;\n\t\t\t\tdata.y = 0;\n\t\t\t}\n\n\t\t\t// 会同步到上级 这里不用this.$emit("update:sync")\n\t\t\tthis.dataSource.push(data);\n\n\t\t\tthis.$emit(\'change\', {\n\t\t\t\ttype: \'create\',\n\t\t\t\tindex: rowIndex,\n\t\t\t\tid\n\t\t\t});\n\n\t\t\t// 新元素处于激活状态\n\t\t\tthis.setActived(rowIndex);\n\t\t},\n\t\thandleEnd(old, id, index) {\n\t\t\tthis.$emit(\'change\', {\n\t\t\t\ttype: \'update\',\n\t\t\t\tid,\n\t\t\t\tindex,\n\t\t\t\told\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * index因为都是最后一个插入\n\t\t * 所以不用像sortable/frame.vue一样做判断\n\t\t */\n\t\tsetActived(index) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\ttry {\n\t\t\t\t\tthis.$refs.draggable[index].setActived();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\thandleShowMenu(e, it) {\n\t\t\t// 根据z降序，相等则后面的z放在前面\n\t\t\tlet sortList = [...this.dataSource.filter(v => v.module !== \'page\')].reverse().sort((a, b) => b.z - a.z);\n\t\t\tlet index = sortList.findIndex(v => v.id === it.id);\n\n\t\t\tif (it.module === \'page\') return;\n\t\t\t\n\t\t\tconst { TOP, BOTTOM, UP, DOWN, DELETE } = RIGHT_MENU_MAP;\n\n\t\t\tRightMenu.popup({\n\t\t\t\tevent: e,\n\t\t\t}).then(type => {\n\t\t\t\tlet changeItem;\n\t\t\t\tswitch (type) {\n\t\t\t\t\tcase TOP:\n\t\t\t\t\t\tif (index > 0) {\n\t\t\t\t\t\t\tchangeItem = sortList[0];\n\t\t\t\t\t\t\tit.z = changeItem.z;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase BOTTOM:\n\t\t\t\t\t\tif (index < sortList.length - 1) {\n\t\t\t\t\t\t\tchangeItem = sortList[sortList.length - 1];\n\t\t\t\t\t\t\tit.z = changeItem.z;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase UP:\n\t\t\t\t\t\tif (index > 0) {\n\t\t\t\t\t\t\tchangeItem = sortList[index - 1];\n\t\t\t\t\t\t\t[changeItem.z, it.z] = [it.z, changeItem.z];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DOWN:\n\t\t\t\t\t\tif (index < sortList.length - 1) {\n\t\t\t\t\t\t\tchangeItem = sortList[index + 1];\n\t\t\t\t\t\t\t[changeItem.z, it.z] = [it.z, changeItem.z];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DELETE:\n\t\t\t\t\t\tthis.$emit(\'change\', { type: \'delete\', id: it.id });\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (type !== DELETE && changeItem) {\n\t\t\t\t\tlet curIndex = this.dataSource.findIndex(v => v.id === it.id);\n\t\t\t\t\tthis.dataSource.splice(curIndex, 1);\n\t\t\t\t\tlet nextIndex = this.dataSource.findIndex(v => v.id === changeItem.id) + ([TOP, UP].includes(type)\n\t\t\t\t\t\t? 1 : 0);\n\t\t\t\t\tthis.dataSource.splice(nextIndex, 0, it);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n$block: vm-frame-draggable;\n\n@include block($block) {\n\t@include element(wrapper) {\n\t\toverflow: auto;\n\t}\n\t@include element(content) {\n\t\t// 不可缩小\n\t\tflex-shrink: 0;\n\t\tborder: 1px solid $border;\n\t\tposition: relative;\n\t\toverflow: hidden;\n\t\tz-index: 1;\n\t}\n}\n</style>\n']},media:void 0})}),jt,void 0,!1,void 0,M,void 0);function Gt(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}var qt={name:"vm-frame",components:{"vm-sortable":T},props:{width:Number,height:Number,dataSource:Array,editor:Object},data:function(){return{dragType:"@wya/vm",dragWaiting:!1,vm:{type:"frame"}}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}}},created:function(){this.timer=null},beforeDestory:function(){clearTimeout(this.timer)},methods:{handleDragEnter:function(t){var n=this;this.timer=setTimeout((function(){n.dragWaiting=!n.$refs.sort||n.$refs.sort.every((function(t){return!1===t.highlight}))}),300)},handleDragLeave:function(t){clearTimeout(this.timer),this.dragWaiting=!1},handleDrop:function(t){clearTimeout(this.timer),this.dragWaiting=!1;var n=this.dataSource.length;this.$refs.sort&&this.$refs.sort.forEach((function(t,e){!0===t.highlight&&(n=t.index+1,t.highlight=!1)}));var e=JSON.parse(t.dataTransfer.getData("@wya/vm"))||{},i=e.module,r=e.index,o=this.$parent.$options.modules[i];if(o)if(o.max&&o.max<=this.dataSource.filter((function(t){return t.module===i})).length)this.$emit("error",{type:"create",msg:"当前模块最多只能创建".concat(o.max,"个")});else{var l=x(),d=function(t){for(var n=arguments,e=1;e<arguments.length;e++){var i=null!=n[e]?n[e]:{};e%2?Gt(i,!0).forEach((function(n){s(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):Gt(i).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}({},a.cloneDeep("function"==typeof o.data?o.data(r,this.dataSource):o.data),{module:i,id:l});switch(o.insertion){case"first":n=0;break;case"last":n=this.dataSource.length}this.dataSource.splice(n,0,d),this.$emit("change",{type:"create",index:n,id:l}),this.setActived(n)}},setActived:function(t){var n=this;this.$nextTick((function(){try{n.$refs.sort.find((function(n){return n.index===t})).setActived()}catch(t){console.error(t)}}))},handleSorting:function(t){this.sortData(t)},handleSortEnd:function(t){t[1]!=t[2]&&this.$emit("change",{type:"sort",sort:t})},sortData:function(t){var n=this.dataSource[t[0]],e=this.dataSource[t[1]];this.dataSource.splice(t[0],1,e),this.dataSource.splice(t[1],1,n)}}},Kt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-frame-sortable",style:t.style,on:{dragover:function(t){t.preventDefault()},dragenter:t.handleDragEnter,dragleave:t.handleDragLeave,drop:t.handleDrop}},[e("transition-group",{attrs:{tag:"div",name:"flip-list"}},t._l(t.dataSource,(function(n,i){return e("div",{key:n.id,staticClass:"vm-frame-sortable__item"},[e("div",{style:n.wrapperStyle},[e("vm-sortable",{ref:"sort",refInFor:!0,attrs:{index:i,type:t.dragType,disabled:n.disabled,draggable:n.draggable||void 0===n.draggable,closeable:n.closeable||void 0===n.closeable},on:{activated:function(e){return t.$emit("activated",n,i)},deactivated:function(e){return t.$emit("deactivated",n,i)},delete:function(e){return t.$emit("change",{type:"delete",id:n.id})},sorting:t.handleSorting,"sort-end":t.handleSortEnd}},[e("vm-"+n.module+"-viewer",t._b({tag:"component",staticStyle:{"min-height":"3px"},attrs:{index:i,vm:t.vm}},"component",n,!1))],1)],1),t._v(" "),n.placeholder?e("div",{style:{height:n.placeholder+"px"}}):t._e()])})),0)],1)};Kt._withStripped=!0;var Vt={Draggable:It,Sortable:k({render:Kt,staticRenderFns:[]},(function(t){t&&t("data-v-3234f8f3_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-frame-sortable {\n  -webkit-flex-shrink: 0;\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  margin-left: 20px;\n  position: relative;\n  overflow: auto;\n}\n.vm-frame-sortable__item {\n  -webkit-transition: all 0.5s;\n  transition: all 0.5s;\n}\n.flip-list-enter,\n.flip-list-leave-to {\n  opacity: 0;\n}\n.flip-list-leave-active {\n  display: none;\n}\n\n/*# sourceMappingURL=frame.vue.map */",map:{version:3,sources:["frame.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/frame/sortable/frame.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;AACF;;;;;;;EAOE;AACF;;;;;;;EAOE;AC4KF;;;;EAAA;ADtKA;;EAEE;AACF;;EAEE;AACF;;EAEE;AACF,sBAAsB;AACtB;;;EAGE;AACF;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AACF;;;EAGE;AACF;;;EAGE;AACF;;EAEE;ACiIF;EAEA,sBAAA;MAAA,oBAAA;UAAA,cAAA;EACA,yBAAA;EACA,iBAAA;EACA,kBAAA;EACA,cAAA;ADhIA;ACkIA;EACA,4BAAA;EAAA,oBAAA;AD/HA;ACkIA;;EAEA,UAAA;AD/HA;ACiIA;EACA,aAAA;AD9HA;;AAEA,oCAAoC",file:"frame.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-frame-sortable {\n  flex-shrink: 0;\n  border: 1px solid #d9d9d9;\n  margin-left: 20px;\n  position: relative;\n  overflow: auto;\n}\n\n.vm-frame-sortable__item {\n  transition: all 0.5s;\n}\n\n.flip-list-enter,\n.flip-list-leave-to {\n  opacity: 0;\n}\n\n.flip-list-leave-active {\n  display: none;\n}\n\n/*# sourceMappingURL=frame.vue.map */",'<template>\n\t<div \n\t\t:style="style" \n\t\tclass="vm-frame-sortable"\n\t\t@dragover.prevent\n\t\t@dragenter="handleDragEnter"\n\t\t@dragleave="handleDragLeave"\n\t\t@drop="handleDrop"\n\t>\n\t\t<transition-group tag="div" name="flip-list">\n\t\t\t<div v-for="(it, index) in dataSource" :key="it.id" class="vm-frame-sortable__item">\n\t\t\t\t\x3c!-- TODO: 不操作引用修改 --\x3e\n\t\t\t\t<div :style="it.wrapperStyle">\n\t\t\t\t\t<vm-sortable\n\t\t\t\t\t\tref="sort"\n\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t:type="dragType"\n\t\t\t\t\t\t:disabled="it.disabled"\n\t\t\t\t\t\t:draggable="it.draggable || typeof it.draggable === \'undefined\'"\n\t\t\t\t\t\t:closeable="it.closeable || typeof it.closeable === \'undefined\'"\n\t\t\t\t\t\t@activated="$emit(\'activated\', it, index)"\n\t\t\t\t\t\t@deactivated="$emit(\'deactivated\', it, index)"\n\t\t\t\t\t\t@delete="$emit(\'change\', { type: \'delete\', id: it.id })"\n\t\t\t\t\t\t@sorting="handleSorting"\n\t\t\t\t\t\t@sort-end="handleSortEnd"\n\t\t\t\t\t>\n\t\t\t\t\t\t<component \n\t\t\t\t\t\t\t:is="`vm-${it.module}-viewer`" \n\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t:vm="vm"\n\t\t\t\t\t\t\tv-bind="it" \n\t\t\t\t\t\t\tstyle="min-height: 3px"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</vm-sortable>\n\t\t\t\t</div>\n\t\t\t\t<div v-if="it.placeholder" :style="{height: `${it.placeholder}px`}"/>\n\t\t\t</div>\n\t\t</transition-group>\n\t</div>\n</template>\n\n<script>\nimport Sortable from \'../../../base/sortable.vue\';\nimport { getUid, cloneDeep } from \'../../../utils/helper\';\nimport { SORT_IN_FRAME, WIDGET_TO_FRAME } from \'../../../utils/constants\';\n\nexport default {\n\tname: \'vm-frame\',\n\tcomponents: {\n\t\t\'vm-sortable\': Sortable,\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\tdataSource: Array,\n\t\teditor: Object\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tdragType: SORT_IN_FRAME,\n\t\t\tdragWaiting: false,\n\t\t\tvm: {\n\t\t\t\ttype: \'frame\'\n\t\t\t}\n\t\t};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = this.width === 0 ? \'auto\' : `${this.width}px`;\n\t\t\tconst h = this.height === 0 ? \'auto\' : `${this.height}px`;\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t}\n\t},\n\tcreated() {\n\t\tthis.timer = null;\n\t},\n\tbeforeDestory() {\n\t\tclearTimeout(this.timer);\n\t},\n\tmethods: {\n\t\t/**\n\t\t * TODO：\n\t\t * 1. dragWaiting等待时，默认插入到最后一个\n\t\t * 2. 区分是widget还是内部排序\n\t\t */\n\t\thandleDragEnter(e) {\n\t\t\tthis.timer = setTimeout(() => {\n\t\t\t\tthis.dragWaiting = !this.$refs.sort || this.$refs.sort.every(i => i.highlight === false);\n\t\t\t}, 300);\n\t\t},\n\t\thandleDragLeave(e) {\n\t\t\tclearTimeout(this.timer);\n\t\t\tthis.dragWaiting = false;\n\t\t},\n\t\thandleDrop(e) {\n\t\t\tclearTimeout(this.timer);\n\t\t\tthis.dragWaiting = false;\n\n\t\t\tlet rowIndex = this.dataSource.length;\n\t\t\t/**\n\t\t\t * 清理高亮, 设置插入位置\n\t\t\t */\n\t\t\tif (this.$refs.sort) {\n\t\t\t\tthis.$refs.sort.forEach((instance, index) => {\n\t\t\t\t\tif (instance.highlight === true) {\n\t\t\t\t\t\trowIndex = instance.index + 1;\n\t\t\t\t\t\tinstance.highlight = false;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tlet { module, index } = JSON.parse(e.dataTransfer.getData(WIDGET_TO_FRAME)) || {};\n\t\t\tlet result = this.$parent.$options.modules[module];\n\t\t\t// 不存在的模块\n\t\t\tif (!result) return;\n\n\t\t\tif (result.max && result.max <= this.dataSource.filter(i => i.module === module).length) {\n\t\t\t\tthis.$emit(\'error\', {\n\t\t\t\t\ttype: \'create\',\n\t\t\t\t\tmsg: `当前模块最多只能创建${result.max}个`\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\tlet id = getUid();\n\n\t\t\tlet data = {\n\t\t\t\t...cloneDeep(\n\t\t\t\t\ttypeof result.data === \'function\' \n\t\t\t\t\t\t? result.data(index, this.dataSource) \n\t\t\t\t\t\t: result.data\n\t\t\t\t),\n\t\t\t\tmodule,\n\t\t\t\tid,\n\t\t\t};\n\n\t\t\t// 只能插入到第一个位置\n\t\t\tswitch (result.insertion) {\n\t\t\t\tcase \'first\':\n\t\t\t\t\trowIndex = 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \'last\':\n\t\t\t\t\trowIndex = this.dataSource.length;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t// 会同步到上级 这里不用this.$emit("update:sync")\n\t\t\tthis.dataSource.splice(rowIndex, 0, data);\n\n\t\t\tthis.$emit(\'change\', { \n\t\t\t\ttype: \'create\', \n\t\t\t\tindex: rowIndex,\n\t\t\t\tid\n\t\t\t});\n\n\t\t\t// 新元素处于激活状态\n\t\t\tthis.setActived(rowIndex);\n\t\t},\n\n\t\t/**\n\t\t * refs.sort是递增的，和index无关\n\t\t */\n\t\tsetActived(index) {\n\t\t\tthis.$nextTick(() => {\n\t\t\t\ttry {\n\t\t\t\t\tlet target = this.$refs.sort.find(i => i.index === index);\n\t\t\t\t\ttarget.setActived();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(e);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t/**\n\t\t * 交换位置\n\t\t */\n\t\thandleSorting(v) {\n\t\t\tthis.sortData(v);\n\t\t},\n\n\n\t\thandleSortEnd(v) {\n\t\t\tif (v[1] != v[2]) {\n\t\t\t\tthis.$emit(\'change\', {\n\t\t\t\t\ttype: \'sort\',\n\t\t\t\t\tsort: v\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * 外部使用\n\t\t */\n\t\t\n\t\tsortData(v) {\n\t\t\tlet current = this.dataSource[v[0]];\n\t\t\tlet target = this.dataSource[v[1]];\n\t\t\tthis.dataSource.splice(v[0], 1, target);\n\t\t\tthis.dataSource.splice(v[1], 1, current);\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../../style/index.scss";\n\n.vm-frame-sortable {\n\t// 不可缩小\n\tflex-shrink: 0;\n\tborder: 1px solid $border;\n\tmargin-left: 20px;\n\tposition: relative;\n\toverflow: auto\n}\n.vm-frame-sortable__item {\n\ttransition: all .5s;\n}\n// 开始消失/进入的元素\n.flip-list-enter, \n.flip-list-leave-to{\n\topacity: 0;\n}\n.flip-list-leave-active {\n\tdisplay: none;\n}\n</style>\n']},media:void 0})}),qt,void 0,!1,void 0,M,void 0)},Jt={name:"vm-widget",components:{"vc-customer":d,"vm-widget-item":P},props:{width:Number,height:Number,type:{type:String,default:"free"},dataSource:Array,contentStyle:Object},data:function(){var t=this.$parent.$options.modules,n={};for(var e in t)if(f(t,e)&&"basic"!==t[e].type){var i=t[e],r=i.type||"undefined";n[r]||(n[r]=[]),(i.showWidget||void 0===i.showWidget)&&n[r].push({module:i.module,component:i.Widget||i.name,widgets:i.widgets,draggable:!(i.widgets||!i.Viewer||!i.Editor),active:!1})}return{toolsList:n,showTip:!0,currentTab:Object.keys(n)[0]}},computed:{style:function(){return{width:0===this.width?"auto":"".concat(this.width,"px"),height:0===this.height?"auto":"".concat(this.height,"px")}}},created:function(){},methods:{handleEvent:function(t){var n=this;return{change:function(){for(var e=arguments,i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=e[a];return n.$emit.apply(n,["change",t].concat(r))}}}}},Zt=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"vm-widget",style:t.style},[e("div",{staticClass:"vm-widget__wrapper"},[e("p",{staticClass:"vm-widget__header"},[t._v("组件库")]),t._v(" "),t.showTip?e("div",{staticClass:"vm-widget__tip"},[e("span",{staticClass:"vm-widget__icon-warn"},[t._v("!")]),t._v(" "),e("p",[t._v("可拖动数据组件到指定位置")]),t._v(" "),e("span",{on:{click:function(n){t.showTip=!t.showTip}}},[t._v("✕")])]):t._e(),t._v(" "),e("div",{staticClass:"vm-widget__menu"},[e("div",{staticClass:"vm-widget__tabs"},t._l(t.toolsList,(function(n,i){return"undefined"!==i?e("p",{key:i,class:{"is-active":t.currentTab==i},on:{click:function(n){t.currentTab=i}}},[t._v(t._s(i))]):t._e()})),0),t._v(" "),e("div",{staticClass:"vm-widget__content",style:t.contentStyle},t._l(t.toolsList[t.currentTab],(function(n){return e("vm-widget-item",{key:n.module,attrs:{draggable:n.draggable,module:n.module}},[e("div",{staticClass:"vm-widget__title",class:{"is-active":n.active,"is-draggable":n.draggable,"is-click":n.widgets},on:{click:function(t){n.widgets&&(n.active=!n.active)}}},["string"==typeof n.component?e("p",{domProps:{innerHTML:t._s(n.component)}}):e("vm-"+n.module+"-widget",t._g({tag:"component"},t.handleEvent(n.module))),t._v(" "),n.widgets?e("div",{staticClass:"vm-widget__arrow"}):t._e()],1),t._v(" "),n.active?e("div",{staticClass:"vm-widget__combo"},t._l(n.widgets,(function(i,r){return e("vm-widget-item",{key:r,staticClass:"vm-widget__item",attrs:{module:n.module,index:r,draggable:""}},[i.render?[e("vc-customer",{attrs:{render:i.render,index:r}})]:[e("img",{attrs:{src:i.image}}),t._v(" "),e("p",[t._v(t._s(i.name))])]],2)})),1):t._e()])})),1)])])])};Zt._withStripped=!0;var Qt=k({render:Zt,staticRenderFns:[]},(function(t){t&&t("data-v-a954d32a_0",{source:"@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-widget {\n  -webkit-box-flex: 0;\n  -webkit-flex: 0 0 354px;\n      -ms-flex: 0 0 354px;\n          flex: 0 0 354px;\n  width: 354px;\n  z-index: 10;\n}\n.vm-widget__wrapper {\n  background: #fff;\n  padding: 10px 0 0;\n  height: 100%;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  -webkit-box-align: stretch;\n  -webkit-align-items: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n}\n.vm-widget__header {\n  font-size: 15px;\n  color: #000;\n  padding: 8px 15px;\n  font-weight: 400;\n}\n.vm-widget__tip {\n  background: #FDF5E8;\n  height: 40px;\n  margin: 2px 9px 15px;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  padding: 0 10px;\n  color: #666;\n  border-radius: 4px;\n  border: none;\n}\n.vm-widget__tip p {\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n}\n.vm-widget__tip span {\n  color: #666;\n  cursor: pointer;\n}\n.vm-widget__icon-warn {\n  width: 14px;\n  height: 14px;\n  background: #EC9C39;\n  border-radius: 100%;\n  color: #fff;\n  font-size: 12px;\n  line-height: 14px;\n  text-align: center;\n  margin-right: 7px;\n}\n.vm-widget__menu {\n  border-top: 1px solid #d9d9d9;\n  overflow-y: auto;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-flex: 1;\n  -webkit-flex: 1;\n      -ms-flex: 1;\n          flex: 1;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: stretch;\n  -webkit-align-items: stretch;\n      -ms-flex-align: stretch;\n          align-items: stretch;\n  -webkit-flex-wrap: nowrap;\n      -ms-flex-wrap: nowrap;\n          flex-wrap: nowrap;\n}\n.vm-widget__tabs {\n  width: 56px;\n  height: 100%;\n  padding: 0;\n  color: #666;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  line-height: 24px;\n  font-size: 12px;\n  border-right: 1px solid #d9d9d9;\n  -webkit-box-pack: start;\n  -webkit-justify-content: flex-start;\n      -ms-flex-pack: start;\n          justify-content: flex-start;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n}\n.vm-widget__tabs p {\n  text-align: center;\n  height: 49px;\n  cursor: pointer;\n  line-height: 49px;\n}\n.vm-widget__tabs p.is-active {\n  color: #000000;\n  background-color: #EFEFEF;\n}\n.vm-widget__content {\n  width: 297px;\n  overflow: auto;\n  height: 100%;\n}\n.vm-widget__title {\n  padding: 15px 20px;\n  font-size: 12px;\n  color: #000;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: justify;\n  -webkit-justify-content: space-between;\n      -ms-flex-pack: justify;\n          justify-content: space-between;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  cursor: pointer;\n  border-bottom: 1px solid #d9d9d9;\n}\n.vm-widget__title.is-draggable {\n  cursor: move;\n}\n.vm-widget__title.is-click {\n  cursor: pointer;\n}\n.vm-widget__title.is-active {\n  color: #5495F6;\n}\n.vm-widget__title.is-active .vm-widget__arrow {\n  -webkit-transform: rotate(-135deg);\n      -ms-transform: rotate(-135deg);\n          transform: rotate(-135deg);\n}\n.vm-widget__arrow {\n  width: 8px;\n  height: 8px;\n  border: 2px solid #d9d9d9;\n  border-top: 0;\n  border-left: 0;\n  -webkit-transform: rotate(45deg);\n      -ms-transform: rotate(45deg);\n          transform: rotate(45deg);\n  -webkit-transition: -webkit-transform 0.2s ease-in-out;\n  transition: -webkit-transform 0.2s ease-in-out;\n  transition: transform 0.2s ease-in-out;\n  transition: transform 0.2s ease-in-out, -webkit-transform 0.2s ease-in-out;\n}\n.vm-widget__combo {\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-flex-wrap: wrap;\n      -ms-flex-wrap: wrap;\n          flex-wrap: wrap;\n  width: 100%;\n  border-bottom: 1px solid #d9d9d9;\n  padding: 12px;\n}\n.vm-widget__item {\n  -webkit-box-flex: 0;\n  -webkit-flex: 0 0 50%;\n      -ms-flex: 0 0 50%;\n          flex: 0 0 50%;\n  display: -webkit-box;\n  display: -webkit-flex;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n  -webkit-align-items: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-orient: vertical;\n  -webkit-box-direction: normal;\n  -webkit-flex-direction: column;\n      -ms-flex-direction: column;\n          flex-direction: column;\n  padding: 6px 12px;\n  cursor: move;\n}\n.vm-widget__item img {\n  width: 100%;\n  border: 1px dashed #d9d9d9;\n}\n.vm-widget__item p {\n  padding-top: 8px;\n}\n\n/*# sourceMappingURL=widget.vue.map */",map:{version:3,sources:["widget.vue","/Users/deot/Desktop/wya/github/wya-vm/src/combo/widget/widget.vue"],names:[],mappings:"AAAA,gBAAgB;AAChB;;;;EAIE;AACF;;;;;EAKE;AACF;;;;EAIE;AACF;;;;;EAKE;ACgJF;;;;;;;EAAA;AAsBA;;;;;;;EAAA;AAsBA;;;;EAAA;AAqBA;;EAAA;AASA;;EAAA;AAIA;;EAAA;AAUA,sBAAA;AAaA;;;EAAA;ADjNA;6BAC6B;AAC7B;6BAC6B;AAC7B;6BAC6B;AAC7B;;EAEE;AACF;;;;;EAKE;AC+GF;;;EAAA;AAkBA;;;EAAA;AAUA;;EAAA;AD/HA;ECkEA,mBAAA;EAAA,uBAAA;MAAA,mBAAA;UAAA,eAAA;EACA,YAAA;EACA,WAAA;ADhEA;AACA;ECiEA,gBAAA;EACA,iBAAA;EACA,YAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,0BAAA;EAAA,4BAAA;MAAA,uBAAA;UAAA,oBAAA;AD/DA;AAEA;ECgEA,eAAA;EACA,WAAA;EACA,iBAAA;EACA,gBAAA;AD9DA;AAEA;EC+DA,mBAAA;EACA,YAAA;EACA,oBAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,eAAA;EACA,WAAA;EACA,kBAAA;EACA,YAAA;AD7DA;AC8DA;EACA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;AD5DA;AC8DA;EACA,WAAA;EACA,eAAA;AD5DA;AAEA;EC8DA,WAAA;EACA,YAAA;EACA,mBAAA;EACA,mBAAA;EACA,WAAA;EACA,eAAA;EACA,iBAAA;EACA,kBAAA;EACA,iBAAA;AD5DA;AAEA;EC6DA,6BAAA;EACA,gBAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,mBAAA;EAAA,eAAA;MAAA,WAAA;UAAA,OAAA;EACA,yBAAA;EAAA,sCAAA;MAAA,sBAAA;UAAA,8BAAA;EACA,0BAAA;EAAA,4BAAA;MAAA,uBAAA;UAAA,oBAAA;EACA,yBAAA;MAAA,qBAAA;UAAA,iBAAA;AD3DA;AAEA;EC4DA,WAAA;EACA,YAAA;EACA,UAAA;EACA,WAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,iBAAA;EACA,eAAA;EACA,+BAAA;EACA,uBAAA;EAAA,mCAAA;MAAA,oBAAA;UAAA,2BAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;AD1DA;AC2DA;EACA,kBAAA;EACA,YAAA;EACA,eAAA;EACA,iBAAA;ADzDA;AC0DA;EACA,cAAA;EACA,yBAAA;ADxDA;AAEA;EC2DA,YAAA;EACA,cAAA;EACA,YAAA;ADzDA;AAEA;EC2DA,kBAAA;EACA,eAAA;EACA,WAAA;EAEA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,sCAAA;MAAA,sBAAA;UAAA,8BAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,eAAA;EACA,gCAAA;AD1DA;ACWA;EAiDA,YAAA;ADzDA;ACQA;EAoDA,eAAA;ADxDA;ACIA;EAuDA,cAAA;ADvDA;ACwDA;EACA,kCAAA;MAAA,8BAAA;UAAA,0BAAA;ADtDA;AAEA;ECyDA,UAAA;EACA,WAAA;EACA,yBAAA;EACA,aAAA;EACA,cAAA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;EACA,sDAAA;EAAA,8CAAA;EAAA,sCAAA;EAAA,0EAAA;ADvDA;AAEA;ECwDA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,uBAAA;MAAA,mBAAA;UAAA,eAAA;EACA,WAAA;EACA,gCAAA;EAEA,aAAA;ADvDA;AAEA;ECwDA,mBAAA;EAAA,qBAAA;MAAA,iBAAA;UAAA,aAAA;EACA,oBAAA;EAAA,qBAAA;EAAA,oBAAA;EAAA,aAAA;EACA,yBAAA;EAAA,2BAAA;MAAA,sBAAA;UAAA,mBAAA;EACA,4BAAA;EAAA,6BAAA;EAAA,8BAAA;MAAA,0BAAA;UAAA,sBAAA;EACA,iBAAA;EACA,YAAA;ADtDA;ACuDA;EACA,WAAA;EACA,0BAAA;ADrDA;ACuDA;EACA,gBAAA;ADrDA;;AAEA,qCAAqC",file:"widget.vue",sourcesContent:["@charset \"UTF-8\";\n/**\n * [commonDirectionFill 方向名词补充]\n * @param  {[string]} $key [l r b t]\n * @return {[string]}      [left right bottom top]\n */\n/**\n * [commonColumnWidth 平均分配百分比]\n * @param  {[number]} $col   [所占比]\n * @param  {[number]} $total [总]\n * @return {[number]}        [所占比/总 * 100%]\n */\n/**\n * [commonBorder 1px的兼容问题]\n * @param  {[string]} $border: ltbr          [border的方向缩写拼接]\n * @return {[type]}          [1px border]\n */\n/**\n * 1px\n * 已为父元素添加position: relative;\n * 其他只操作before和after;\n * 暂时不抽离公用\n */\n/**\n * [commonPadding padding]\n * @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonMargin margin]\n* @param  {[number/string]} $t  [string 方向首字母拼接 top的距离]\n * @param  {[number]} $r: $t            [right的距离]\n * @param  {[number]} $b: $t            [bottom的距离]\n * @param  {[number]} $l: $r            [left的距离]\n * @return {[type]}     [description]\n */\n/**\n * [commonAbsolute absolute]\n * @param  {[list]} $direction-val... [top, right, bottom, left 的值]\n * @return {[type]}                   [description]\n */\n/**\n * 水平垂直居中\n */\n/**\n * 文字相关\n */\n/**\n * 一行文字\n */\n/* stylelint-disable */\n/**\n * [commonClearfix 清除浮动]\n * @return {[type]} [description]\n */\n/* Var\n -------------------------- */\n/* Func\n -------------------------- */\n/* Mix\n -------------------------- */\n/**\n * @param $root: 默认置顶\n */\n/**\n * 1. +, >, ~, ' '\n * 2. 同element\n * 3. 同modifier\n * 4. 同block\n */\n/**\n * -> [className].is_require \n * 与xxx:hover类似\n */\n/**\n * 用 @at-root 来重置 & 读取次数的计数\n * 如 [clsssName] [className]:hover\n */\n/**\n * 自定义规则\n */\n.vm-widget {\n  flex: 0 0 354px;\n  width: 354px;\n  z-index: 10;\n}\n.vm-widget__wrapper {\n  background: #fff;\n  padding: 10px 0 0;\n  height: 100%;\n  display: flex;\n  flex-direction: column;\n  align-items: stretch;\n}\n\n.vm-widget__header {\n  font-size: 15px;\n  color: #000;\n  padding: 8px 15px;\n  font-weight: 400;\n}\n\n.vm-widget__tip {\n  background: #FDF5E8;\n  height: 40px;\n  margin: 2px 9px 15px;\n  display: flex;\n  align-items: center;\n  padding: 0 10px;\n  color: #666;\n  border-radius: 4px;\n  border: none;\n}\n.vm-widget__tip p {\n  flex: 1;\n}\n.vm-widget__tip span {\n  color: #666;\n  cursor: pointer;\n}\n\n.vm-widget__icon-warn {\n  width: 14px;\n  height: 14px;\n  background: #EC9C39;\n  border-radius: 100%;\n  color: #fff;\n  font-size: 12px;\n  line-height: 14px;\n  text-align: center;\n  margin-right: 7px;\n}\n\n.vm-widget__menu {\n  border-top: 1px solid #d9d9d9;\n  overflow-y: auto;\n  display: flex;\n  flex: 1;\n  justify-content: space-between;\n  align-items: stretch;\n  flex-wrap: nowrap;\n}\n\n.vm-widget__tabs {\n  width: 56px;\n  height: 100%;\n  padding: 0;\n  color: #666;\n  display: flex;\n  line-height: 24px;\n  font-size: 12px;\n  border-right: 1px solid #d9d9d9;\n  justify-content: flex-start;\n  flex-direction: column;\n}\n.vm-widget__tabs p {\n  text-align: center;\n  height: 49px;\n  cursor: pointer;\n  line-height: 49px;\n}\n.vm-widget__tabs p.is-active {\n  color: #000000;\n  background-color: #EFEFEF;\n}\n\n.vm-widget__content {\n  width: 297px;\n  overflow: auto;\n  height: 100%;\n}\n\n.vm-widget__title {\n  padding: 15px 20px;\n  font-size: 12px;\n  color: #000;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  cursor: pointer;\n  border-bottom: 1px solid #d9d9d9;\n}\n.vm-widget__title.is-draggable {\n  cursor: move;\n}\n\n.vm-widget__title.is-click {\n  cursor: pointer;\n}\n\n.vm-widget__title.is-active {\n  color: #5495F6;\n}\n.vm-widget__title.is-active .vm-widget__arrow {\n  transform: rotate(-135deg);\n}\n\n.vm-widget__arrow {\n  width: 8px;\n  height: 8px;\n  border: 2px solid #d9d9d9;\n  border-top: 0;\n  border-left: 0;\n  transform: rotate(45deg);\n  transition: transform 0.2s ease-in-out;\n}\n\n.vm-widget__combo {\n  display: flex;\n  flex-wrap: wrap;\n  width: 100%;\n  border-bottom: 1px solid #d9d9d9;\n  padding: 12px;\n}\n\n.vm-widget__item {\n  flex: 0 0 50%;\n  display: flex;\n  align-items: center;\n  flex-direction: column;\n  padding: 6px 12px;\n  cursor: move;\n}\n.vm-widget__item img {\n  width: 100%;\n  border: 1px dashed #d9d9d9;\n}\n.vm-widget__item p {\n  padding-top: 8px;\n}\n\n/*# sourceMappingURL=widget.vue.map */",'<template>\n\t<div :style="style" class="vm-widget">\n\t\t<div class="vm-widget__wrapper">\n\t\t\t<p class="vm-widget__header">组件库</p>\n\t\t\t<div v-if="showTip" class="vm-widget__tip">\n\t\t\t\t<span class="vm-widget__icon-warn">!</span>\n\t\t\t\t<p>可拖动数据组件到指定位置</p>\n\t\t\t\t<span @click="showTip = !showTip">✕</span>\n\t\t\t</div>\n\t\t\t<div class="vm-widget__menu">\n\t\t\t\t<div class="vm-widget__tabs">\n\t\t\t\t\t<p\n\t\t\t\t\t\tv-for="(item, key) in toolsList"\n\t\t\t\t\t\tv-if="key !== \'undefined\'"\n\t\t\t\t\t\t:key="key"\n\t\t\t\t\t\t:class="{ \'is-active\': currentTab == key}"\n\t\t\t\t\t\t@click="currentTab = key"\n\t\t\t\t\t>{{ key }}</p>\n\t\t\t\t</div>\n\t\t\t\t<div :style="contentStyle" class="vm-widget__content">\n\t\t\t\t\t<vm-widget-item\n\t\t\t\t\t\tv-for="(it) in toolsList[currentTab]"\n\t\t\t\t\t\t:key="it.module"\n\t\t\t\t\t\t:draggable="it.draggable"\n\t\t\t\t\t\t:module="it.module"\n\t\t\t\t\t>\n\t\t\t\t\t\t\x3c!-- 组件标题 --\x3e\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t:class="{ \'is-active\': it.active, \'is-draggable\': it.draggable, \'is-click\': it.widgets }"\n\t\t\t\t\t\t\tclass="vm-widget__title"\n\t\t\t\t\t\t\t@click="it.widgets && (it.active = !it.active)"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<p v-if="typeof it.component === \'string\'" v-html="it.component"/>\n\t\t\t\t\t\t\t<component v-else :is="`vm-${it.module}-widget`" v-on="handleEvent(it.module)"/>\n\t\t\t\t\t\t\t<div v-if="it.widgets" class="vm-widget__arrow" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\x3c!-- 子元素 --\x3e\n\t\t\t\t\t\t<div v-if="it.active" class="vm-widget__combo">\n\t\t\t\t\t\t\t<vm-widget-item\n\t\t\t\t\t\t\t\tv-for="(widget, index) in it.widgets"\n\t\t\t\t\t\t\t\t:key="index"\n\t\t\t\t\t\t\t\t:module="it.module"\n\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\tdraggable\n\t\t\t\t\t\t\t\tclass="vm-widget__item"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<template v-if="widget.render">\n\t\t\t\t\t\t\t\t\t<vc-customer\n\t\t\t\t\t\t\t\t\t\t:render="widget.render"\n\t\t\t\t\t\t\t\t\t\t:index="index"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t\t<template v-else>\n\t\t\t\t\t\t\t\t\t<img :src="widget.image" >\n\t\t\t\t\t\t\t\t\t<p>{{ widget.name }}</p>\n\t\t\t\t\t\t\t\t</template>\n\t\t\t\t\t\t\t</vm-widget-item>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</vm-widget-item>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport Widget from \'../../base/widget.vue\';\nimport { hasOwn } from \'../../utils/helper\';\nimport { WIDGET_TO_FRAME } from \'../../utils/constants\';\nimport { Customer } from \'../../vc\';\n\nexport default {\n\tname: \'vm-widget\',\n\tcomponents: {\n\t\t\'vc-customer\': Customer,\n\t\t\'vm-widget-item\': Widget,\n\t},\n\tprops: {\n\t\twidth: Number,\n\t\theight: Number,\n\t\ttype: {\n\t\t\ttype: String,\n\t\t\tdefault: \'free\' // sort-list\n\t\t},\n\t\tdataSource: Array,\n\t\tcontentStyle: Object\n\t},\n\tdata() {\n\t\tconst { modules } = this.$parent.$options;\n\t\tlet toolsList = {};\n\t\tfor (let key in modules) {\n\t\t\t// 过滤页面设置\n\t\t\tif (hasOwn(modules, key) && modules[key].type !== \'basic\') {\n\t\t\t\tlet item = modules[key];\n\t\t\t\tlet type = item.type || \'undefined\';\n\t\t\t\tif (!toolsList[type]) {\n\t\t\t\t\ttoolsList[type] = [];\n\t\t\t\t}\n\t\t\t\tif (item.showWidget || typeof item.showWidget === \'undefined\') {\n\t\t\t\t\ttoolsList[type].push({\n\t\t\t\t\t\tmodule: item.module,\n\t\t\t\t\t\tcomponent: item.Widget || item.name,\n\t\t\t\t\t\twidgets: item.widgets,\n\t\t\t\t\t\t// 最外层拖拽\n\t\t\t\t\t\tdraggable: !!(!item.widgets && item.Viewer && item.Editor),\n\n\t\t\t\t\t\t// 更多, 由click事件控制\n\t\t\t\t\t\tactive: false\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\ttoolsList,\n\t\t\tshowTip: true,\n\t\t\tcurrentTab: Object.keys(toolsList)[0]\n\t\t};\n\t},\n\tcomputed: {\n\t\tstyle() {\n\t\t\tconst w = this.width === 0 ? \'auto\' : `${this.width}px`;\n\t\t\tconst h = this.height === 0 ? \'auto\' : `${this.height}px`;\n\n\t\t\treturn {\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t}\n\t},\n\tcreated() {\n\t\t// console.log(this.$options.modules);\n\t},\n\tmethods: {\n\t\thandleEvent(module) {\n\t\t\treturn {\n\t\t\t\tchange: (...rest) => this.$emit(\'change\', module, ...rest)\n\t\t\t};\n\t\t}\n\t},\n};\n<\/script>\n\n<style lang="scss">\n@import "../../style/index.scss";\n\n$block: vm-widget;\n\n@include block($block) {\n\tflex: 0 0 354px;\n\twidth: 354px;\n\tz-index: 10;\n\t@include element(wrapper) {\n\t\tbackground: $white;\n\t\tpadding: 10px 0 0;\n\t\theight: 100%;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: stretch;\n\t}\n\t@include element(header) {\n\t\tfont-size: 15px;\n\t\tcolor: #000;\n\t\tpadding: 8px 15px;\n\t\tfont-weight: 400;\n\t}\n\t@include element(tip) {\n\t\tbackground: #FDF5E8;\n\t\theight: 40px;\n\t\tmargin: 2px 9px 15px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tpadding: 0 10px;\n\t\tcolor: $assit;\n\t\tborder-radius: 4px;\n\t\tborder:none;\n\t\tp {\n\t\t\tflex: 1;\n\t\t}\n\t\tspan {\n\t\t\tcolor: $assit;\n\t\t\tcursor: pointer;\n\t\t}\n\t}\n\t@include element(icon-warn) {\n\t\twidth: 14px;\n\t\theight: 14px;\n\t\tbackground: #EC9C39;\n\t\tborder-radius: 100%;\n\t\tcolor: $white;\n\t\tfont-size: 12px;\n\t\tline-height: 14px;\n\t\ttext-align: center;\n\t\tmargin-right: 7px;\n\t}\n\t@include element(menu) {\n\t\tborder-top: 1px solid $border;\n\t\toverflow-y: auto;\n\t\tdisplay: flex;\n\t\tflex:1;\n\t\tjustify-content: space-between;\n\t\talign-items: stretch;\n\t\tflex-wrap: nowrap;\n\t}\n\t@include element(tabs) {\n\t\twidth: 56px;\n\t\theight: 100%;\n\t\tpadding:0;\n\t\tcolor: $assit;\n\t\tdisplay: flex;\n\t\tline-height: 24px;\n\t\tfont-size: 12px;\n\t\tborder-right: 1px solid $border;\n\t\tjustify-content: flex-start;\n\t\tflex-direction: column;\n\t\tp {\n\t\t\ttext-align: center;\n\t\t\theight: 49px;\n\t\t\tcursor: pointer;\n\t\t\tline-height: 49px;\n\t\t\t&.is-active {\n\t\t\t\tcolor: $black;\n\t\t\t\tbackground-color: $acitved;\n\t\t\t}\n\t\t}\n\t}\n\t@include element(content) {\n\t\twidth: 297px;\n\t\toverflow: auto;\n\t\theight: 100%;\n\t}\n\n\t@include element(title) {\n\t\tpadding: 15px 20px;\n\t\tfont-size: 12px;\n\t\tcolor: #000;\n\t\t// font-weight: bold;\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tcursor: pointer;\n\t\tborder-bottom: 1px solid $border;\n\t\t@include when(draggable) {\n\t\t\tcursor: move;\n\t\t}\n\t\t@include when(click) {\n\t\t\tcursor: pointer;\n\t\t}\n\t\t@include when(active) {\n\t\t\tcolor: $primary;\n\t\t\t.vm-widget__arrow {\n\t\t\t\ttransform: rotate(-135deg);\n\t\t\t}\n\t\t}\n\t}\n\t@include element(arrow) {\n\t\twidth: 8px;\n\t\theight: 8px;\n\t\tborder: 2px solid $border;\n\t\tborder-top: 0;\n\t\tborder-left: 0;\n\t\ttransform: rotate(45deg);\n\t\ttransition: transform 0.2s ease-in-out;\n\t}\n\t@include element(combo) {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\twidth: 100%;\n\t\tborder-bottom: 1px solid $border;\n\t\t// justify-content: center;\n\t\tpadding: 12px;\n\t}\n\t@include element(item) {\n\t\tflex: 0 0 50%;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tflex-direction: column;\n\t\tpadding: 6px 12px;\n\t\tcursor: move;\n\t\timg {\n\t\t\twidth: 100%;\n\t\t\tborder: 1px dashed $border;\n\t\t}\n\t\tp {\n\t\t\tpadding-top: 8px;\n\t\t}\n\t}\n}\n\n</style>\n']},media:void 0})}),Jt,void 0,!1,void 0,M,void 0),tn={name:"vm-editor",components:{},props:{dataSource:Object,width:{type:Number,default:446}},data:function(){return{key:x()}},computed:{},watch:{"dataSource.module":{handler:function(){this.key=x()}}},methods:{handleChange:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"===u(t))for(var n in t){var e=t[n];["x","y","z","r","w","h"].includes(n)&&(e=Number(e)),f(t,n)&&!y(e)&&(this.$emit("change",{type:"update",id:this.dataSource.id,old:s({},n,e)}),this.$refs.target.$emit("update:".concat(n),e))}}}},nn=function(){var t=this.$createElement,n=this._self._c||t;return n("div",{key:this.key,staticClass:"vm-editor vm-hack-editor",style:{flex:"0 0 "+this.width+"px"}},[n("div",{staticClass:"vm-editor-wrapper"},[n("vm-"+this.dataSource.module+"-editor",this._b({ref:"target",tag:"component",on:{change:this.handleChange}},"component",this.dataSource,!1,!0))],1)])};nn._withStripped=!0;var en=k({render:nn,staticRenderFns:[]},(function(t){t&&t("data-v-6a702ead_0",{source:".vm-editor {\n  -webkit-flex-shrink: 0;\n      -ms-flex-negative: 0;\n          flex-shrink: 0;\n}\n.vm-editor-wrapper {\n  position: relative;\n  padding: 0;\n  height: 100%;\n  border: 1px solid rgba(0, 0, 0, 0.10196);\n  border-radius: 0px;\n  -webkit-box-shadow: 0 2px 12px rgba(0, 0, 0, .15);\n          box-shadow: 0 2px 12px rgba(0, 0, 0, .15);\n  background: #fff;\n  z-index: 2;\n}\n.vm-editor__arrow {\n  left: -7px;\n  top: 20px;\n  width: 14px;\n  height: 14px;\n  -webkit-transform: translateX(-50%) rotate(45deg);\n      -ms-transform: translateX(-50%) rotate(45deg);\n          transform: translateX(-50%) rotate(45deg);\n  -webkit-box-shadow: -3px 3px 7px rgba(0, 0, 0, .07);\n          box-shadow: -3px 3px 7px rgba(0, 0, 0, .07);\n  background: #fff;\n  -webkit-transform: rotate(45deg);\n      -ms-transform: rotate(45deg);\n          transform: rotate(45deg);\n  position: absolute;\n  border-color: rgba(0, 0, 0, 0);\n  border-style: solid;\n  border-left: 1px solid rgba(0, 0, 0, 0.10196);\n  border-bottom: 1px solid rgba(0, 0, 0, 0.10196);\n}\n\n/*# sourceMappingURL=editor.vue.map */",map:{version:3,sources:["/Users/deot/Desktop/wya/github/wya-vm/src/combo/editor/editor.vue","editor.vue"],names:[],mappings:"AA4EA;EACA,sBAAA;MAAA,oBAAA;UAAA,cAAA;AC3EA;ADiFA;EACA,kBAAA;EACA,UAAA;EACA,YAAA;EACA,wCAAA;EACA,kBAAA;EACA,iDAAA;UAAA,yCAAA;EACA,gBAAA;EACA,UAAA;AC9EA;ADgFA;EACA,UAAA;EACA,SAAA;EACA,WAAA;EACA,YAAA;EACA,iDAAA;MAAA,6CAAA;UAAA,yCAAA;EACA,mDAAA;UAAA,2CAAA;EACA,gBAAA;EACA,gCAAA;MAAA,4BAAA;UAAA,wBAAA;EACA,kBAAA;EACA,8BAAA;EACA,mBAAA;EACA,6CAAA;EACA,+CAAA;AC7EA;;AAEA,qCAAqC",file:"editor.vue",sourcesContent:['<template>\n\t<div \n\t\t:style="{flex: `0 0 ${width}px` }" \n\t\t:key="key"\n\t\tclass="vm-editor vm-hack-editor"\n\t>\n\t\t<div class="vm-editor-wrapper">\n\t\t\t\x3c!-- <div class="vm-editor__arrow" /> --\x3e\n\t\t\t<component\n\t\t\t\tref="target"\n\t\t\t\t:is="`vm-${dataSource.module}-editor`"\n\t\t\t\tv-bind.sync="dataSource"\n\t\t\t\t@change="handleChange"\n\t\t\t/>\n\t\t</div>\n\t</div>\n</template>\n\n<script>\nimport { valueIsNaN, hasOwn, getUid } from "../../utils/helper";\n\nexport default {\n\tname: \'vm-editor\',\n\tcomponents: {\n\t},\n\tprops: {\n\t\tdataSource: Object,\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 446\n\t\t}\n\t},\n\tdata() {\n\t\treturn {\n\t\t\tkey: getUid()\n\t\t};\n\t},\n\tcomputed: {\n\t},\n\twatch: {\n\t\t"dataSource.module": {\n\t\t\thandler() {\n\t\t\t\tthis.key = getUid();\n\t\t\t}\n\t\t}\n\t},\n\tmethods: {\n\t\t/**\n\t\t * hack操作\n\t\t * 业务上避免使用该操作\n\t\t */\n\t\thandleChange(opts = {}) {\n\t\t\tif (typeof opts !== \'object\') return;\n\t\t\tfor (let key in opts) {\n\t\t\t\tlet val = opts[key];\n\n\t\t\t\t[\'x\', \'y\', \'z\', \'r\', \'w\', \'h\'].includes(key) && (val = Number(val));\n\n\t\t\t\tif (hasOwn(opts, key) && !valueIsNaN(val)) {\n\n\t\t\t\t\tthis.$emit(\'change\', {\n\t\t\t\t\t\ttype: \'update\',\n\t\t\t\t\t\tid: this.dataSource.id,\n\t\t\t\t\t\told: {\n\t\t\t\t\t\t\t[key]: val\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tthis.$refs.target.$emit(`update:${key}`, val);\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t},\n};\n<\/script>\n<style lang="scss">\n.vm-editor {\n\tflex-shrink: 0;\n\t// margin-left: 20px;\n\t// min-width: 446px; // 暂时写死\n\t// max-width: 446px;\n\t// flex: 0 0 354px;\n}\n.vm-editor-wrapper {\n\tposition: relative;\n\tpadding: 0;\n\theight: 100%;\n\tborder: 1px solid #0000001a;\n\tborder-radius: 0px;\n\tbox-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);\n\tbackground: #fff;\n\tz-index: 2;\n}\n.vm-editor__arrow {\n\tleft: -7px;\n\ttop: 20px;\n\twidth: 14px;\n\theight: 14px;\n\ttransform: translateX(-50%) rotate(45deg);\n\tbox-shadow: -3px 3px 7px rgba(0, 0, 0, 0.07);\n\tbackground: #fff;\n\ttransform: rotate(45deg);\n\tposition: absolute;\n\tborder-color: #0000;\n\tborder-style: solid;\n\tborder-left: 1px solid #0000001a;\n\tborder-bottom: 1px solid #0000001a;\n}\n</style>\n',".vm-editor {\n  flex-shrink: 0;\n}\n\n.vm-editor-wrapper {\n  position: relative;\n  padding: 0;\n  height: 100%;\n  border: 1px solid #0000001a;\n  border-radius: 0px;\n  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.15);\n  background: #fff;\n  z-index: 2;\n}\n\n.vm-editor__arrow {\n  left: -7px;\n  top: 20px;\n  width: 14px;\n  height: 14px;\n  transform: translateX(-50%) rotate(45deg);\n  box-shadow: -3px 3px 7px rgba(0, 0, 0, 0.07);\n  background: #fff;\n  transform: rotate(45deg);\n  position: absolute;\n  border-color: #0000;\n  border-style: solid;\n  border-left: 1px solid #0000001a;\n  border-bottom: 1px solid #0000001a;\n}\n\n/*# sourceMappingURL=editor.vue.map */"]},media:void 0})}),tn,void 0,!1,void 0,M,void 0);function rn(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,i)}return e}function an(t){for(var n=arguments,e=1;e<arguments.length;e++){var i=null!=n[e]?n[e]:{};e%2?rn(i,!0).forEach((function(n){s(t,n,i[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):rn(i).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(i,n))}))}return t}n.Draggable=F,n.Sortable=T,n.Widget=P,n.createVMDrags=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:tt,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},e=n.mode,i=void 0===e?"draggable":e;try{Object.keys(t).forEach((function(n){"page"===t[n].module&&(t[n].data=an({},a.cloneDeep("function"==typeof t[n].data?t[n].data(0,t):t[n].data),{draggable:!1,closeable:!1,resizable:!1,rotatable:!1}))}));var r=a.cloneDeep(n.Combo||ft),s=a.cloneDeep(n.Frame||("draggable"===i?Vt.Draggable:Vt.Sortable)),o=a.cloneDeep(n.Widget||Qt),l=a.cloneDeep(n.Preview||mt.Preview),d=a.cloneDeep(n.Editor||en),c={},m={},h={};Object.keys(t).forEach((function(n,e){var i=a.kebabCase(n),r=t[n],s=r.Viewer,o=r.Editor,l=r.Widget;c["vm-".concat(i,"-viewer")]=s,m["vm-".concat(i,"-editor")]=o,h["vm-".concat(i,"-widget")]=l})),r.modules=t,r.viewers=c,r.editors=m,s.components=an({},s.components,{},c),d.components=an({},d.components,{},m),o.components=an({},o.components,{},h),r.components=an({},r.components,{"vm-frame":s,"vm-editor":d,"vm-widget":o}),l.components=an({},l.components,{},c);var p=a.cloneDeep(r),u=a.cloneDeep(l),g=new A(mt.PreviewPopup,{mode:i,promise:!1,components:{"vm-preview":l}});return u.popup=g.popup,u.destroy=g.destroy,p.previewManager=g,{Combo:p,Preview:u}}catch(t){throw console.error("[wya-vm/register]",t),new Error(t)}}}}]);